{"patch": "diff --git a/src/H5Shyper.c b/src/H5Shyper.c\nindex 7d6739a7fb..03f9a66746 100644\n--- a/src/H5Shyper.c\n+++ b/src/H5Shyper.c\n@@ -4676,7 +4676,12 @@ H5S__get_select_hyper_blocklist(H5S_t *space, hsize_t startblock, hsize_t numblo\n         unsigned               u;        /* Counter */\n \n         /* Set some convenience values */\n+\n         ndims    = space->extent.rank;\n+        if (ndims == 0 || ndims > H5S_MAX_RANK) {\n+            /* Invalid number of dimensions, avoid out-of-bounds or zero-sized access */\n+            return FAIL;\n+        }\n         fast_dim = ndims - 1;\n \n         /* Check which set of dimension information to use */\n", "result": true}