{"patch": "diff --git a/src/H5Shyper.c b/src/H5Shyper.c\nindex 7d6739a7fb..190d3f9333 100644\n--- a/src/H5Shyper.c\n+++ b/src/H5Shyper.c\n@@ -4708,6 +4708,11 @@ H5S__get_select_hyper_blocklist(H5S_t *space, hsize_t startblock, hsize_t numblo\n         while (!done && numblocks > 0) {\n             /* Skip over initial blocks */\n             if (startblock > 0) {\n+                /* Explicit bounds and NULL checks */\n+                if (!tmp_count || fast_dim < 0 || (size_t)fast_dim >= ndims) {\n+                    /* Error: invalid access */\n+                    break;\n+                }\n                 /* Skip all blocks in row */\n                 if (startblock >= tmp_count[fast_dim]) {\n                     startblock -= tmp_count[fast_dim];\n@@ -4725,8 +4730,13 @@ H5S__get_select_hyper_blocklist(H5S_t *space, hsize_t startblock, hsize_t numblo\n                     startblock = 0;\n                 } /* end else */\n             }     /* end if */\n-\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+ \n             /* Iterate over the blocks in the fastest dimension */\n+            /* Added bounds and NULL check here as well */\n+            if (!tmp_count || fast_dim < 0 || (size_t)fast_dim >= ndims) {\n+                break;\n+            }\n             while (tmp_count[fast_dim] > 0 && numblocks > 0) {\n                 /* Sanity check */\n                 assert(startblock == 0);\n@@ -4754,12 +4764,19 @@ H5S__get_select_hyper_blocklist(H5S_t *space, hsize_t startblock, hsize_t numblo\n             if (fast_dim > 0 && numblocks > 0) {\n                 int temp_dim; /* Temporary rank holder */\n \n-                /* Reset the block counts */\n+                /* Reset the block counts, with bounds check */\n+                if (!tmp_count || fast_dim < 0 || (size_t)fast_dim >= ndims) {\n+                    break;\n+                }\n                 tmp_count[fast_dim] = diminfo[fast_dim].count;\n \n                 /* Bubble up the decrement to the slower changing dimensions */\n                 temp_dim = (int)(fast_dim - 1);\n                 while (temp_dim >= 0 && !done) {\n+                    if (!tmp_count || temp_dim < 0 || (size_t)temp_dim >= ndims) {\n+                        done = true;\n+                        break;\n+                    }\n                     /* Decrement the block count */\n                     tmp_count[temp_dim]--;\n \n", "result": false, "error": ".test_binary_3: /gentest/proj/hdf5/hdf5-gh-5353/generated3/generated.cc:30: void test_h5s_bug5(): Assertion `ret_fail < 0' failed.\n"}