{"patch": "diff --git a/icu4c/source/i18n/islamcal.cpp b/icu4c/source/i18n/islamcal.cpp\nindex 4fd0e07d920..870e31fae1e 100644\n--- a/icu4c/source/i18n/islamcal.cpp\n+++ b/icu4c/source/i18n/islamcal.cpp\n@@ -609,75 +609,85 @@ void IslamicCalendar::handleComputeFields(int32_t julianDay, UErrorCode &status)\n     int32_t startDate;\n     int32_t days = julianDay - CIVIL_EPOC;\n \n-    if (cType == CIVIL || cType == TBLA) {\n-        if(cType == TBLA) {\n-            days = julianDay - ASTRONOMICAL_EPOC;\n-        }\n-        // Use the civil calendar approximation, which is just arithmetic\n-        year  = (int)ClockMath::floorDivide( (double)(30 * days + 10646) , 10631.0 );\n-        month = (int32_t)uprv_ceil((days - 29 - yearStart(year)) / 29.5 );\n-        month = month<11?month:11;\n-        startDate = monthStart(year, month);\n-    } else if(cType == ASTRONOMICAL){\n-        // Guess at the number of elapsed full months since the epoch\n-        int32_t months = (int32_t)uprv_floor((double)days / CalendarAstronomer::SYNODIC_MONTH);\n+    #include <climits>\n \n-        startDate = (int32_t)uprv_floor(months * CalendarAstronomer::SYNODIC_MONTH);\n-\n-        double age = moonAge(internalGetTime(), status);\n-        if (U_FAILURE(status)) {\n-            status = U_MEMORY_ALLOCATION_ERROR;\n-            return;\n-        }\n-        if ( days - startDate >= 25 && age > 0) {\n-            // If we're near the end of the month, assume next month and search backwards\n-            months++;\n-        }\n+if (cType == CIVIL || cType == TBLA) {\n+    if(cType == TBLA) {\n+        days = julianDay - ASTRONOMICAL_EPOC;\n+// FIXME: Crash CWE-190: Integer Overflow or Wraparound\n+    }\n+    // Use the civil calendar approximation, which is just arithmetic\n+    int64_t tempSum = (int64_t)30 * (int64_t)days + 10646LL;\n+    if (tempSum > INT_MAX) tempSum = INT_MAX;\n+    if (tempSum < INT_MIN) tempSum = INT_MIN;\n+    year  = (int)ClockMath::floorDivide((double)tempSum, 10631.0 );\n+    month = (int32_t)uprv_ceil((days - 29 - yearStart(year)) / 29.5 );\n+    month = month<11?month:11;\n+    startDate = monthStart(year, month);\n+} else if(cType == ASTRONOMICAL){\n+    // Guess at the number of elapsed full months since the epoch\n+    int32_t months = (int32_t)uprv_floor((double)days / CalendarAstronomer::SYNODIC_MONTH);\n+\n+    startDate = (int32_t)uprv_floor(months * CalendarAstronomer::SYNODIC_MONTH);\n+\n+    double age = moonAge(internalGetTime(), status);\n+    if (U_FAILURE(status)) {\n+        status = U_MEMORY_ALLOCATION_ERROR;\n+        return;\n+    }\n+    if ( days - startDate >= 25 && age > 0) {\n+        // If we're near the end of the month, assume next month and search backwards\n+        months++;\n+    }\n \n-        // Find out the last time that the new moon was actually visible at this longitude\n-        // This returns midnight the night that the moon was visible at sunset.\n-        while ((startDate = trueMonthStart(months)) > days) {\n-            // If it was after the date in question, back up a month and try again\n-            months--;\n-        }\n+    // Find out the last time that the new moon was actually visible at this longitude\n+    // This returns midnight the night that the moon was visible at sunset.\n+    while ((startDate = trueMonthStart(months)) > days) {\n+        // If it was after the date in question, back up a month and try again\n+        months--;\n+    }\n \n-        year = months / 12 + 1;\n-        month = months % 12;\n-    } else if(cType == UMALQURA) {\n-        int32_t umalquraStartdays = yearStart(UMALQURA_YEAR_START) ;\n-        if( days < umalquraStartdays){\n-                //Use Civil calculation\n-                year  = (int)ClockMath::floorDivide( (double)(30 * days + 10646) , 10631.0 );\n-                month = (int32_t)uprv_ceil((days - 29 - yearStart(year)) / 29.5 );\n-                month = month<11?month:11;\n-                startDate = monthStart(year, month);\n-            }else{\n-                int y =UMALQURA_YEAR_START-1, m =0;\n-                long d = 1;\n-                while(d > 0){ \n-                    y++; \n-                    d = days - yearStart(y) +1;\n-                    if(d == handleGetYearLength(y)){\n-                        m=11;\n-                        break;\n-                    }else if(d < handleGetYearLength(y) ){\n-                        int monthLen = handleGetMonthLength(y, m); \n-                        m=0;\n-                        while(d > monthLen){\n-                            d -= monthLen;\n-                            m++;\n-                            monthLen = handleGetMonthLength(y, m);\n-                        }\n-                        break;\n+    year = months / 12 + 1;\n+    month = months % 12;\n+} else if(cType == UMALQURA) {\n+    int32_t umalquraStartdays = yearStart(UMALQURA_YEAR_START) ;\n+    if( days < umalquraStartdays){\n+            //Use Civil calculation\n+            int64_t tempSum = (int64_t)30 * (int64_t)days + 10646LL;\n+            if (tempSum > INT_MAX) tempSum = INT_MAX;\n+            if (tempSum < INT_MIN) tempSum = INT_MIN;\n+            year  = (int)ClockMath::floorDivide((double)tempSum, 10631.0 );\n+            month = (int32_t)uprv_ceil((days - 29 - yearStart(year)) / 29.5 );\n+            month = month<11?month:11;\n+            startDate = monthStart(year, month);\n+        }else{\n+            int y =UMALQURA_YEAR_START-1, m =0;\n+            long d = 1;\n+            while(d > 0){ \n+                y++; \n+                d = days - yearStart(y) +1;\n+                if(d == handleGetYearLength(y)){\n+                    m=11;\n+                    break;\n+                }else if(d < handleGetYearLength(y) ){\n+                    int monthLen = handleGetMonthLength(y, m); \n+                    m=0;\n+                    while(d > monthLen){\n+                        d -= monthLen;\n+                        m++;\n+                        monthLen = handleGetMonthLength(y, m);\n                     }\n+                    break;\n                 }\n-                year = y;\n-                month = m;\n             }\n-    } else { // invalid 'civil'\n-      U_ASSERT(false); // should not get here, out of range\n-      year=month=0;\n-    }\n+            year = y;\n+            month = m;\n+        }\n+} else { // invalid 'civil'\n+  U_ASSERT(false); // should not get here, out of range\n+  year=month=0;\n+}\n+\n \n     dayOfMonth = (days - monthStart(year, month)) + 1;\n \n", "result": true}