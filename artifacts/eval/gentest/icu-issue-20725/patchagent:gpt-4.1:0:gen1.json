{"patch": "diff --git a/icu4c/source/common/ustring.cpp b/icu4c/source/common/ustring.cpp\nindex 7ab2e1bf891..f5005894f37 100644\n--- a/icu4c/source/common/ustring.cpp\n+++ b/icu4c/source/common/ustring.cpp\n@@ -1210,10 +1210,16 @@ static int8_t _digit16(UChar c) {\n  * UChars, it does not use C++ or UnicodeString.  This allows it to\n  * be used from C contexts. */\n U_CAPI UChar32 U_EXPORT2\n-u_unescapeAt(UNESCAPE_CHAR_AT charAt,\n+u_unescapeAt_internal(UNESCAPE_CHAR_AT charAt,\n              int32_t *offset,\n              int32_t length,\n-             void *context) {\n+             void *context,\n+             int depth) {\n+\n+#define MAX_UNESCAPE_RECURSION 32\n+    if (depth > MAX_UNESCAPE_RECURSION) {\n+        return (UChar32)0xFFFFFFFF;\n+    }\n \n     int32_t start = *offset;\n     UChar c;\n@@ -1294,7 +1300,7 @@ u_unescapeAt(UNESCAPE_CHAR_AT charAt,\n             int32_t ahead = *offset + 1;\n             c = charAt(*offset, context);\n             if (c == 0x5C /*'\\\\'*/ && ahead < length) {\n-                c = (UChar) u_unescapeAt(charAt, &ahead, length, context);\n+                c = (UChar) u_unescapeAt_internal(charAt, &ahead, length, context, depth + 1);\n             }\n             if (U16_IS_TRAIL(c)) {\n                 *offset = ahead;\n@@ -1388,7 +1394,7 @@ u_unescape(const char *src, UChar *dest, int32_t destCapacity) {\n                 i += (int32_t)(src - segment);\n             }\n             ++src; /* advance past '\\\\' */\n-            c32 = (UChar32)u_unescapeAt(_charPtr_charAt, &lenParsed, (int32_t)uprv_strlen(src), (void*)src);\n+            c32 = (UChar32)u_unescapeAt_internal(_charPtr_charAt, &lenParsed, (int32_t)uprv_strlen(src), (void*)src, 0);\n             if (lenParsed == 0) {\n                 goto err;\n             }\n@@ -1527,3 +1533,12 @@ U_CAPI int32_t U_EXPORT2\n ustr_hashICharsN(const char *str, int32_t length) {\n     STRING_HASH(char, str, length, (uint8_t)uprv_tolower(*p));\n }\n+\n+// Wrapper for backward compatibility\n+U_CAPI UChar32 U_EXPORT2\n+u_unescapeAt(UNESCAPE_CHAR_AT charAt,\n+             int32_t *offset,\n+             int32_t length,\n+             void *context) {\n+    return u_unescapeAt_internal(charAt, offset, length, context, 0);\n+}\n", "result": true}