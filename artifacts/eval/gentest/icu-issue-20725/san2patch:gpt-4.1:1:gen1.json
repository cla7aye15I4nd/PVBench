{"patch": "diff --git a/icu4c/source/common/ustring.cpp b/icu4c/source/common/ustring.cpp\nindex 7ab2e1bf891..740ed7a8b28 100644\n--- a/icu4c/source/common/ustring.cpp\n+++ b/icu4c/source/common/ustring.cpp\n@@ -1292,10 +1292,16 @@ u_unescapeAt(UNESCAPE_CHAR_AT charAt,\n          */\n         if (*offset < length && U16_IS_LEAD(result)) {\n             int32_t ahead = *offset + 1;\n+#define MAX_RECURSION_DEPTH 32\n+            static int recursion_depth = 0;\n+            if (recursion_depth++ >= MAX_RECURSION_DEPTH) {\n+                goto err;\n+            }\n             c = charAt(*offset, context);\n             if (c == 0x5C /*'\\\\'*/ && ahead < length) {\n                 c = (UChar) u_unescapeAt(charAt, &ahead, length, context);\n             }\n+            --recursion_depth;\n             if (U16_IS_TRAIL(c)) {\n                 *offset = ahead;\n                 result = U16_GET_SUPPLEMENTARY(result, c);\n", "result": true}