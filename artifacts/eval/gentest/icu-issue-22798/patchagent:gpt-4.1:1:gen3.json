{"patch": "diff --git a/icu4c/source/common/messagepattern.cpp b/icu4c/source/common/messagepattern.cpp\nindex 9e318295f9a..7df49d042d3 100644\n--- a/icu4c/source/common/messagepattern.cpp\n+++ b/icu4c/source/common/messagepattern.cpp\n@@ -1,3 +1,5 @@\n+#define MAX_NESTING_LEVEL 64\n+\n // \u00a9 2016 and later: Unicode, Inc. and others.\n // License & terms of use: http://www.unicode.org/copyright.html\n /*\n@@ -506,6 +508,11 @@ MessagePattern::parseMessage(int32_t index, int32_t msgStartLength,\n         } else if(UMSGPAT_ARG_TYPE_HAS_PLURAL_STYLE(parentType) && c==u_pound) {\n             // The unquoted # in a plural message fragment will be replaced\n             // with the (number-offset).\n+    if (nestingLevel > MAX_NESTING_LEVEL) {\n+        setParseError(parseError, index);\n+        errorCode = U_PARSE_ERROR;\n+        return 0;\n+    }\n             addPart(UMSGPAT_PART_TYPE_REPLACE_NUMBER, index-1, 1, 0, errorCode);\n         } else if(c==u_leftCurlyBrace) {\n             index=parseArg(index-1, 1, nestingLevel, parseError, errorCode);\n@@ -538,6 +545,11 @@ MessagePattern::parseMessage(int32_t index, int32_t msgStartLength,\n int32_t\n MessagePattern::parseArg(int32_t index, int32_t argStartLength, int32_t nestingLevel,\n                          UParseError *parseError, UErrorCode &errorCode) {\n+    if (nestingLevel > MAX_NESTING_LEVEL) {\n+        setParseError(parseError, index);\n+        errorCode = U_PARSE_ERROR;\n+        return 0;\n+    }\n     int32_t argStart=partsLength;\n     UMessagePatternArgType argType=UMSGPAT_ARG_TYPE_NONE;\n     addPart(UMSGPAT_PART_TYPE_ARG_START, index, argStartLength, argType, errorCode);\n@@ -750,6 +762,11 @@ MessagePattern::parseChoiceStyle(int32_t index, int32_t nestingLevel,\n         if(U_FAILURE(errorCode)) {\n             return 0;\n         }\n+    if (nestingLevel > MAX_NESTING_LEVEL) {\n+        setParseError(parseError, index);\n+        errorCode = U_PARSE_ERROR;\n+        return 0;\n+    }\n         // parseMessage(..., CHOICE) returns the index of the terminator, or msg.length().\n         if(index==msg.length()) {\n             return index;\n", "result": false, "error": ".test_binary_3: /gentest/proj/icu/icu-issue-22798/generated3/generated.cc:39: int main(): Assertion `status == U_INDEX_OUTOFBOUNDS_ERROR' failed.\n"}