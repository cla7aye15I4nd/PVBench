{"patch": "diff --git a/icu4c/source/common/messagepattern.cpp b/icu4c/source/common/messagepattern.cpp\nindex 9e318295f9a..af7f7957f6b 100644\n--- a/icu4c/source/common/messagepattern.cpp\n+++ b/icu4c/source/common/messagepattern.cpp\n@@ -1101,6 +1101,11 @@ MessagePattern::inTopLevelChoiceMessage(int32_t nestingLevel, UMessagePatternArg\n void\n MessagePattern::addPart(UMessagePatternPartType type, int32_t index, int32_t length,\n                         int32_t value, UErrorCode &errorCode) {\n+    static const int32_t kMaxParts = 10000;\n+    if (partsLength >= kMaxParts) {\n+        errorCode = U_INDEX_OUTOFBOUNDS_ERROR;\n+        return;\n+    }\n     if(partsList->ensureCapacityForOneMore(partsLength, errorCode)) {\n         Part &part=partsList->a[partsLength++];\n         part.type=type;\n@@ -1122,6 +1127,11 @@ MessagePattern::addLimitPart(int32_t start,\n void\n MessagePattern::addArgDoublePart(double numericValue, int32_t start, int32_t length,\n                                  UErrorCode &errorCode) {\n+    static const int32_t kMaxNumericValues = 10000;\n+    if (numericValuesLength >= kMaxNumericValues) {\n+        errorCode = U_INDEX_OUTOFBOUNDS_ERROR;\n+        return;\n+    }\n     if(U_FAILURE(errorCode)) {\n         return;\n     }\n", "result": true}