{"patch": "diff --git a/icu4c/source/common/messagepattern.cpp b/icu4c/source/common/messagepattern.cpp\nindex 9e318295f9a..79fad476c88 100644\n--- a/icu4c/source/common/messagepattern.cpp\n+++ b/icu4c/source/common/messagepattern.cpp\n@@ -30,6 +30,9 @@\n \n U_NAMESPACE_BEGIN\n \n+// Maximum allowed nesting level for message parsing to prevent stack overflow\n+#define MAX_NESTING_LEVEL 32\n+\n // Unicode character/code point constants ---------------------------------- ***\n \n static const char16_t u_pound=0x23;\n@@ -434,6 +437,11 @@ int32_t\n MessagePattern::parseMessage(int32_t index, int32_t msgStartLength,\n                              int32_t nestingLevel, UMessagePatternArgType parentType,\n                              UParseError *parseError, UErrorCode &errorCode) {\n+    if(nestingLevel > MAX_NESTING_LEVEL) {\n+        setParseError(parseError, index);\n+        errorCode = U_PARSE_ERROR;\n+        return 0;\n+    }\n     if(U_FAILURE(errorCode)) {\n         return 0;\n     }\n@@ -538,6 +546,11 @@ MessagePattern::parseMessage(int32_t index, int32_t msgStartLength,\n int32_t\n MessagePattern::parseArg(int32_t index, int32_t argStartLength, int32_t nestingLevel,\n                          UParseError *parseError, UErrorCode &errorCode) {\n+    if(nestingLevel > MAX_NESTING_LEVEL) {\n+        setParseError(parseError, index);\n+        errorCode = U_PARSE_ERROR;\n+        return 0;\n+    }\n     int32_t argStart=partsLength;\n     UMessagePatternArgType argType=UMSGPAT_ARG_TYPE_NONE;\n     addPart(UMSGPAT_PART_TYPE_ARG_START, index, argStartLength, argType, errorCode);\n@@ -770,6 +783,11 @@ int32_t\n MessagePattern::parsePluralOrSelectStyle(UMessagePatternArgType argType,\n                                          int32_t index, int32_t nestingLevel,\n                                          UParseError *parseError, UErrorCode &errorCode) {\n+    if(nestingLevel > MAX_NESTING_LEVEL) {\n+        setParseError(parseError, index);\n+        errorCode = U_PARSE_ERROR;\n+        return 0;\n+    }\n     if(U_FAILURE(errorCode)) {\n         return 0;\n     }\n", "result": false, "error": ".test_binary_1: /gentest/proj/icu/icu-issue-22798/generated1/generated.cc:32: int main(): Assertion `status == U_INDEX_OUTOFBOUNDS_ERROR' failed.\n"}