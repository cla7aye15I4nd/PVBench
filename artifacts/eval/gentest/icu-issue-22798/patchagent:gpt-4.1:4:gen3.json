{"patch": "diff --git a/icu4c/source/common/messagepattern.cpp b/icu4c/source/common/messagepattern.cpp\nindex 9e318295f9a..8a4fd5652ff 100644\n--- a/icu4c/source/common/messagepattern.cpp\n+++ b/icu4c/source/common/messagepattern.cpp\n@@ -30,6 +30,9 @@\n \n U_NAMESPACE_BEGIN\n \n+// Maximum allowed nesting to prevent stack overflow\n+#define MAX_NESTING_LEVEL 64\n+\n // Unicode character/code point constants ---------------------------------- ***\n \n static const char16_t u_pound=0x23;\n@@ -508,6 +511,11 @@ MessagePattern::parseMessage(int32_t index, int32_t msgStartLength,\n             // with the (number-offset).\n             addPart(UMSGPAT_PART_TYPE_REPLACE_NUMBER, index-1, 1, 0, errorCode);\n         } else if(c==u_leftCurlyBrace) {\n+            if (nestingLevel >= MAX_NESTING_LEVEL) {\n+                setParseError(parseError, index);\n+                errorCode = U_PARSE_ERROR;\n+                return 0;\n+            }\n             index=parseArg(index-1, 1, nestingLevel, parseError, errorCode);\n         } else if((nestingLevel>0 && c==u_rightCurlyBrace) ||\n                   (parentType==UMSGPAT_ARG_TYPE_CHOICE && c==u_pipe)) {\n@@ -538,6 +546,11 @@ MessagePattern::parseMessage(int32_t index, int32_t msgStartLength,\n int32_t\n MessagePattern::parseArg(int32_t index, int32_t argStartLength, int32_t nestingLevel,\n                          UParseError *parseError, UErrorCode &errorCode) {\n+    if (nestingLevel >= MAX_NESTING_LEVEL) {\n+        setParseError(parseError, index);\n+        errorCode = U_PARSE_ERROR;\n+        return 0;\n+    }\n     int32_t argStart=partsLength;\n     UMessagePatternArgType argType=UMSGPAT_ARG_TYPE_NONE;\n     addPart(UMSGPAT_PART_TYPE_ARG_START, index, argStartLength, argType, errorCode);\n@@ -701,6 +714,11 @@ MessagePattern::parseSimpleStyle(int32_t index, UParseError *parseError, UErrorC\n int32_t\n MessagePattern::parseChoiceStyle(int32_t index, int32_t nestingLevel,\n                                  UParseError *parseError, UErrorCode &errorCode) {\n+    if (nestingLevel >= MAX_NESTING_LEVEL) {\n+        setParseError(parseError, index);\n+        errorCode = U_PARSE_ERROR;\n+        return 0;\n+    }\n     if(U_FAILURE(errorCode)) {\n         return 0;\n     }\n@@ -746,6 +764,11 @@ MessagePattern::parseChoiceStyle(int32_t index, int32_t nestingLevel,\n         }\n         addPart(UMSGPAT_PART_TYPE_ARG_SELECTOR, index, 1, 0, errorCode);\n         // Parse the message fragment.\n+        if (nestingLevel+1 >= MAX_NESTING_LEVEL) {\n+            setParseError(parseError, index);\n+            errorCode = U_PARSE_ERROR;\n+            return 0;\n+        }\n         index=parseMessage(++index, 0, nestingLevel+1, UMSGPAT_ARG_TYPE_CHOICE, parseError, errorCode);\n         if(U_FAILURE(errorCode)) {\n             return 0;\n", "result": false, "error": ".test_binary_3: /gentest/proj/icu/icu-issue-22798/generated3/generated.cc:39: int main(): Assertion `status == U_INDEX_OUTOFBOUNDS_ERROR' failed.\n"}