{"patch": "diff --git a/icu4c/source/common/messagepattern.cpp b/icu4c/source/common/messagepattern.cpp\nindex 9e318295f9a..7a237477144 100644\n--- a/icu4c/source/common/messagepattern.cpp\n+++ b/icu4c/source/common/messagepattern.cpp\n@@ -506,8 +506,14 @@ MessagePattern::parseMessage(int32_t index, int32_t msgStartLength,\n         } else if(UMSGPAT_ARG_TYPE_HAS_PLURAL_STYLE(parentType) && c==u_pound) {\n             // The unquoted # in a plural message fragment will be replaced\n             // with the (number-offset).\n-            addPart(UMSGPAT_PART_TYPE_REPLACE_NUMBER, index-1, 1, 0, errorCode);\n+// FIXME: Crash CWE-674: Uncontrolled Recursion\n+             addPart(UMSGPAT_PART_TYPE_REPLACE_NUMBER, index-1, 1, 0, errorCode);\n         } else if(c==u_leftCurlyBrace) {\n+            // Check for recursion depth limit to prevent stack overflow\n+            if(nestingLevel >= 100) {\n+                errorCode = U_MEMORY_ALLOCATION_ERROR;\n+                return 0;\n+            }\n             index=parseArg(index-1, 1, nestingLevel, parseError, errorCode);\n         } else if((nestingLevel>0 && c==u_rightCurlyBrace) ||\n                   (parentType==UMSGPAT_ARG_TYPE_CHOICE && c==u_pipe)) {\n@@ -642,8 +648,15 @@ MessagePattern::parseArg(int32_t index, int32_t argStartLength, int32_t nestingL\n         } else /* ',' */ {\n             ++index;\n             if(argType==UMSGPAT_ARG_TYPE_SIMPLE) {\n-                index=parseSimpleStyle(index, parseError, errorCode);\n+// FIXME: Crash CWE-674: Uncontrolled Recursion\n+                 index=parseSimpleStyle(index, parseError, errorCode);\n             } else if(argType==UMSGPAT_ARG_TYPE_CHOICE) {\n+                // Check for maximum recursion depth to prevent infinite recursion\n+                if(nestingLevel >= 100) {\n+                    setParseError(parseError, index);\n+                    errorCode=U_PATTERN_SYNTAX_ERROR;\n+                    return 0;\n+                }\n                 index=parseChoiceStyle(index, nestingLevel, parseError, errorCode);\n             } else {\n                 index=parsePluralOrSelectStyle(argType, index, nestingLevel, parseError, errorCode);\n", "result": false, "error": ".test_binary_1: /gentest/proj/icu/icu-issue-22798/generated1/generated.cc:32: int main(): Assertion `status == U_INDEX_OUTOFBOUNDS_ERROR' failed.\n"}