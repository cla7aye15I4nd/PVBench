{"patch": "diff --git a/icu4c/source/common/messagepattern.cpp b/icu4c/source/common/messagepattern.cpp\nindex 9e318295f9a..41f9ba4941b 100644\n--- a/icu4c/source/common/messagepattern.cpp\n+++ b/icu4c/source/common/messagepattern.cpp\n@@ -634,7 +634,8 @@ MessagePattern::parseArg(int32_t index, int32_t argStartLength, int32_t nestingL\n         }\n         // look for an argument style (pattern)\n         if(c==u_rightCurlyBrace) {\n-            if(argType!=UMSGPAT_ARG_TYPE_SIMPLE) {\n+// FIXME: Crash CWE-674: Uncontrolled Recursion\n+             if(argType!=UMSGPAT_ARG_TYPE_SIMPLE) {\n                 setParseError(parseError, nameIndex);  // No style field for complex argument.\n                 errorCode=U_PATTERN_SYNTAX_ERROR;\n                 return 0;\n@@ -644,6 +645,12 @@ MessagePattern::parseArg(int32_t index, int32_t argStartLength, int32_t nestingL\n             if(argType==UMSGPAT_ARG_TYPE_SIMPLE) {\n                 index=parseSimpleStyle(index, parseError, errorCode);\n             } else if(argType==UMSGPAT_ARG_TYPE_CHOICE) {\n+                // Check for excessive nesting level to prevent stack overflow\n+                if(nestingLevel >= 100) {\n+                    setParseError(parseError, index);\n+                    errorCode=U_PATTERN_SYNTAX_ERROR;\n+                    return 0;\n+                }\n                 index=parseChoiceStyle(index, nestingLevel, parseError, errorCode);\n             } else {\n                 index=parsePluralOrSelectStyle(argType, index, nestingLevel, parseError, errorCode);\n", "result": false, "error": ".test_binary_2: /gentest/proj/icu/icu-issue-22798/generated2/generated.cc:31: int main(): Assertion `status == U_INDEX_OUTOFBOUNDS_ERROR' failed.\n"}