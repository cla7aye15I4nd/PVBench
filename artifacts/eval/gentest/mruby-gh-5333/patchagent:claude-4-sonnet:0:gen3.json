{"patch": "diff --git a/src/hash.c b/src/hash.c\nindex 289f02a91..205ce4a79 100644\n--- a/src/hash.c\n+++ b/src/hash.c\n@@ -719,8 +719,11 @@ static uint32_t\n ib_byte_size_for(uint32_t ib_bit)\n {\n   uint32_t ary_size = IB_INIT_BIT == 4 ?\n-    ib_bit_to_capa(ib_bit) * 2 / IB_TYPE_BIT * ib_bit / 2 :\n-    ib_bit_to_capa(ib_bit) / IB_TYPE_BIT * ib_bit;\n+    ib_bit_to_capa(ib_bit) * 2 / IB_TYPE_BIT * ib_bit / 2 + 1 :\n+    ib_bit_to_capa(ib_bit) / IB_TYPE_BIT * ib_bit + 1;\n+  \n+  /* Ensure minimum size to prevent out-of-bounds access */\n+  if (ary_size < 2) ary_size = 2;\n   return U32(sizeof(uint32_t) * ary_size);\n }\n \n", "result": true}