{"patch": "diff --git a/src/hash.c b/src/hash.c\nindex 289f02a91..1ba08356c 100644\n--- a/src/hash.c\n+++ b/src/hash.c\n@@ -719,8 +719,10 @@ static uint32_t\n ib_byte_size_for(uint32_t ib_bit)\n {\n   uint32_t ary_size = IB_INIT_BIT == 4 ?\n-    ib_bit_to_capa(ib_bit) * 2 / IB_TYPE_BIT * ib_bit / 2 :\n-    ib_bit_to_capa(ib_bit) / IB_TYPE_BIT * ib_bit;\n+    ib_bit_to_capa(ib_bit) * ib_bit / IB_TYPE_BIT :\n+    ib_bit_to_capa(ib_bit) * ib_bit / IB_TYPE_BIT;\n+  /* Ensure minimum buffer size to prevent buffer overflow */\n+  if (ary_size == 0) ary_size = 1;\n   return U32(sizeof(uint32_t) * ary_size);\n }\n \n", "result": true}