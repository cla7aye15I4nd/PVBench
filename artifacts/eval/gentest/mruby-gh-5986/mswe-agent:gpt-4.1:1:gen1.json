{"patch": "diff --git a/.gitignore b/.gitignore\nindex c2918f31a..6bf18697a 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -32,3 +32,13 @@ compile_flags.txt\n cscope.files\n cscope.out\n tags\n+build/\n+Build/\n+bin/\n+lib/\n+*.out\n+*.obj\n+*.exe\n+*.dll\n+*.so\n+*.dylib\ndiff --git a/src/string.c b/src/string.c\nindex 1bd3f6f8f..7b02ea23d 100644\n--- a/src/string.c\n+++ b/src/string.c\n@@ -2950,6 +2950,13 @@ str_bytesplice(mrb_state *mrb, mrb_value str, mrb_int idx1, mrb_int len1, mrb_va\n   if (RSTR_LEN(s) < idx1 || RSTRING_LEN(replace) < idx2) {\n     mrb_raise(mrb, E_INDEX_ERROR, \"index out of string\");\n   }\n+  /* Prevent integer overflow in idx1+len1 and idx2+len2 */\n+  if ((len1 > 0 && idx1 > MRB_INT_MAX - len1) || (len1 < 0 && idx1 < MRB_INT_MIN - len1)) {\n+    mrb_raise(mrb, E_INDEX_ERROR, \"index+len1 overflow\");\n+  }\n+  if ((len2 > 0 && idx2 > MRB_INT_MAX - len2) || (len2 < 0 && idx2 < MRB_INT_MIN - len2)) {\n+    mrb_raise(mrb, E_INDEX_ERROR, \"index+len2 overflow\");\n+  }\n   if (RSTR_LEN(s) <= idx1+len1) {\n     len1 = RSTR_LEN(s) - idx1;\n   }\n", "result": false, "error": "trace (most recent call last):\n\t[2] /gentest-mruby/mruby-gh-5986/generated_1.rb:146\n\t[1] /gentest-mruby/mruby-gh-5986/generated_1.rb:75:in test_negative_len1_clamped_to_zero\n/gentest-mruby/mruby-gh-5986/generated_1.rb:21:in assert_equal: negative len1 must be treated as 0 (pure insertion) (RuntimeError)\n"}