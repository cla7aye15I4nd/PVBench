{"patch": "diff --git a/src/string.c b/src/string.c\nindex 1bd3f6f8f..7383e013b 100644\n--- a/src/string.c\n+++ b/src/string.c\n@@ -2948,11 +2948,20 @@ str_bytesplice(mrb_state *mrb, mrb_value str, mrb_int idx1, mrb_int len1, mrb_va\n {\n   struct RString *s = RSTRING(str);\n   if (RSTR_LEN(s) < idx1 || RSTRING_LEN(replace) < idx2) {\n-    mrb_raise(mrb, E_INDEX_ERROR, \"index out of string\");\n+// FIXME: Crash CWE-190: Integer Overflow or Wraparound\n+     mrb_raise(mrb, E_INDEX_ERROR, \"index out of string\");\n+  }\n+  /* Check for integer overflow in idx1+len1 */\n+  if (idx1 > 0 && len1 > LONG_MAX - idx1) {\n+    mrb_raise(mrb, E_ARGUMENT_ERROR, \"integer overflow in string operation\");\n   }\n   if (RSTR_LEN(s) <= idx1+len1) {\n     len1 = RSTR_LEN(s) - idx1;\n   }\n+  /* Check for integer overflow in idx2+len2 */\n+  if (idx2 > 0 && len2 > LONG_MAX - idx2) {\n+    mrb_raise(mrb, E_ARGUMENT_ERROR, \"integer overflow in string operation\");\n+  }\n   if (RSTRING_LEN(replace) <= idx2+len2) {\n     len2 = RSTRING_LEN(replace) - idx2;\n   }\n", "result": false, "error": "trace (most recent call last):\n\t[1] /gentest-mruby/mruby-gh-5986/generated_2.rb:23\n/gentest-mruby/mruby-gh-5986/generated_2.rb:11:in assert_nothing_raised: bytesplice huge len (INT32) should not crash and return self: got ArgumentError: string too long (len=2147483661 max=1048576) (TestFailure)\n"}