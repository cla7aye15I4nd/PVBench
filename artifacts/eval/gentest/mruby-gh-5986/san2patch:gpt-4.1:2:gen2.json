{"patch": "diff --git a/src/string.c b/src/string.c\nindex 1bd3f6f8f..f83e7212f 100644\n--- a/src/string.c\n+++ b/src/string.c\n@@ -3002,25 +3002,31 @@ mrb_str_bytesplice(mrb_state *mrb, mrb_value str)\n   switch (mrb_get_argc(mrb)) {\n   case 3:\n     mrb_get_args(mrb, \"ooo\", &range1, &replace, &range2);\n-    if (mrb_integer_p(range1)) {\n+// FIXME: Crash CWE-190: Integer Overflow or Wraparound\n+     if (mrb_integer_p(range1)) {\n       mrb_get_args(mrb, \"iiS\", &idx1, &len1, &replace);\n+      if ((len1 > 0 && idx1 > MRB_INT_MAX - len1) || (len1 < 0 && idx1 < MRB_INT_MIN - len1)) break;\n       return str_bytesplice(mrb, str, idx1, len1, replace, 0, RSTRING_LEN(replace));\n     }\n     mrb_ensure_string_type(mrb, replace);\n     if (mrb_range_beg_len(mrb, range1, &idx1, &len1, RSTRING_LEN(str), FALSE) != MRB_RANGE_OK) break;\n     if (mrb_range_beg_len(mrb, range2, &idx2, &len2, RSTRING_LEN(replace), FALSE) != MRB_RANGE_OK) break;\n+    if ((len2 > 0 && idx2 > MRB_INT_MAX - len2) || (len2 < 0 && idx2 < MRB_INT_MIN - len2)) break;\n     return str_bytesplice(mrb, str, idx1, len1, replace, idx2, len2);\n   case 5:\n     mrb_get_args(mrb, \"iiSii\", &idx1, &len1, &replace, &idx2, &len2);\n+    if ((len2 > 0 && idx2 > MRB_INT_MAX - len2) || (len2 < 0 && idx2 < MRB_INT_MIN - len2)) break;\n     return str_bytesplice(mrb, str, idx1, len1, replace, idx2, len2);\n   case 2:\n     mrb_get_args(mrb, \"oS\", &range1, &replace);\n     if (mrb_range_beg_len(mrb, range1, &idx1, &len1, RSTRING_LEN(str), FALSE) == MRB_RANGE_OK) {\n+      if ((len1 > 0 && idx1 > MRB_INT_MAX - len1) || (len1 < 0 && idx1 < MRB_INT_MIN - len1)) break;\n       return str_bytesplice(mrb, str, idx1, len1, replace, 0, RSTRING_LEN(replace));\n     }\n   default:\n     break;\n   }\n+\n   mrb_raise(mrb, E_ARGUMENT_ERROR, \"wrong number of arumgnts\");\n }\n \n", "result": false, "error": "trace (most recent call last):\n\t[1] /gentest-mruby/mruby-gh-5986/generated_2.rb:23\n/gentest-mruby/mruby-gh-5986/generated_2.rb:11:in assert_nothing_raised: bytesplice huge len (INT32) should not crash and return self: got ArgumentError: string too long (len=2147483661 max=1048576) (TestFailure)\n"}