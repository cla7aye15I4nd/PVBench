{"patch": "diff --git a/Packet++/src/DnsLayer.cpp b/Packet++/src/DnsLayer.cpp\nindex 644ea89b..3863c4a7 100644\n--- a/Packet++/src/DnsLayer.cpp\n+++ b/Packet++/src/DnsLayer.cpp\n@@ -475,7 +475,7 @@ DnsResource* DnsLayer::addResource(DnsResourceType resType, const std::string& n\n \t\tuint32_t ttl, IDnsResourceData* data)\n {\n \t// create new query on temporary buffer\n-\tuint8_t newResourceRawData[256];\n+\tuint8_t newResourceRawData[4096];\n \tmemset(newResourceRawData, 0, sizeof(newResourceRawData));\n \n \tDnsResource* newResource = new DnsResource(newResourceRawData, resType);\ndiff --git a/Packet++/src/DnsResource.cpp b/Packet++/src/DnsResource.cpp\nindex 8c72cc57..b440d250 100644\n--- a/Packet++/src/DnsResource.cpp\n+++ b/Packet++/src/DnsResource.cpp\n@@ -345,7 +345,7 @@ bool DnsResource::setData(IDnsResourceData* data)\n {\n \t// convert data to byte array according to the DNS type\n \tsize_t dataLength = 0;\n-\tuint8_t dataAsByteArr[256];\n+\tuint8_t dataAsByteArr[4096];\n \n \tif (data == nullptr)\n \t{\ndiff --git a/Packet++/src/DnsResourceData.cpp b/Packet++/src/DnsResourceData.cpp\nindex 8183511d..4d992f5f 100644\n--- a/Packet++/src/DnsResourceData.cpp\n+++ b/Packet++/src/DnsResourceData.cpp\n@@ -222,6 +222,12 @@ bool GenericDnsResourceData::toByteArr(uint8_t* arr, size_t& arrLength, IDnsReso\n \t\treturn false;\n \t}\n \n+\tif (m_DataLen > 4096)\n+\t{\n+\t\tPCPP_LOG_ERROR(\"Input data is null or illegal\");\n+\t\treturn false;\n+\t}\n+\n \tarrLength = m_DataLen;\n \tmemcpy(arr, m_Data, m_DataLen);\n \treturn true;\n", "result": true}