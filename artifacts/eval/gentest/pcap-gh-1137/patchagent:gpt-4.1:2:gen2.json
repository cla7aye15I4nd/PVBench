{"patch": "diff --git a/Packet++/header/DnsResourceData.h b/Packet++/header/DnsResourceData.h\nindex 9acd8a76..c787066d 100644\n--- a/Packet++/header/DnsResourceData.h\n+++ b/Packet++/header/DnsResourceData.h\n@@ -381,6 +381,11 @@ namespace pcpp\n \n \t\tGenericDnsResourceData& operator=(const GenericDnsResourceData& other);\n \n+\t\t/**\n+\t\t * Returns raw data length\n+\t\t */\n+\t\tsize_t getLength() const { return m_DataLen; }\n+\n \t\t/**\n \t\t * Equality operator overload for this class that compares the raw data stored in each object\n \t\t * @param[in] other The object to compare with\ndiff --git a/Packet++/src/DnsResource.cpp b/Packet++/src/DnsResource.cpp\nindex 8c72cc57..5087663a 100644\n--- a/Packet++/src/DnsResource.cpp\n+++ b/Packet++/src/DnsResource.cpp\n@@ -345,7 +345,19 @@ bool DnsResource::setData(IDnsResourceData* data)\n {\n \t// convert data to byte array according to the DNS type\n \tsize_t dataLength = 0;\n-\tuint8_t dataAsByteArr[256];\n+\tconst size_t maxDataLen = 256;\n+\tuint8_t dataAsByteArr[maxDataLen];\n+\n+\t// Prevent stack buffer overflow for GenericDnsResourceData\n+\tGenericDnsResourceData* genericData = dynamic_cast<GenericDnsResourceData*>(data);\n+\tif (genericData != nullptr)\n+\t{\n+\t\tif (genericData->getLength() > maxDataLen)\n+\t\t{\n+\t\t\tPCPP_LOG_ERROR(\"DNS resource data too large (\" << genericData->getLength() << \" bytes), max allowed is \" << maxDataLen);\n+\t\t\treturn false;\n+\t\t}\n+\t}\n \n \tif (data == nullptr)\n \t{\n", "result": false, "error": ".test_binary_2: /gentest/proj/pcapplusplus/pcap-gh-1137/generated2/generated.cc:29: int main(int, char **): Assertion `answer != nullptr' failed.\n"}