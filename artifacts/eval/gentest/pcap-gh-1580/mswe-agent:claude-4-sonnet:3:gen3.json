{"patch": "diff --git a/.gitignore b/.gitignore\nindex 463ce5df..cfb1fc2a 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -77,3 +77,8 @@ venv/**\n \n #MacOS system files\n **/.DS_Store\n+Build/\n+bin/\n+lib/\n+*.out\n+*.exe\ndiff --git a/Packet++/src/Packet.cpp b/Packet++/src/Packet.cpp\nindex 30a2790f..327d80ca 100644\n--- a/Packet++/src/Packet.cpp\n+++ b/Packet++/src/Packet.cpp\n@@ -84,11 +84,25 @@ namespace pcpp\n \n \t\tif (curLayer != nullptr && curLayer->getOsiModelLayer() > parseUntilLayer)\n \t\t{\n-\t\t\tm_LastLayer = curLayer->getPrevLayer();\n-\t\t\tdelete curLayer;\n-\t\t\tm_LastLayer->m_NextLayer = nullptr;\n+\t\t\tLayer* prevLayer = curLayer->getPrevLayer();\n+\t\t\tif (prevLayer != nullptr)\n+\t\t\t{\n+\t\t\t\tprevLayer->m_NextLayer = nullptr;\n+\t\t\t\tm_LastLayer = prevLayer;\n+\t\t\t}\n+\t\t\telse\n+\t\t\t{\n+\t\t\t\t// If there's no previous layer, this means curLayer is the first layer\n+\t\t\t\t// but it exceeds parseUntilLayer, so we should have no layers\n+\t\t\t\tm_FirstLayer = nullptr;\n+\t\t\t\tm_LastLayer = nullptr;\n+\t\t\t}\n+\t\t\t// Don't delete curLayer here - let destructPacketData handle it\n+\t\t\t// Just mark it as not part of the chain\n+\t\t\tcurLayer->m_PrevLayer = nullptr;\n \t\t}\n \n+\n \t\tif (m_LastLayer != nullptr && parseUntil == UnknownProtocol && parseUntilLayer == OsiModelLayerUnknown)\n \t\t{\n \t\t\t// find if there is data left in the raw packet that doesn't belong to any layer. In that case it's probably\n", "result": true}