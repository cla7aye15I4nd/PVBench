{"patch": "diff --git a/Packet++/src/GtpLayer.cpp b/Packet++/src/GtpLayer.cpp\nindex 2e935cf5..283c6b30 100644\n--- a/Packet++/src/GtpLayer.cpp\n+++ b/Packet++/src/GtpLayer.cpp\n@@ -405,10 +405,19 @@ namespace pcpp\n \t\t\tPCPP_LOG_ERROR(\"Add extension failed: cannot extend layer\");\n \t\t\treturn {};\n \t\t}\n-\n-\t\t// lastExt != null means layer contains 1 or more extensions\n+\t\t// After extendLayer, m_Data may have changed, so refresh pointers and objects\n+\t\theader = getHeader();\n+\t\theaderExtra = getHeaderExtra();\n+\t\t// Reconstruct lastExt if there were any extensions before\n \t\tif (!lastExt.isNull())\n \t\t{\n+\t\t\t// Find the new lastExt in the new buffer\n+\t\t\tGtpV1Layer::GtpExtension ext = getNextExtension();\n+\t\t\twhile (!ext.getNextExtension().isNull())\n+\t\t\t{\n+\t\t\t\text = ext.getNextExtension();\n+\t\t\t}\n+\t\t\tlastExt = ext;\n \t\t\t// set the next header type in the last extension\n \t\t\tlastExt.setNextHeaderType(extensionType);\n \t\t}\n", "result": true}