{"patch": "diff --git a/Packet++/src/GtpLayer.cpp b/Packet++/src/GtpLayer.cpp\nindex 2e935cf5..6baeefb2 100644\n--- a/Packet++/src/GtpLayer.cpp\n+++ b/Packet++/src/GtpLayer.cpp\n@@ -405,6 +405,14 @@ namespace pcpp\n \t\t\tPCPP_LOG_ERROR(\"Add extension failed: cannot extend layer\");\n \t\t\treturn {};\n \t\t}\n+\t\t// After extendLayer, m_Data may have changed, so refresh header and headerExtra pointers\n+\t\theader = getHeader();\n+\t\theaderExtra = getHeaderExtra();\n+\t\tif (header == nullptr || headerExtra == nullptr)\n+\t\t{\n+\t\t\tPCPP_LOG_ERROR(\"Add extension failed: header or extra header is nullptr after extendLayer\");\n+\t\t\treturn {};\n+\t\t}\n \n \t\t// lastExt != null means layer contains 1 or more extensions\n \t\tif (!lastExt.isNull())\n", "result": true}