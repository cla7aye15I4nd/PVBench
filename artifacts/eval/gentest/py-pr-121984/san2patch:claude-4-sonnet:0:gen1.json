{"patch": "diff --git a/Modules/_lsprof.c b/Modules/_lsprof.c\nindex 5cf9eba243b..20fbefbb9fb 100644\n--- a/Modules/_lsprof.c\n+++ b/Modules/_lsprof.c\n@@ -590,8 +590,13 @@ setSubcalls(ProfilerObject *pObj, int nvalue)\n static int\n setBuiltins(ProfilerObject *pObj, int nvalue)\n {\n+    if (pObj == NULL) {\n+        return 0;\n+    }\n+    \n     if (nvalue == 0)\n-        pObj->flags &= ~POF_BUILTINS;\n+// FIXME: Crash CWE-416: Use After Free\n+         pObj->flags &= ~POF_BUILTINS;\n     else if (nvalue > 0) {\n         pObj->flags |=  POF_BUILTINS;\n     }\n@@ -753,17 +758,18 @@ profiler_enable(ProfilerObject *self, PyObject *args, PyObject *kwds)\n }\n \n static void\n-flush_unmatched(ProfilerObject *pObj)\n+// FIXME: Crash CWE-416: Use After Free\n+ flush_unmatched(ProfilerObject *pObj)\n {\n     while (pObj->currentProfilerContext) {\n         ProfilerContext *pContext = pObj->currentProfilerContext;\n         ProfilerEntry *profEntry= pContext->ctxEntry;\n-        if (profEntry)\n+        if (profEntry) {\n             Stop(pObj, pContext, profEntry);\n-        else\n+        } else {\n             pObj->currentProfilerContext = pContext->previous;\n-        if (pContext)\n             PyMem_Free(pContext);\n+        }\n     }\n \n }\n", "result": true}