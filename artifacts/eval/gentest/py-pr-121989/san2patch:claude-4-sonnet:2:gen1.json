{"patch": "diff --git a/Modules/_lsprof.c b/Modules/_lsprof.c\nindex 257de4387c0..ae03b2a77f4 100644\n--- a/Modules/_lsprof.c\n+++ b/Modules/_lsprof.c\n@@ -289,6 +289,10 @@ static void clearEntries(ProfilerObject *pObj)\n static void\n initContext(ProfilerObject *pObj, ProfilerContext *self, ProfilerEntry *entry)\n {\n+// FIXME: Crash CWE-416: Use After Free\n+    if (self == NULL || entry == NULL) {\n+        return;\n+    }\n     self->ctxEntry = entry;\n     self->subt = 0;\n     self->previous = pObj->currentProfilerContext;\n@@ -745,7 +749,8 @@ profiler_enable(ProfilerObject *self, PyObject *args, PyObject *kwds)\n     Py_DECREF(monitoring);\n \n     self->flags |= POF_ENABLED;\n-    Py_RETURN_NONE;\n+// FIXME: Crash CWE-416: Use After Free\n+     Py_RETURN_NONE;\n }\n \n static void\n@@ -753,11 +758,11 @@ flush_unmatched(ProfilerObject *pObj)\n {\n     while (pObj->currentProfilerContext) {\n         ProfilerContext *pContext = pObj->currentProfilerContext;\n+        pObj->currentProfilerContext = pContext->previous;\n         ProfilerEntry *profEntry= pContext->ctxEntry;\n         if (profEntry)\n             Stop(pObj, pContext, profEntry);\n-        else\n-            pObj->currentProfilerContext = pContext->previous;\n+        pContext = NULL;\n         if (pContext)\n             PyMem_Free(pContext);\n     }\n", "result": false, "error": "Traceback (most recent call last):\n  File \"/gentest-cpython/py-pr-121989/generated_1.py\", line 186, in <module>\n    test_disable_in_external_timer_disallowed_call_and_return_events()\n  File \"/gentest-cpython/py-pr-121989/generated_1.py\", line 70, in test_disable_in_external_timer_disallowed_call_and_return_events\n    run_subprocess_and_check(code, expected)\n  File \"/gentest-cpython/py-pr-121989/generated_1.py\", line 35, in run_subprocess_and_check\n    assert s in err, f\"Expected {s!r} in stderr, got: {err!r}\"\n           ^^^^^^^^\nAssertionError: Expected b'RuntimeError: cannot disable profiler in external timer' in stderr, got: b''\n"}