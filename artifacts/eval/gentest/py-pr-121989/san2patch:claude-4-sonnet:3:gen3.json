{"patch": "diff --git a/Modules/_lsprof.c b/Modules/_lsprof.c\nindex 257de4387c0..2526b8fa6ef 100644\n--- a/Modules/_lsprof.c\n+++ b/Modules/_lsprof.c\n@@ -754,12 +754,13 @@ flush_unmatched(ProfilerObject *pObj)\n     while (pObj->currentProfilerContext) {\n         ProfilerContext *pContext = pObj->currentProfilerContext;\n         ProfilerEntry *profEntry= pContext->ctxEntry;\n-        if (profEntry)\n+        if (profEntry) {\n             Stop(pObj, pContext, profEntry);\n-        else\n+        } else {\n             pObj->currentProfilerContext = pContext->previous;\n-        if (pContext)\n-            PyMem_Free(pContext);\n+            if (pContext)\n+                PyMem_Free(pContext);\n+        }\n     }\n \n }\n@@ -807,8 +808,8 @@ profiler_disable(ProfilerObject *self, PyObject* noarg)\n \n         Py_DECREF(monitoring);\n \n-        self->flags &= ~POF_ENABLED;\n         flush_unmatched(self);\n+        self->flags &= ~POF_ENABLED;\n     }\n \n     if (pending_exception(self)) {\n", "result": true}