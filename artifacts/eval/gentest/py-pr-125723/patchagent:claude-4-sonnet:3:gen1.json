{"patch": "diff --git a/Objects/frameobject.c b/Objects/frameobject.c\nindex d6b4065e130..25a786d80fd 100644\n--- a/Objects/frameobject.c\n+++ b/Objects/frameobject.c\n@@ -30,6 +30,11 @@ framelocalsproxy_getval(_PyInterpreterFrame *frame, PyCodeObject *co, int i)\n     PyObject *value = PyStackRef_AsPyObjectBorrow(fast[i]);\n     PyObject *cell = NULL;\n \n+    // Defensive check: if we got a high-value pointer, it's likely invalid\n+    if (value != NULL && ((uintptr_t)value) > 0x7fffffffffff) {\n+        return NULL;\n+    }\n+\n     if (value == NULL) {\n         return NULL;\n     }\n@@ -37,16 +42,18 @@ framelocalsproxy_getval(_PyInterpreterFrame *frame, PyCodeObject *co, int i)\n     if (kind == CO_FAST_FREE || kind & CO_FAST_CELL) {\n         // The cell was set when the frame was created from\n         // the function's closure.\n-        assert(PyCell_Check(value));\n-        cell = value;\n+        if (PyCell_Check(value)) {\n+            cell = value;\n+        } else {\n+            return NULL;  // Invalid cell object\n+        }\n     }\n \n     if (cell != NULL) {\n         value = PyCell_GET(cell);\n-    }\n-\n-    if (value == NULL) {\n-        return NULL;\n+        if (value == NULL) {\n+            return NULL;\n+        }\n     }\n \n     return value;\n@@ -135,8 +142,10 @@ framelocalsproxy_getitem(PyObject *self, PyObject *key)\n     }\n     if (i >= 0) {\n         PyObject *value = framelocalsproxy_getval(frame->f_frame, co, i);\n-        assert(value != NULL);\n-        return Py_NewRef(value);\n+        if (value != NULL) {\n+            return Py_NewRef(value);\n+        }\n+        // Fall through to check extra locals\n     }\n \n     // Okay not in the fast locals, try extra locals\n", "result": false, "error": "Traceback (most recent call last):\n  File \"/gentest-cpython/py-pr-125723/generated_1.py\", line 192, in <module>\n    test_frame_outlives_generator()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/gentest-cpython/py-pr-125723/generated_1.py\", line 60, in test_frame_outlives_generator\n    rc, out, err = assert_python_ok('-c', code)\n                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^\n  File \"/tmp/py-pr-125723/build/Lib/test/support/script_helper.py\", line 182, in assert_python_ok\n    return _assert_python(True, *args, **env_vars)\n  File \"/tmp/py-pr-125723/build/Lib/test/support/script_helper.py\", line 167, in _assert_python\n    res.fail(cmd_line)\n    ~~~~~~~~^^^^^^^^^^\n  File \"/tmp/py-pr-125723/build/Lib/test/support/script_helper.py\", line 80, in fail\n    raise AssertionError(f\"Process return code is {exitcode}\\n\"\n    ...<10 lines>...\n                         f\"---\")\nAssertionError: Process return code is 1\ncommand line: ['/tmp/py-pr-125723/build/python', '-X', 'faulthandler', '-I', '-c', 'if 1:\\n        import sys, gc\\n\\n        def g1():\\n            a = 42\\n            yield sys._getframe()\\n\\n        def g2():\\n            a = 42\\n            yield\\n\\n        def g3(container):\\n            a = 42\\n            container[\\'frame\\'] = sys._getframe()\\n            yield\\n\\n        def get_frame(index):\\n            if index == 1:\\n                # Frame captured directly from inside the generator\\n                return next(g1())\\n            elif index == 2:\\n                # Use gi_frame after advancing the generator\\n                gen = g2()\\n                next(gen)\\n                return gen.gi_frame\\n            elif index == 3:\\n                # Store frame externally so it outlives the generator\\n                box = {}\\n                next(g3(box))\\n                return box[\\'frame\\']\\n            else:\\n                return None\\n\\n        for i in (1, 2, 3):\\n            f = get_frame(i)\\n            # Force GC to ensure the generator is collected\\n            gc.collect()\\n            locals_map = f.f_locals\\n            assert \\'a\\' in locals_map, f\"Missing \\'a\\' in f_locals for case {i}: {locals_map}\"\\n            assert locals_map[\\'a\\'] == 42, (\\n                f\"Unexpected value for \\'a\\' in case {i}: {locals_map.get(\\'a\\')}\"\\n            )\\n        print(\\'FRAME_OK\\')\\n    ']\n\nstdout:\n---\n\n---\n\nstderr:\n---\nTraceback (most recent call last):\n  File \"<string>\", line 39, in <module>\n    assert 'a' in locals_map, f\"Missing 'a' in f_locals for case {i}: {locals_map}\"\n           ^^^^^^^^^^^^^^^^^\nAssertionError: Missing 'a' in f_locals for case 1: {}\n---\n"}