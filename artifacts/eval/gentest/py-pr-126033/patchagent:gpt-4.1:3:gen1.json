{"patch": "diff --git a/Modules/_elementtree.c b/Modules/_elementtree.c\nindex b73bd844626..08dc90101af 100644\n--- a/Modules/_elementtree.c\n+++ b/Modules/_elementtree.c\n@@ -1632,7 +1632,8 @@ _elementtree_Element_remove_impl(ElementObject *self, PyObject *subelement)\n     int rc;\n     PyObject *found;\n \n-    if (!self->extra) {\n+    ElementObjectExtra *extra = self->extra;\n+    if (!extra) {\n         /* element has no children, so raise exception */\n         PyErr_SetString(\n             PyExc_ValueError,\n@@ -1641,30 +1642,47 @@ _elementtree_Element_remove_impl(ElementObject *self, PyObject *subelement)\n         return NULL;\n     }\n \n-    for (i = 0; i < self->extra->length; i++) {\n-        if (self->extra->children[i] == subelement)\n+    for (i = 0; i < extra->length; i++) {\n+        if (extra->children[i] == subelement)\n             break;\n-        rc = PyObject_RichCompareBool(self->extra->children[i], subelement, Py_EQ);\n+        rc = PyObject_RichCompareBool(extra->children[i], subelement, Py_EQ);\n+        /* After a comparison, self->extra may have changed or been freed */\n+        if (self->extra != extra || self->extra == NULL) {\n+            PyErr_SetString(\n+                PyExc_RuntimeError,\n+                \"element mutated during remove operation\"\n+            );\n+            return NULL;\n+        }\n         if (rc > 0)\n             break;\n         if (rc < 0)\n             return NULL;\n     }\n \n-    if (i >= self->extra->length) {\n+    /* After the loop, re-check extra in case of mutation */\n+    if (self->extra != extra || self->extra == NULL) {\n+        PyErr_SetString(\n+            PyExc_RuntimeError,\n+            \"element mutated during remove operation\"\n+        );\n+        return NULL;\n+    }\n+\n+    if (i >= extra->length) {\n         /* subelement is not in children, so raise exception */\n         PyErr_SetString(\n             PyExc_ValueError,\n             \"list.remove(x): x not in list\"\n-            );\n+        );\n         return NULL;\n     }\n \n-    found = self->extra->children[i];\n+    found = extra->children[i];\n \n-    self->extra->length--;\n-    for (; i < self->extra->length; i++)\n-        self->extra->children[i] = self->extra->children[i+1];\n+    extra->length--;\n+    for (; i < extra->length; i++)\n+        extra->children[i] = extra->children[i+1];\n \n     Py_DECREF(found);\n     Py_RETURN_NONE;\n", "result": true}