{"patch": "diff --git a/Python/Python-ast.c b/Python/Python-ast.c\nindex 38d74b48d23..fbf56d1ce25 100644\n--- a/Python/Python-ast.c\n+++ b/Python/Python-ast.c\n@@ -5128,15 +5128,20 @@ ast_type_init(PyObject *self, PyObject *args, PyObject *kw)\n         }\n     }\n     if (kw) {\n-        i = 0;  /* needed by PyDict_Next */\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+         i = 0;  /* needed by PyDict_Next */\n         while (PyDict_Next(kw, &i, &key, &value)) {\n+            if (fields == NULL) {\n+                PyErr_SetString(PyExc_TypeError, \"fields cannot be NULL\");\n+                res = -1;\n+                goto cleanup;\n+            }\n             int contains = PySequence_Contains(fields, key);\n             if (contains == -1) {\n                 res = -1;\n                 goto cleanup;\n             }\n-            else if (contains == 1) {\n-                int p = PySet_Discard(remaining_fields, key);\n+            else if (contains == 1) {                int p = PySet_Discard(remaining_fields, key);\n                 if (p == -1) {\n                     res = -1;\n                     goto cleanup;\n", "result": false, "error": "Traceback (most recent call last):\n  File \"/gentest-cpython/py-pr-126105/generated_3.py\", line 55, in <module>\n    test_missing__fields_either_crashes_prepatch_or_raises_attributeerror_postpatch()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/gentest-cpython/py-pr-126105/generated_3.py\", line 41, in test_missing__fields_either_crashes_prepatch_or_raises_attributeerror_postpatch\n    assert b'Fatal Python error' in err or b'Segmentation fault' in err or rc < 0, (\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAssertionError: Expected a crash-like failure pre-patch; rc=1, stderr=b'Traceback (most recent call last):\\n  File \"<string>\", line 8, in <module>\\n    ast.AST(arg1=123)\\n    ~~~~~~~^^^^^^^^^^\\nTypeError: fields cannot be NULL\\n'\n"}