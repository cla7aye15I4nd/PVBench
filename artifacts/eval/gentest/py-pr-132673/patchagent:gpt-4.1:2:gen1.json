{"patch": "diff --git a/Modules/_ctypes/stgdict.c b/Modules/_ctypes/stgdict.c\nindex ad82e4891c5..e8d5cf9bc92 100644\n--- a/Modules/_ctypes/stgdict.c\n+++ b/Modules/_ctypes/stgdict.c\n@@ -570,6 +570,10 @@ PyCStructUnionType_update_stginfo(PyObject *type, PyObject *fields, int isStruct\n     }\n \n     /* Adjust the size according to the alignment requirements */\n+    if (total_align == 0) {\n+        PyErr_SetString(PyExc_ValueError, \"total_align is zero, cannot compute aligned size\");\n+        return -1;\n+    }\n     aligned_size = ((size + total_align - 1) / total_align) * total_align;\n \n     if (isStruct) {\n", "result": false, "error": "Traceback (most recent call last):\n  File \"/gentest-cpython/py-pr-132673/generated_1.py\", line 71, in <module>\n    test_no_crash_zero_align_empty_fields_in_subprocess()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/gentest-cpython/py-pr-132673/generated_1.py\", line 39, in test_no_crash_zero_align_empty_fields_in_subprocess\n    rc, out, err = assert_python_ok('-c', code)\n                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^\n  File \"/tmp/py-pr-132673/build/Lib/test/support/script_helper.py\", line 180, in assert_python_ok\n    return _assert_python(True, *args, **env_vars)\n  File \"/tmp/py-pr-132673/build/Lib/test/support/script_helper.py\", line 165, in _assert_python\n    res.fail(cmd_line)\n    ~~~~~~~~^^^^^^^^^^\n  File \"/tmp/py-pr-132673/build/Lib/test/support/script_helper.py\", line 75, in fail\n    raise AssertionError(\"Process return code is %d\\n\"\n    ...<13 lines>...\n                            err))\nAssertionError: Process return code is 1\ncommand line: ['/tmp/py-pr-132673/build/python', '-X', 'faulthandler', '-I', '-c', 'if 1:\\n        from ctypes import Structure, LittleEndianStructure, BigEndianStructure, Union, alignment\\n\\n        def check_base(base):\\n            class S(base):\\n                _align_ = 0\\n                _fields_ = []\\n            a_cls = alignment(S)\\n            a_inst = alignment(S())\\n            if a_cls == 1 and a_inst == 1:\\n                print(\"OK:\", base.__name__, a_cls, a_inst)\\n            else:\\n                print(\"BAD:\", base.__name__, a_cls, a_inst)\\n\\n        for base in (Structure, LittleEndianStructure, BigEndianStructure):\\n            check_base(base)\\n\\n        # Also verify Union separately\\n        check_base(Union)\\n    ']\n\nstdout:\n---\n\n---\n\nstderr:\n---\nTraceback (most recent call last):\n  File \"<string>\", line 16, in <module>\n    check_base(base)\n    ~~~~~~~~~~^^^^^^\n  File \"<string>\", line 5, in check_base\n    class S(base):\n        _align_ = 0\n        _fields_ = []\nValueError: total_align is zero, cannot compute aligned size\n---\n"}