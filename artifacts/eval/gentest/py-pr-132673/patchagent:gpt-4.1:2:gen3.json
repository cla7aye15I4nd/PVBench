{"patch": "diff --git a/Modules/_ctypes/stgdict.c b/Modules/_ctypes/stgdict.c\nindex ad82e4891c5..e8d5cf9bc92 100644\n--- a/Modules/_ctypes/stgdict.c\n+++ b/Modules/_ctypes/stgdict.c\n@@ -570,6 +570,10 @@ PyCStructUnionType_update_stginfo(PyObject *type, PyObject *fields, int isStruct\n     }\n \n     /* Adjust the size according to the alignment requirements */\n+    if (total_align == 0) {\n+        PyErr_SetString(PyExc_ValueError, \"total_align is zero, cannot compute aligned size\");\n+        return -1;\n+    }\n     aligned_size = ((size + total_align - 1) / total_align) * total_align;\n \n     if (isStruct) {\n", "result": false, "error": "Traceback (most recent call last):\n  File \"/gentest-cpython/py-pr-132673/generated_3.py\", line 114, in <module>\n    test_subprocess_zero_align_empty_fields_no_crash()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/gentest-cpython/py-pr-132673/generated_3.py\", line 47, in test_subprocess_zero_align_empty_fields_no_crash\n    rc, out, err = assert_python_ok('-c', code)\n                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^\n  File \"/tmp/py-pr-132673/build/Lib/test/support/script_helper.py\", line 180, in assert_python_ok\n    return _assert_python(True, *args, **env_vars)\n  File \"/tmp/py-pr-132673/build/Lib/test/support/script_helper.py\", line 165, in _assert_python\n    res.fail(cmd_line)\n    ~~~~~~~~^^^^^^^^^^\n  File \"/tmp/py-pr-132673/build/Lib/test/support/script_helper.py\", line 75, in fail\n    raise AssertionError(\"Process return code is %d\\n\"\n    ...<13 lines>...\n                            err))\nAssertionError: Process return code is 1\ncommand line: ['/tmp/py-pr-132673/build/python', '-X', 'faulthandler', '-I', '-c', 'if 1:\\n        from ctypes import Structure, LittleEndianStructure, BigEndianStructure, Union, alignment\\n\\n        # Build classes with unique names for clear output\\n        tests = []\\n        for name, base in (\\n            (\"Struct\", Structure),\\n            (\"LEStruct\", LittleEndianStructure),\\n            (\"BEStruct\", BigEndianStructure),\\n        ):\\n            class S(base):\\n                _align_ = 0\\n                _fields_ = []\\n            S.__name__ = name\\n            tests.append((name, S))\\n\\n        class U(Union):\\n            _align_ = 0\\n            _fields_ = []\\n        U.__name__ = \"U\"\\n        tests.append((\"Union\", U))\\n\\n        # Print alignment for type and instance so the parent process can assert\\n        for label, cls in tests:\\n            print(f\"{label}:type_align={alignment(cls)}\")\\n            print(f\"{label}:inst_align={alignment(cls())}\")\\n    ']\n\nstdout:\n---\n\n---\n\nstderr:\n---\nTraceback (most recent call last):\n  File \"<string>\", line 11, in <module>\n    class S(base):\n        _align_ = 0\n        _fields_ = []\nValueError: total_align is zero, cannot compute aligned size\n---\n"}