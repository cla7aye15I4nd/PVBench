{"patch": "diff --git a/Modules/_ctypes/stgdict.c b/Modules/_ctypes/stgdict.c\nindex ad82e4891c5..7189866eb3c 100644\n--- a/Modules/_ctypes/stgdict.c\n+++ b/Modules/_ctypes/stgdict.c\n@@ -568,9 +568,14 @@ PyCStructUnionType_update_stginfo(PyObject *type, PyObject *fields, int isStruct\n     if (!isStruct) {\n         size = union_size;\n     }\n-\n+// FIXME: Crash CWE-369: Divide By Zero\n+ \n     /* Adjust the size according to the alignment requirements */\n-    aligned_size = ((size + total_align - 1) / total_align) * total_align;\n+    if (total_align <= 0) {\n+        aligned_size = size;\n+    } else {\n+        aligned_size = ((size + total_align - 1) / total_align) * total_align;\n+    }\n \n     if (isStruct) {\n         char *ptr;\n@@ -580,8 +585,7 @@ PyCStructUnionType_update_stginfo(PyObject *type, PyObject *fields, int isStruct\n         padding = aligned_size - size;\n         if (padding > 0) {\n             ptr = stginfo->format;\n-            stginfo->format = _ctypes_alloc_format_padding(ptr, padding);\n-            PyMem_Free(ptr);\n+            stginfo->format = _ctypes_alloc_format_padding(ptr, padding);            PyMem_Free(ptr);\n             if (stginfo->format == NULL) {\n                 return -1;\n             }\n", "result": false, "error": "Traceback (most recent call last):\n  File \"/gentest-cpython/py-pr-132673/generated_2.py\", line 50, in <module>\n    test_no_crash_zero_align_no_fields_subprocess()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/gentest-cpython/py-pr-132673/generated_2.py\", line 29, in test_no_crash_zero_align_no_fields_subprocess\n    rc, out, err = assert_python_ok('-c', code)\n                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^\n  File \"/tmp/py-pr-132673/build/Lib/test/support/script_helper.py\", line 180, in assert_python_ok\n    return _assert_python(True, *args, **env_vars)\n  File \"/tmp/py-pr-132673/build/Lib/test/support/script_helper.py\", line 165, in _assert_python\n    res.fail(cmd_line)\n    ~~~~~~~~^^^^^^^^^^\n  File \"/tmp/py-pr-132673/build/Lib/test/support/script_helper.py\", line 75, in fail\n    raise AssertionError(\"Process return code is %d\\n\"\n    ...<13 lines>...\n                            err))\nAssertionError: Process return code is 1\ncommand line: ['/tmp/py-pr-132673/build/python', '-X', 'faulthandler', '-I', '-c', 'if 1:\\n        from ctypes import Structure, LittleEndianStructure, BigEndianStructure, alignment\\n\\n        for base in (Structure, LittleEndianStructure, BigEndianStructure):\\n            class MyStructure(base):\\n                _align_ = 0\\n                _fields_ = []\\n\\n            # Alignment must be 1 and object creation should not crash\\n            assert alignment(MyStructure) == 1, f\"Expected alignment 1 for {base.__name__}, got {alignment(MyStructure)}\"\\n            assert alignment(MyStructure()) == 1, f\"Expected alignment 1 for {base.__name__}(), got {alignment(MyStructure())}\"\\n\\n        print(\\'OK\\')\\n    ']\n\nstdout:\n---\n\n---\n\nstderr:\n---\nTraceback (most recent call last):\n  File \"<string>\", line 10, in <module>\n    assert alignment(MyStructure) == 1, f\"Expected alignment 1 for {base.__name__}, got {alignment(MyStructure)}\"\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAssertionError: Expected alignment 1 for Structure, got 0\n---\n"}