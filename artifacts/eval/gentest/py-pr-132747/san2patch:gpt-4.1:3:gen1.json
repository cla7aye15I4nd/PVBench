{"patch": "diff --git a/Objects/descrobject.c b/Objects/descrobject.c\nindex 268af0b217c..bf7a9d5a734 100644\n--- a/Objects/descrobject.c\n+++ b/Objects/descrobject.c\n@@ -143,6 +143,11 @@ method_get(PyObject *self, PyObject *obj, PyObject *type)\n     }\n     if (descr_check((PyDescrObject *)descr, obj) < 0) {\n         return NULL;\n+// FIXME: Crash CWE-416: Use After Free\n+     }\n+    if (type == NULL) {\n+        PyErr_SetString(PyExc_SystemError, \"method_get: 'type' argument is NULL\");\n+        return NULL;\n     }\n     if (descr->d_method->ml_flags & METH_METHOD) {\n         if (PyType_Check(type)) {\n", "result": false, "error": "Traceback (most recent call last):\n  File \"/gentest-cpython/py-pr-132747/generated_1.py\", line 104, in <module>\n    main()\n    ~~~~^^\n  File \"/gentest-cpython/py-pr-132747/generated_1.py\", line 99, in main\n    test_general_bindings_in_subprocess()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/gentest-cpython/py-pr-132747/generated_1.py\", line 67, in test_general_bindings_in_subprocess\n    rc, out, err = assert_python_ok('-c', code)\n                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^\n  File \"/tmp/py-pr-132747/build/Lib/test/support/script_helper.py\", line 182, in assert_python_ok\n    return _assert_python(True, *args, **env_vars)\n  File \"/tmp/py-pr-132747/build/Lib/test/support/script_helper.py\", line 167, in _assert_python\n    res.fail(cmd_line)\n    ~~~~~~~~^^^^^^^^^^\n  File \"/tmp/py-pr-132747/build/Lib/test/support/script_helper.py\", line 80, in fail\n    raise AssertionError(f\"Process return code is {exitcode}\\n\"\n    ...<10 lines>...\n                         f\"---\")\nAssertionError: Process return code is 1\ncommand line: ['/tmp/py-pr-132747/build/python', '-X', 'faulthandler', '-I', '-c', 'if 1:\\n        # Safe callable examples (do not include the PoC detach here to avoid crash on unfixed builds)\\n        tests = []\\n        tests.append((str.capitalize, \\'spam\\', True, \\'str.capitalize\\'))\\n        lst = []\\n        tests.append((list.append, lst, True, \\'list.append\\'))\\n\\n        # Try to include _queue.SimpleQueue.put if available\\n        try:\\n            import _queue\\n        except Exception:\\n            _queue = None\\n        if _queue is not None and hasattr(_queue, \\'SimpleQueue\\'):\\n            q = _queue.SimpleQueue()\\n            tests.append((_queue.SimpleQueue.put, q, True, \\'_queue.SimpleQueue.put\\'))\\n\\n        for meth, inst, can_call, label in tests:\\n            # Omitted type\\n            b_omitted = meth.__get__(inst)\\n            assert callable(b_omitted), f\"Binding without type should produce callable for {label}\"\\n\\n            # Explicit None\\n            b_none = meth.__get__(inst, None)\\n            assert callable(b_none), f\"Binding with None as type should produce callable for {label}\"\\n\\n            # Explicit class type\\n            b_type = meth.__get__(inst, type(inst))\\n            assert callable(b_type), f\"Binding with type(obj) should produce callable for {label}\"\\n\\n            if can_call:\\n                if meth is str.capitalize:\\n                    r1 = b_omitted()\\n                    r2 = b_none()\\n                    r3 = b_type()\\n                    assert r1 == r2 == r3 == \\'Spam\\', f\"Unexpected capitalize result: {r1!r}, {r2!r}, {r3!r}\"\\n                elif meth is list.append:\\n                    inst.clear()\\n                    b_omitted(1)\\n                    b_none(2)\\n                    b_type(3)\\n                    assert inst == [1, 2, 3], f\"list.append bindings failed, got {inst}\"\\n                else:\\n                    # _queue.SimpleQueue.put\\n                    b_omitted(\\'x\\')\\n                    b_none(\\'y\\')\\n                    b_type(\\'z\\')\\n                    got = [inst.get(), inst.get(), inst.get()]\\n                    assert got == [\\'x\\', \\'y\\', \\'z\\'], f\"SimpleQueue order mismatch: {got}\"\\n\\n        print(\\'OK_GENERAL\\')\\n    ']\n\nstdout:\n---\n\n---\n\nstderr:\n---\nTraceback (most recent call last):\n  File \"<string>\", line 19, in <module>\n    b_omitted = meth.__get__(inst)\nSystemError: method_get: 'type' argument is NULL\n---\n"}