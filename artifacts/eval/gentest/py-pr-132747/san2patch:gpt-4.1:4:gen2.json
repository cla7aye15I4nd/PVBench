{"patch": "diff --git a/Objects/descrobject.c b/Objects/descrobject.c\nindex 268af0b217c..c1cd5e32692 100644\n--- a/Objects/descrobject.c\n+++ b/Objects/descrobject.c\n@@ -141,19 +141,30 @@ method_get(PyObject *self, PyObject *obj, PyObject *type)\n     if (obj == NULL) {\n         return Py_NewRef(descr);\n     }\n-    if (descr_check((PyDescrObject *)descr, obj) < 0) {\n+    if (!descr || !descr->d_method) {\n+        PyErr_SetString(PyExc_TypeError, \"descriptor is invalid or expired\");\n         return NULL;\n     }\n-    if (descr->d_method->ml_flags & METH_METHOD) {\n-        if (PyType_Check(type)) {\n-            return PyCMethod_New(descr->d_method, obj, NULL, descr->d_common.d_type);\n-        } else {\n+    if (descr_check((PyDescrObject *)descr, obj) < 0) {\n+        return NULL;\n+// FIXME: Crash CWE-825: Expired Pointer Dereference\n+     }\n+    if ((descr->d_method->ml_flags & METH_METHOD) != 0) {\n+        if (type == NULL) {\n+            PyErr_Format(PyExc_TypeError,\n+                        \"descriptor '%V' needs a type, got NULL instead\",\n+                        descr_name((PyDescrObject *)descr),\n+                        \"NULL\");\n+            return NULL;\n+        }\n+        if (!PyType_Check(type)) {\n             PyErr_Format(PyExc_TypeError,\n                         \"descriptor '%V' needs a type, not '%s', as arg 2\",\n                         descr_name((PyDescrObject *)descr),\n                         Py_TYPE(type)->tp_name);\n             return NULL;\n         }\n+        return PyCMethod_New(descr->d_method, obj, NULL, descr->d_common.d_type);\n     } else {\n         return PyCFunction_NewEx(descr->d_method, obj, NULL);\n     }\n", "result": true}