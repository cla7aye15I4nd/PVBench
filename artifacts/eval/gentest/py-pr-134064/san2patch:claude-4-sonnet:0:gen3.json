{"patch": "diff --git a/Python/sysmodule.c b/Python/sysmodule.c\nindex dd048205757..c936f16a81f 100644\n--- a/Python/sysmodule.c\n+++ b/Python/sysmodule.c\n@@ -2534,18 +2534,18 @@ sys_remote_exec_impl(PyObject *module, int pid, PyObject *script)\n     if (_PySysRemoteDebug_SendExec(pid, 0, debugger_script_path) < 0) {\n         goto error;\n     }\n-\n-    Py_DECREF(path);\n+    if (path != NULL) {\n+        Py_DECREF(path);\n+    }\n     Py_RETURN_NONE;\n-\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+ \n error:\n-    Py_DECREF(path);\n+    if (path != NULL) {\n+        Py_DECREF(path);\n+    }\n     return NULL;\n-}\n-\n-\n-\n-/*[clinic input]\n+}/*[clinic input]\n sys._dump_tracelets\n \n     outpath: object\n", "result": false, "error": "Traceback (most recent call last):\n  File \"/gentest-cpython/py-pr-134064/generated_3.py\", line 81, in <module>\n    test_invalid_script_types_raise_typeerror_without_crash()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/gentest-cpython/py-pr-134064/generated_3.py\", line 59, in test_invalid_script_types_raise_typeerror_without_crash\n    rc, out, err = assert_python_ok('-c', code)\n                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^\n  File \"/tmp/py-pr-134064/build/Lib/test/support/script_helper.py\", line 182, in assert_python_ok\n    return _assert_python(True, *args, **env_vars)\n  File \"/tmp/py-pr-134064/build/Lib/test/support/script_helper.py\", line 167, in _assert_python\n    res.fail(cmd_line)\n    ~~~~~~~~^^^^^^^^^^\n  File \"/tmp/py-pr-134064/build/Lib/test/support/script_helper.py\", line 80, in fail\n    raise AssertionError(f\"Process return code is {exitcode}\\n\"\n    ...<10 lines>...\n                         f\"---\")\nAssertionError: Process return code is 1\ncommand line: ['/tmp/py-pr-134064/build/python', '-X', 'faulthandler', '-I', '-c', \"if 1:\\n    import sys\\n\\n    class BadPathRaises:\\n        def __fspath__(self):\\n            raise TypeError('fs boom')\\n\\n    class PathReturnsNone:\\n        def __fspath__(self):\\n            return None\\n\\n    cases = [\\n        ('None', None),\\n        ('int', 123),\\n        ('object', object()),\\n        ('BadPathRaises', BadPathRaises()),\\n        ('PathReturnsNone', PathReturnsNone()),\\n    ]\\n\\n    for name, arg in cases:\\n        try:\\n            # pid value is irrelevant here; we are probing argument conversion of script.\\n            sys.remote_exec(0, arg)\\n            print('NOEXC', name)\\n        except TypeError as e:\\n            # Expected after the fix: TypeError should be raised for all invalid types.\\n            print('TYPEERROR', name, str(e))\\n        except BaseException as e:\\n            # Any other exception type indicates unexpected behavior.\\n            print('OTHER', name, type(e).__name__, str(e))\\n    \"]\n\nstdout:\n---\n\n---\n\nstderr:\n---\n=================================================================\n==2237814==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x504000000000 at pc 0x5647054f82c9 bp 0x7fff33b717d0 sp 0x7fff33b717c8\nREAD of size 4 at 0x504000000000 thread T0\n    #0 0x5647054f82c8 in _Py_IsImmortal /tmp/py-pr-134064/build/./Include/refcount.h:129:12\n    #1 0x5647054f82c8 in Py_DECREF /tmp/py-pr-134064/build/./Include/refcount.h:427:9\n    #2 0x5647054f82c8 in sys_remote_exec_impl /tmp/py-pr-134064/build/./Python/sysmodule.c:2545:9\n    #3 0x5647054f4270 in sys_remote_exec /tmp/py-pr-134064/build/./Python/clinic/sysmodule.c.h:1614:20\n    #4 0x5647052beaf5 in _PyEval_EvalFrameDefault /tmp/py-pr-134064/build/Python/generated_cases.c.h:2383:35\n    #5 0x5647052b3731 in _PyEval_EvalFrame /tmp/py-pr-134064/build/./Include/internal/pycore_ceval.h:119:16\n    #6 0x5647052b35bc in _PyEval_Vector /tmp/py-pr-134064/build/Python/ceval.c:1964:12\n    #7 0x5647052b2e9a in PyEval_EvalCode /tmp/py-pr-134064/build/Python/ceval.c:856:21\n    #8 0x56470549f756 in run_eval_code_obj /tmp/py-pr-134064/build/Python/pythonrun.c:1365:12\n    #9 0x56470549f497 in run_mod /tmp/py-pr-134064/build/Python/pythonrun.c:1436:19\n    #10 0x56470549adf6 in _PyRun_StringFlagsWithName /tmp/py-pr-134064/build/Python/pythonrun.c:1259:15\n    #11 0x56470549a99e in _PyRun_SimpleStringFlagsWithName /tmp/py-pr-134064/build/Python/pythonrun.c:578:15\n    #12 0x56470553cc2e in pymain_run_command /tmp/py-pr-134064/build/Modules/main.c:261:11\n    #13 0x56470553b512 in pymain_run_python /tmp/py-pr-134064/build/Modules/main.c:677:21\n    #14 0x56470553aa12 in Py_RunMain /tmp/py-pr-134064/build/Modules/main.c:767:5\n    #15 0x56470553bb48 in pymain_main /tmp/py-pr-134064/build/Modules/main.c:797:12\n    #16 0x56470553bc57 in Py_BytesMain /tmp/py-pr-134064/build/Modules/main.c:821:12\n    #17 0x564704ceb511 in main /tmp/py-pr-134064/build/./Programs/python.c:15:12\n    #18 0x7f825cd181"}