{"patch": "diff --git a/Python/sysmodule.c b/Python/sysmodule.c\nindex dd048205757..4bf4f8546d4 100644\n--- a/Python/sysmodule.c\n+++ b/Python/sysmodule.c\n@@ -2534,17 +2534,22 @@ sys_remote_exec_impl(PyObject *module, int pid, PyObject *script)\n     if (_PySysRemoteDebug_SendExec(pid, 0, debugger_script_path) < 0) {\n         goto error;\n     }\n-\n-    Py_DECREF(path);\n+    if (path != NULL) {\n+        Py_DECREF(path);\n+        path = NULL;\n+    }\n     Py_RETURN_NONE;\n-\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+ \n error:\n-    Py_DECREF(path);\n+    if (path != NULL) {\n+        Py_DECREF(path);\n+        path = NULL;\n+    }\n     return NULL;\n }\n \n \n-\n /*[clinic input]\n sys._dump_tracelets\n \n", "result": false, "error": "Traceback (most recent call last):\n  File \"/gentest-cpython/py-pr-134064/generated_3.py\", line 81, in <module>\n    test_invalid_script_types_raise_typeerror_without_crash()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/gentest-cpython/py-pr-134064/generated_3.py\", line 59, in test_invalid_script_types_raise_typeerror_without_crash\n    rc, out, err = assert_python_ok('-c', code)\n                   ~~~~~~~~~~~~~~~~^^^^^^^^^^^^\n  File \"/tmp/py-pr-134064/build/Lib/test/support/script_helper.py\", line 182, in assert_python_ok\n    return _assert_python(True, *args, **env_vars)\n  File \"/tmp/py-pr-134064/build/Lib/test/support/script_helper.py\", line 167, in _assert_python\n    res.fail(cmd_line)\n    ~~~~~~~~^^^^^^^^^^\n  File \"/tmp/py-pr-134064/build/Lib/test/support/script_helper.py\", line 80, in fail\n    raise AssertionError(f\"Process return code is {exitcode}\\n\"\n    ...<10 lines>...\n                         f\"---\")\nAssertionError: Process return code is 1\ncommand line: ['/tmp/py-pr-134064/build/python', '-X', 'faulthandler', '-I', '-c', \"if 1:\\n    import sys\\n\\n    class BadPathRaises:\\n        def __fspath__(self):\\n            raise TypeError('fs boom')\\n\\n    class PathReturnsNone:\\n        def __fspath__(self):\\n            return None\\n\\n    cases = [\\n        ('None', None),\\n        ('int', 123),\\n        ('object', object()),\\n        ('BadPathRaises', BadPathRaises()),\\n        ('PathReturnsNone', PathReturnsNone()),\\n    ]\\n\\n    for name, arg in cases:\\n        try:\\n            # pid value is irrelevant here; we are probing argument conversion of script.\\n            sys.remote_exec(0, arg)\\n            print('NOEXC', name)\\n        except TypeError as e:\\n            # Expected after the fix: TypeError should be raised for all invalid types.\\n            print('TYPEERROR', name, str(e))\\n        except BaseException as e:\\n            # Any other exception type indicates unexpected behavior.\\n            print('OTHER', name, type(e).__name__, str(e))\\n    \"]\n\nstdout:\n---\n\n---\n\nstderr:\n---\nFatal Python error: Segmentation fault\n\nCurrent thread 0x00007fc40379c300 [python] (most recent call first):\n  File \"<string>\", line 23 in <module>\n\nCurrent thread's C stack trace (most recent call first):\n  Binary file \"/tmp/py-pr-134064/build/python\", at ___interceptor_backtrace+0x4a [0x55e9677eba1a]\n  Binary file \"/tmp/py-pr-134064/build/python\", at _Py_DumpStack+0x15f [0x55e9680994ff]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0xae0d1a [0x55e9680ded1a]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0xae08f1 [0x55e9680de8f1]\n  Binary file \"/lib/x86_64-linux-gnu/libc.so.6\", at +0x45330 [0x7fc4037e2330]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0xa8f29e [0x55e96808d29e]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0xa8b271 [0x55e968089271]\n  Binary file \"/tmp/py-pr-134064/build/python\", at _PyEval_EvalFrameDefault+0xaf46 [0x55e967e53af6]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0x84a732 [0x55e967e48732]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0x84a5bd [0x55e967e485bd]\n  Binary file \"/tmp/py-pr-134064/build/python\", at PyEval_EvalCode+0x4db [0x55e967e47e9b]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0xa36757 [0x55e968034757]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0xa36498 [0x55e968034498]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0xa31df7 [0x55e96802fdf7]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0xa3199f [0x55e96802f99f]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0xad3c2f [0x55e9680d1c2f]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0xad2513 [0x55e9680d0513]\n  Binary file \"/tmp/py-pr-134064/build/python\", at Py_RunMain+0x133 [0x55e9680cfa13]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0xad2b49 [0x55e9680d0b49]\n  Binary file \"/tmp/py-pr-134064/build/python\", at Py_BytesMain+0xf8 [0x55e9680d0c58]\n  Binary file \"/tmp/py-pr-134064/build/python\", at +0x282512 [0x55e967880512]\n  Binary file \"/lib/"}