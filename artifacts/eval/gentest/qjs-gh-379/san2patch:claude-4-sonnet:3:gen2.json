{"patch": "diff --git a/quickjs.c b/quickjs.c\nindex 46e124a..c0c18d6 100644\n--- a/quickjs.c\n+++ b/quickjs.c\n@@ -50325,11 +50325,27 @@ static JSValue js_typed_array_slice(JSContext *ctx, JSValue this_val,\n \n         p1 = get_typed_array(ctx, arr, 0);\n         if (p1 != NULL && p->class_id == p1->class_id &&\n-            typed_array_get_length(ctx, p1) >= count &&\n+// FIXME: Crash CWE-119: Buffer Overflow\n+             typed_array_get_length(ctx, p1) >= count &&\n             typed_array_get_length(ctx, p) >= start + count) {\n-            memcpy(p1->u.array.u.uint8_ptr,\n-                   p->u.array.u.uint8_ptr + (start << shift),\n-                   count << shift);\n+            uint8_t *src = p->u.array.u.uint8_ptr + (start << shift);\n+            uint8_t *dest = p1->u.array.u.uint8_ptr;\n+            size_t size = count << shift;\n+            \n+            // Check for memory overlap to prevent buffer overflow\n+            if (dest < src + size && src < dest + size) {\n+                // Use element-by-element copy for overlapping regions\n+                for (n = 0; n < count; n++) {\n+                    val = JS_GetPropertyValue(ctx, this_val, js_int32(start + n));\n+                    if (JS_IsException(val))\n+                        goto exception;\n+                    if (JS_SetPropertyValue(ctx, arr, js_int32(n), val,\n+                                            JS_PROP_THROW) < 0)\n+                        goto exception;\n+                }\n+            } else {\n+                memcpy(dest, src, size);\n+            }\n         } else {\n             for (n = 0; n < count; n++) {\n                 val = JS_GetPropertyValue(ctx, this_val, js_int32(start + n));\n", "result": false, "error": "Error: Destination data mismatch. Expected=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16], got=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]\n    at assert (/gentest-quickjs/qjs-gh-379/generated_2.js:9:36)\n    at testOverlap (/gentest-quickjs/qjs-gh-379/generated_2.js:112:23)\n    at testForwardOverlapUint8 (/gentest-quickjs/qjs-gh-379/generated_2.js:126:5)\n    at <eval> (/gentest-quickjs/qjs-gh-379/generated_2.js:127:1)\n\n"}