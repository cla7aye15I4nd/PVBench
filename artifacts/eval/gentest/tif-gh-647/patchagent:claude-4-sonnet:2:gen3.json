{"patch": "diff --git a/libtiff/tif_dir.c b/libtiff/tif_dir.c\nindex 459f9696..b53e2fc5 100644\n--- a/libtiff/tif_dir.c\n+++ b/libtiff/tif_dir.c\n@@ -1204,6 +1204,9 @@ int TIFFUnsetField(TIFF *tif, uint32_t tag)\n  */\n int TIFFVSetField(TIFF *tif, uint32_t tag, va_list ap)\n {\n+    if (tif == NULL || tif->tif_tagmethods.vsetfield == NULL)\n+        return 0;\n+        \n     return OkToChangeTag(tif, tag)\n                ? (*tif->tif_tagmethods.vsetfield)(tif, tag, ap)\n                : 0;\n", "result": true}