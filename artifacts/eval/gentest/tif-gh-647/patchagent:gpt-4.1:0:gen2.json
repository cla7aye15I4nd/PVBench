{"patch": "diff --git a/libtiff/tif_dir.c b/libtiff/tif_dir.c\nindex 459f9696..464559b2 100644\n--- a/libtiff/tif_dir.c\n+++ b/libtiff/tif_dir.c\n@@ -1145,6 +1145,9 @@ static int OkToChangeTag(TIFF *tif, uint32_t tag)\n  */\n int TIFFSetField(TIFF *tif, uint32_t tag, ...)\n {\n+    if (tif == NULL) {\n+        return 0;\n+    }\n     va_list ap;\n     int status;\n \n@@ -1204,6 +1207,9 @@ int TIFFUnsetField(TIFF *tif, uint32_t tag)\n  */\n int TIFFVSetField(TIFF *tif, uint32_t tag, va_list ap)\n {\n+    if (tif == NULL || tif->tif_tagmethods.vsetfield == NULL) {\n+        return 0;\n+    }\n     return OkToChangeTag(tif, tag)\n                ? (*tif->tif_tagmethods.vsetfield)(tif, tag, ap)\n                : 0;\n", "result": true}