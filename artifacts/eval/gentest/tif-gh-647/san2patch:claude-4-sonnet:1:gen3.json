{"patch": "diff --git a/libtiff/tif_dirread.c b/libtiff/tif_dirread.c\nindex b360deae..6dab1466 100644\n--- a/libtiff/tif_dirread.c\n+++ b/libtiff/tif_dirread.c\n@@ -6537,12 +6537,19 @@ static int TIFFFetchNormalTag(TIFF *tif, TIFFDirEntry *dp, int recover)\n                 {\n                     if (!EvaluateIFDdatasizeReading(tif, dp))\n                     {\n-                        if (data != 0)\n+                         if (data != 0)\n                             _TIFFfreeExt(tif, data);\n                         return 0;\n                     }\n                     int m;\n-                    m = TIFFSetField(tif, dp->tdir_tag, data);\n+                    if (tif != NULL && tif->tif_tagmethods.vsetfield != NULL)\n+                    {\n+                        m = TIFFSetField(tif, dp->tdir_tag, data);\n+                    }\n+                    else\n+                    {\n+                        m = 0;\n+                    }\n                     if (data != 0)\n                         _TIFFfreeExt(tif, data);\n                     if (!m)\n", "result": true}