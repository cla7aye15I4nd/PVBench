{"patch": "diff --git a/libtiff/tif_dirread.c b/libtiff/tif_dirread.c\nindex b360deae..93ad15e2 100644\n--- a/libtiff/tif_dirread.c\n+++ b/libtiff/tif_dirread.c\n@@ -6536,13 +6536,22 @@ static int TIFFFetchNormalTag(TIFF *tif, TIFFDirEntry *dp, int recover)\n                 if (err == TIFFReadDirEntryErrOk)\n                 {\n                     if (!EvaluateIFDdatasizeReading(tif, dp))\n-                    {\n+                     {\n                         if (data != 0)\n                             _TIFFfreeExt(tif, data);\n                         return 0;\n                     }\n                     int m;\n-                    m = TIFFSetField(tif, dp->tdir_tag, data);\n+                    // Check if TIFFSetField function pointer is valid before calling\n+                    if (tif->tif_tagmethods.vsetfield != NULL)\n+                    {\n+                        m = TIFFSetField(tif, dp->tdir_tag, data);\n+                    }\n+                    else\n+                    {\n+                        TIFFWarningExtR(tif, module, \"TIFFSetField function pointer is NULL for tag %d\", dp->tdir_tag);\n+                        m = 0;\n+                    }\n                     if (data != 0)\n                         _TIFFfreeExt(tif, data);\n                     if (!m)\n", "result": true}