{"patch": "--- a/src/objects/js-date-time-format.cc\n+++ b/src/objects/js-date-time-format.cc\n@@ -1655,53 +1655,65 @@\n   int32_t len = flat.length();\n   if (len < 3) {\n     // Error\n     return std::nullopt;\n   }\n   std::string tz(\"GMT\");\n   switch (flat.Get(0)) {\n     case 0x2212:\n     case '-':\n       tz += '-';\n       break;\n     case '+':\n       tz += '+';\n       break;\n     default:\n       // Error\n       return std::nullopt;\n   }\n   // 00 - 23\n   uint16_t h0 = flat.Get(1);\n   uint16_t h1 = flat.Get(2);\n \n   if ((h0 >= '0' && h0 <= '1' && h1 >= '0' && h1 <= '9') ||\n       (h0 == '2' && h1 >= '0' && h1 <= '3')) {\n     tz += h0;\n     tz += h1;\n   } else {\n     // Error\n     return std::nullopt;\n   }\n-  if (len == 3) {\n-    return tz;\n-  }\n-  int32_t p = 3;\n-  uint16_t m0 = flat.Get(p);\n-  if (m0 == ':') {\n-    // Ignore ':'\n-    p++;\n-    m0 = flat.Get(p);\n-  }\n-  if (len - p != 2) {\n-    // Error\n-    return std::nullopt;\n-  }\n-  uint16_t m1 = flat.Get(p + 1);\n-  if (m0 >= '0' && m0 <= '5' && m1 >= '0' && m1 <= '9') {\n-    tz += m0;\n-    tz += m1;\n-    return tz;\n-  }\n-  // Error\n-  return std::nullopt;\n+  if (len == 3) {\n+    return tz;\n+  }\n+  int32_t p = 3;\n+  if (len <= p) {\n+    // Error: not enough length for minutes\n+    return std::nullopt;\n+  }\n+  uint16_t m0 = flat.Get(p);\n+  if (m0 == ':') {\n+    // Ignore ':'\n+    p++;\n+    if (len <= p) {\n+      // Error: not enough length for minutes after colon\n+      return std::nullopt;\n+    }\n+    m0 = flat.Get(p);\n+  }\n+  if (len - p != 2) {\n+    // Error\n+    return std::nullopt;\n+  }\n+  if (len <= p + 1) {\n+    // Error: not enough length for minute second digit\n+    return std::nullopt;\n+  }\n+  uint16_t m1 = flat.Get(p + 1);\n+  if (m0 >= '0' && m0 <= '5' && m1 >= '0' && m1 <= '9') {\n+    tz += m0;\n+    tz += m1;\n+    return tz;\n+  }\n+  // Error\n+  return std::nullopt;\n }\n", "result": true}