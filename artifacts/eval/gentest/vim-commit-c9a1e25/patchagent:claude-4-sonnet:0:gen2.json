{"patch": "diff --git a/src/misc1.c b/src/misc1.c\nindex 90cf91474..c5a49d0ae 100644\n--- a/src/misc1.c\n+++ b/src/misc1.c\n@@ -547,6 +547,9 @@ gchar_pos(pos_T *pos)\n     // When searching columns is sometimes put at the end of a line.\n     if (pos->col == MAXCOL)\n \treturn NUL;\n+    // Check if position is beyond line length to prevent buffer overflow\n+    if (pos->col >= ml_get_buf_len(curbuf, pos->lnum))\n+\treturn NUL;\n     ptr = ml_get_pos(pos);\n     if (has_mbyte)\n \treturn (*mb_ptr2char)(ptr);\ndiff --git a/src/register.c b/src/register.c\nindex 3ca425b45..dbdb5fc69 100644\n--- a/src/register.c\n+++ b/src/register.c\n@@ -1268,8 +1268,11 @@ op_yank(oparg_T *oap, int deleting, int mess)\n \n \t\t    charwise_block_prep(oap->start, oap->end, &bd, lnum, oap->inclusive);\n \n-\t\t    // make sure bd.textlen is not longer than the text\n-\t\t    tmp = (int)STRLEN(bd.textstart);\n+\t    // make sure bd.textlen is not longer than the text\n+\t    // Calculate the maximum available length from textstart to end of line\n+\t    // to prevent reading beyond allocated buffer\n+\t    colnr_T line_len = ml_get_len(lnum);\n+\t    tmp = (bd.textcol < line_len) ? (int)(line_len - bd.textcol) : 0;\n \t\t    if (tmp < bd.textlen)\n \t\t\tbd.textlen = tmp;\n \n", "result": true}