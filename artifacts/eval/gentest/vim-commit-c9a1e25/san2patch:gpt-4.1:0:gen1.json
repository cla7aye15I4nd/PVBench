{"patch": "diff --git a/src/ops.c b/src/ops.c\nindex a75efab59..2f84c377c 100644\n--- a/src/ops.c\n+++ b/src/ops.c\n@@ -1014,43 +1014,45 @@ op_delete(oparg_T *oap)\n     else\n     {\n \tif (virtual_op)\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n \t{\n-\t    int\t\tendcol = 0;\n+    int\tendcol = 0;\n \n-\t    // For virtualedit: break the tabs that are partly included.\n-\t    if (gchar_pos(&oap->start) == '\\t')\n-\t    {\n-\t\tif (u_save_cursor() == FAIL)\t// save first line for undo\n-\t\t    return FAIL;\n-\t\tif (oap->line_count == 1)\n-\t\t    endcol = getviscol2(oap->end.col, oap->end.coladd);\n-\t\tcoladvance_force(getviscol2(oap->start.col, oap->start.coladd));\n-\t\toap->start = curwin->w_cursor;\n-\t\tif (oap->line_count == 1)\n-\t\t{\n-\t\t    coladvance(endcol);\n-\t\t    oap->end.col = curwin->w_cursor.col;\n-\t\t    oap->end.coladd = curwin->w_cursor.coladd;\n-\t\t    curwin->w_cursor = oap->start;\n-\t\t}\n-\t    }\n+    // For virtualedit: break the tabs that are partly included.\n+    if (gchar_pos(&oap->start) == '\\t')\n+    {\n+        if (u_save_cursor() == FAIL)\t// save first line for undo\n+            return FAIL;\n+        if (oap->line_count == 1)\n+            endcol = getviscol2(oap->end.col, oap->end.coladd);\n+        coladvance_force(getviscol2(oap->start.col, oap->start.coladd));\n+        oap->start = curwin->w_cursor;\n+        if (oap->line_count == 1)\n+        {\n+            coladvance(endcol);\n+            oap->end.col = curwin->w_cursor.col;\n+            oap->end.coladd = curwin->w_cursor.coladd;\n+            curwin->w_cursor = oap->start;\n+        }\n+    }\n \n-\t    // Break a tab only when it's included in the area.\n-\t    if (gchar_pos(&oap->end) == '\\t'\n-\t\t\t\t     && (int)oap->end.coladd < oap->inclusive)\n-\t    {\n-\t\t// save last line for undo\n-\t\tif (u_save((linenr_T)(oap->end.lnum - 1),\n-\t\t\t\t       (linenr_T)(oap->end.lnum + 1)) == FAIL)\n-\t\t    return FAIL;\n-\t\tcurwin->w_cursor = oap->end;\n-\t\tcoladvance_force(getviscol2(oap->end.col, oap->end.coladd));\n-\t\toap->end = curwin->w_cursor;\n-\t\tcurwin->w_cursor = oap->start;\n-\t    }\n-\t    if (has_mbyte)\n-\t\tmb_adjust_opend(oap);\n-\t}\n+    // Break a tab only when it's included in the area.\n+    if (gchar_pos(&oap->end) == '\\t'\n+                     && (int)oap->end.coladd < oap->inclusive)\n+    {\n+        // save last line for undo\n+        if (u_save((linenr_T)(oap->end.lnum - 1),\n+                       (linenr_T)(oap->end.lnum + 1)) == FAIL)\n+            return FAIL;\n+        curwin->w_cursor = oap->end;\n+        coladvance_force(getviscol2(oap->end.col, oap->end.coladd));\n+        oap->end = curwin->w_cursor;\n+        curwin->w_cursor = oap->start;\n+    }\n+    if (has_mbyte)\n+        mb_adjust_opend(oap);\n+    // Defensive bounds: avoid using strlen, always pass buffer size to strnlen.\n+}\n \n \tif (oap->line_count == 1)\t// delete characters within one line\n \t{\n", "result": false, "error": "=================================================================\n==213755==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x52100001a105 at pc 0x5636a446a30f bp 0x7ffeadbae990 sp 0x7ffeadbae158\nREAD of size 1 at 0x52100001a105 thread T0\n    #0 0x5636a446a30e in strlen (/tmp/vim-commit-c9a1e25/build/src/vim+0x17330e) (BuildId: ccba2ed655feb98e5f3a23b3c5b088eae51dcc07)\n    #1 0x5636a4ad3cf8 in op_yank /tmp/vim-commit-c9a1e25/build/src/register.c:1272:18\n    #2 0x5636a495cfa7 in op_delete /tmp/vim-commit-c9a1e25/build/src/ops.c:879:10\n    #3 0x5636a497b2f5 in do_pending_operator /tmp/vim-commit-c9a1e25/build/src/ops.c:4336:9\n    #4 0x5636a4952474 in nv_put_opt /tmp/vim-commit-c9a1e25/build/src/normal.c:7430:2\n    #5 0x5636a4942a5c in nv_brackets /tmp/vim-commit-c9a1e25/build/src/normal.c:4516:2\n    #6 0x5636a491f6a7 in normal_cmd /tmp/vim-commit-c9a1e25/build/src/normal.c:952:5\n    #7 0x5636a4739e63 in exec_normal /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:9351:6\n    #8 0x5636a4739b03 in exec_normal_cmd /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:9314:5\n    #9 0x5636a4739869 in ex_normal /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:9232:6\n    #10 0x5636a4716271 in do_one_cmd /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:2621:2\n    #11 0x5636a470e86d in do_cmdline /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:1033:17\n    #12 0x5636a4b078c7 in do_source_ext /tmp/vim-commit-c9a1e25/build/src/scriptfile.c:1889:5\n    #13 0x5636a4b05820 in do_source /tmp/vim-commit-c9a1e25/build/src/scriptfile.c:2035:12\n    #14 0x5636a4b053bf in cmd_source /tmp/vim-commit-c9a1e25/build/src/scriptfile.c:1381:14\n    #15 0x5636a4b04ebd in ex_source /tmp/vim-commit-c9a1e25/build/src/scriptfile.c:1407:2\n    #16 0x5636a4716271 in do_one_cmd /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:2621:2\n    #17 0x5636a470e86d in do_cmdline /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:1033:17\n    #18 0x5636a4710dd0 in do_cmdline_cmd /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:627:12\n    #19 0x5636a4ece170 in exe_commands /tmp/vim-commit-c9a1e25/build/src/main.c:3177:2\n    #20 0x5636a4ecbf1a in vim_main2 /tmp/vim-commit-c9a1e25/build/src/main.c:790:2\n    #21 0x5636a4ec6817 in main /tmp/vim-commit-c9a1e25/build/src/main.c:441:12\n    #22 0x7f190b3691c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 274eec488d230825a136fa9c4d85370fed7a0a5e)\n    #23 0x7f190b36928a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 274eec488d230825a136fa9c4d85370fed7a0a5e)\n    #24 0x5636a4452a84 in _start (/tmp/vim-commit-c9a1e25/build/src/vim+0x15ba84) (BuildId: ccba2ed655feb98e5f3a23b3c5b088eae51dcc07)\n\n0x52100001a105 is located 5 bytes after 4096-byte region [0x521000019100,0x52100001a100)\nallocated by thread T0 here:\n    #0 0x5636a44ed8d3 in malloc (/tmp/vim-commit-c9a1e25/build/src/vim+0x1f68d3) (BuildId: ccba2ed655feb98e5f3a23b3c5b088eae51dcc07)\n    #1 0x5636a452c236 in lalloc /tmp/vim-commit-c9a1e25/build/src/alloc.c:246:11\n    #2 0x5636a452c199 in alloc /tmp/vim-commit-c9a1e25/build/src/alloc.c:151:12\n    #3 0x5636a4ed3742 in mf_alloc_bhdr /tmp/vim-commit-c9a1e25/build/src/memfile.c:887:24\n    #4 0x5636a4ed2aca in mf_new /tmp/vim-commit-c9a1e25/build/src/memfile.c:375:26\n    #5 0x5636a48a33c3 in ml_new_data /tmp/vim-commit-c9a1e25/build/src/memline.c:4258:15\n    #6 0x5636a48a22c8 in ml_open /tmp/vim-commit-c9a1e25/build/src/memline.c:399:15\n    #7 0x5636a454f6d0 in open_buffer /tmp/vim-commit-c9a1e25/build/src/buffer.c:193:9\n    #8 0x5636a46f696c in do_ecmd /tmp/vim-commit-c9a1e25/build/src/ex_cmds.c:3110:23\n    #9 0x5636a4532fe4 in do_argfile /tmp/vim-commit-c9a1e25/build/src/arglist.c:750:9\n    #10 0x5636a4532026 in ex_next /tmp/vim-commit-c9a1e25/build/src/arglist.c:784:2\n    #11 0x5636a45310f2 in ex_args /tmp/vim-commit-c9a1e25/build/src/arglist.c:588:2\n    #12 0x5636a4716271 in do_one_cmd /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:2621:2\n    #13 0x5636a470e86d in do_cmdline /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:1033:17\n    #14 0x56"}