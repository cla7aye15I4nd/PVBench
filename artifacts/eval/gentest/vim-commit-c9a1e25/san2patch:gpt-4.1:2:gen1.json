{"patch": "diff --git a/src/ops.c b/src/ops.c\nindex a75efab59..81e6ad219 100644\n--- a/src/ops.c\n+++ b/src/ops.c\n@@ -4484,35 +4484,36 @@ do_pending_operator(cmdarg_T *cap, int old_col, int gui_yank)\n \t\tCancelRedo();\n \t    }\n \t    else\n-\t    {\n-\t\t// This is a new edit command, not a restart.  Need to\n-\t\t// remember it to make 'insertmode' work with mappings for\n-\t\t// Visual mode.  But do this only once.\n-\t\trestart_edit_save = restart_edit;\n-\t\trestart_edit = 0;\n+    {\n+\t// This is a new edit command, not a restart.  Need to\n+\t// remember it to make 'insertmode' work with mappings for\n+\t// Visual mode.  But do this only once.\n+\trestart_edit_save = restart_edit;\n+\trestart_edit = 0;\n #ifdef FEAT_LINEBREAK\n-\t\t// Restore linebreak, so that when the user edits it looks as\n-\t\t// before.\n-\t\trestore_lbr(lbr_saved);\n+\t// Restore linebreak, so that when the user edits it looks as\n+\t// before.\n+\trestore_lbr(lbr_saved);\n #endif\n-\t\t// trigger TextChangedI\n-\t\tcurbuf->b_last_changedtick_i = CHANGEDTICK(curbuf);\n+\t// FIXED CWE-125: Ensure buffer is null-terminated before triggering TextChangedI\n+\t// trigger TextChangedI\n+\tcurbuf->b_last_changedtick_i = CHANGEDTICK(curbuf); /* Assumes CHANGEDTICK is safe, if not, buffer must be validated before use */\n \n-\t\top_insert(oap, cap->count1);\n+\top_insert(oap, cap->count1);\n #ifdef FEAT_LINEBREAK\n-\t\t// Reset linebreak, so that formatting works correctly.\n-\t\t(void)reset_lbr();\n+\t// Reset linebreak, so that formatting works correctly.\n+\t(void)reset_lbr();\n #endif\n \n-\t\t// TODO: when inserting in several lines, should format all\n-\t\t// the lines.\n-\t\tauto_format(FALSE, TRUE);\n+\t// TODO: when inserting in several lines, should format all\n+\t// the lines.\n+\tauto_format(FALSE, TRUE);\n \n-\t\tif (restart_edit == 0)\n-\t\t    restart_edit = restart_edit_save;\n-\t\telse\n-\t\t    cap->retval |= CA_COMMAND_BUSY;\n-\t    }\n+\tif (restart_edit == 0)\n+\t    restart_edit = restart_edit_save;\n+\telse\n+\t    cap->retval |= CA_COMMAND_BUSY;\n+    }\n \t    break;\n \n \tcase OP_REPLACE:\n", "result": false, "error": "=================================================================\n==242662==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x52100001a105 at pc 0x55dca23a230f bp 0x7ffd06593bf0 sp 0x7ffd065933b8\nREAD of size 1 at 0x52100001a105 thread T0\n    #0 0x55dca23a230e in strlen (/tmp/vim-commit-c9a1e25/build/src/vim+0x17330e) (BuildId: 67350d0b586cc0e9a2553a7e8d430d6d979e4fae)\n    #1 0x55dca2a0bcf8 in op_yank /tmp/vim-commit-c9a1e25/build/src/register.c:1272:18\n    #2 0x55dca2894fa7 in op_delete /tmp/vim-commit-c9a1e25/build/src/ops.c:879:10\n    #3 0x55dca28b32f5 in do_pending_operator /tmp/vim-commit-c9a1e25/build/src/ops.c:4334:9\n    #4 0x55dca288a474 in nv_put_opt /tmp/vim-commit-c9a1e25/build/src/normal.c:7430:2\n    #5 0x55dca287aa5c in nv_brackets /tmp/vim-commit-c9a1e25/build/src/normal.c:4516:2\n    #6 0x55dca28576a7 in normal_cmd /tmp/vim-commit-c9a1e25/build/src/normal.c:952:5\n    #7 0x55dca2671e63 in exec_normal /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:9351:6\n    #8 0x55dca2671b03 in exec_normal_cmd /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:9314:5\n    #9 0x55dca2671869 in ex_normal /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:9232:6\n    #10 0x55dca264e271 in do_one_cmd /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:2621:2\n    #11 0x55dca264686d in do_cmdline /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:1033:17\n    #12 0x55dca2a3f8c7 in do_source_ext /tmp/vim-commit-c9a1e25/build/src/scriptfile.c:1889:5\n    #13 0x55dca2a3d820 in do_source /tmp/vim-commit-c9a1e25/build/src/scriptfile.c:2035:12\n    #14 0x55dca2a3d3bf in cmd_source /tmp/vim-commit-c9a1e25/build/src/scriptfile.c:1381:14\n    #15 0x55dca2a3cebd in ex_source /tmp/vim-commit-c9a1e25/build/src/scriptfile.c:1407:2\n    #16 0x55dca264e271 in do_one_cmd /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:2621:2\n    #17 0x55dca264686d in do_cmdline /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:1033:17\n    #18 0x55dca2648dd0 in do_cmdline_cmd /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:627:12\n    #19 0x55dca2e06170 in exe_commands /tmp/vim-commit-c9a1e25/build/src/main.c:3177:2\n    #20 0x55dca2e03f1a in vim_main2 /tmp/vim-commit-c9a1e25/build/src/main.c:790:2\n    #21 0x55dca2dfe817 in main /tmp/vim-commit-c9a1e25/build/src/main.c:441:12\n    #22 0x7fd6adffa1c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 274eec488d230825a136fa9c4d85370fed7a0a5e)\n    #23 0x7fd6adffa28a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 274eec488d230825a136fa9c4d85370fed7a0a5e)\n    #24 0x55dca238aa84 in _start (/tmp/vim-commit-c9a1e25/build/src/vim+0x15ba84) (BuildId: 67350d0b586cc0e9a2553a7e8d430d6d979e4fae)\n\n0x52100001a105 is located 5 bytes after 4096-byte region [0x521000019100,0x52100001a100)\nallocated by thread T0 here:\n    #0 0x55dca24258d3 in malloc (/tmp/vim-commit-c9a1e25/build/src/vim+0x1f68d3) (BuildId: 67350d0b586cc0e9a2553a7e8d430d6d979e4fae)\n    #1 0x55dca2464236 in lalloc /tmp/vim-commit-c9a1e25/build/src/alloc.c:246:11\n    #2 0x55dca2464199 in alloc /tmp/vim-commit-c9a1e25/build/src/alloc.c:151:12\n    #3 0x55dca2e0b742 in mf_alloc_bhdr /tmp/vim-commit-c9a1e25/build/src/memfile.c:887:24\n    #4 0x55dca2e0aaca in mf_new /tmp/vim-commit-c9a1e25/build/src/memfile.c:375:26\n    #5 0x55dca27db3c3 in ml_new_data /tmp/vim-commit-c9a1e25/build/src/memline.c:4258:15\n    #6 0x55dca27da2c8 in ml_open /tmp/vim-commit-c9a1e25/build/src/memline.c:399:15\n    #7 0x55dca24876d0 in open_buffer /tmp/vim-commit-c9a1e25/build/src/buffer.c:193:9\n    #8 0x55dca262e96c in do_ecmd /tmp/vim-commit-c9a1e25/build/src/ex_cmds.c:3110:23\n    #9 0x55dca246afe4 in do_argfile /tmp/vim-commit-c9a1e25/build/src/arglist.c:750:9\n    #10 0x55dca246a026 in ex_next /tmp/vim-commit-c9a1e25/build/src/arglist.c:784:2\n    #11 0x55dca24690f2 in ex_args /tmp/vim-commit-c9a1e25/build/src/arglist.c:588:2\n    #12 0x55dca264e271 in do_one_cmd /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:2621:2\n    #13 0x55dca264686d in do_cmdline /tmp/vim-commit-c9a1e25/build/src/ex_docmd.c:1033:17\n    #14 0x55"}