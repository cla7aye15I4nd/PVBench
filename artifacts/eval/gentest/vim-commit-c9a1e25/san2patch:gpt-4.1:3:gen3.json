{"patch": "diff --git a/src/ops.c b/src/ops.c\nindex a75efab59..11dc3aea6 100644\n--- a/src/ops.c\n+++ b/src/ops.c\n@@ -1015,7 +1015,7 @@ op_delete(oparg_T *oap)\n     {\n \tif (virtual_op)\n \t{\n-\t    int\t\tendcol = 0;\n+\t    int\tendcol = 0;\n \n \t    // For virtualedit: break the tabs that are partly included.\n \t    if (gchar_pos(&oap->start) == '\\t')\n@@ -1024,7 +1024,12 @@ op_delete(oparg_T *oap)\n \t\t    return FAIL;\n \t\tif (oap->line_count == 1)\n \t\t    endcol = getviscol2(oap->end.col, oap->end.coladd);\n-\t\tcoladvance_force(getviscol2(oap->start.col, oap->start.coladd));\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+\t\t// Guard: ensure oap->start.col is valid before accessing\n+\t\tif (oap->start.col < (colnr_T)STRLEN(ml_get(oap->start.lnum)))\n+\t\t    coladvance_force(getviscol2(oap->start.col, oap->start.coladd));\n+\t\telse\n+\t\t    coladvance_force(0); // safe fallback\n \t\toap->start = curwin->w_cursor;\n \t\tif (oap->line_count == 1)\n \t\t{\n@@ -1041,10 +1046,13 @@ op_delete(oparg_T *oap)\n \t    {\n \t\t// save last line for undo\n \t\tif (u_save((linenr_T)(oap->end.lnum - 1),\n-\t\t\t\t       (linenr_T)(oap->end.lnum + 1)) == FAIL)\n+\t\t\t       (linenr_T)(oap->end.lnum + 1)) == FAIL)\n \t\t    return FAIL;\n \t\tcurwin->w_cursor = oap->end;\n-\t\tcoladvance_force(getviscol2(oap->end.col, oap->end.coladd));\n+\t\tif (oap->end.col < (colnr_T)STRLEN(ml_get(oap->end.lnum)))\n+\t\t    coladvance_force(getviscol2(oap->end.col, oap->end.coladd));\n+\t\telse\n+\t\t    coladvance_force(0);\n \t\toap->end = curwin->w_cursor;\n \t\tcurwin->w_cursor = oap->start;\n \t    }\n@@ -1052,6 +1060,7 @@ op_delete(oparg_T *oap)\n \t\tmb_adjust_opend(oap);\n \t}\n \n+\n \tif (oap->line_count == 1)\t// delete characters within one line\n \t{\n \t    if (u_save_cursor() == FAIL)\t// save line for undo\n", "result": false, "error": "Exit code 1"}