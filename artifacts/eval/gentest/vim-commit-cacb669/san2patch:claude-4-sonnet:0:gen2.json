{"patch": "diff --git a/src/normal.c b/src/normal.c\nindex a929dd808..be2c60c18 100644\n--- a/src/normal.c\n+++ b/src/normal.c\n@@ -4200,18 +4200,28 @@ normal_search(\n     pos_T\tprev_cursor = curwin->w_cursor;\n #endif\n \n+    // Validate input parameters\n+    if (cap == NULL || cap->oap == NULL || pat == NULL)\n+\treturn 0;\n+\n     cap->oap->motion_type = MCHAR;\n     cap->oap->inclusive = FALSE;\n     cap->oap->use_reg_one = TRUE;\n     curwin->w_set_curswant = TRUE;\n-\n+// FIXME: Crash \n+ \n     CLEAR_FIELD(sia);\n     i = do_search(cap->oap, dir, dir, pat, patlen, cap->count1,\n \t\t\t    opt | SEARCH_OPT | SEARCH_ECHO | SEARCH_MSG, &sia);\n     if (wrapped != NULL)\n \t*wrapped = sia.sa_wrapped;\n     if (i == 0)\n+    {\n \tclearop(cap->oap);\n+\t// Additional cleanup for failed search\n+\tif (sia.sa_stop_lnum != 0)\n+\t    sia.sa_stop_lnum = 0;\n+    }\n     else\n     {\n \tif (i == 2)\n", "result": false, "error": "Exit code 2"}