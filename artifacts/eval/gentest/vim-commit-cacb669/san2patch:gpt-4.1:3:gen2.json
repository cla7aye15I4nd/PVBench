{"patch": "diff --git a/src/normal.c b/src/normal.c\nindex a929dd808..cfb30df76 100644\n--- a/src/normal.c\n+++ b/src/normal.c\n@@ -4191,7 +4191,7 @@ normal_search(\n     int\t\tdir,\n     char_u\t*pat,\n     size_t\tpatlen,\n-    int\t\topt,\t\t// extra flags for do_search()\n+    int\t\topt,\n     int\t\t*wrapped)\n {\n     int\t\ti;\n@@ -4201,13 +4201,21 @@ normal_search(\n #endif\n \n     cap->oap->motion_type = MCHAR;\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+    // Ensure pat is not NULL and patlen is valid before do_search\n+    if (pat == NULL || patlen == 0) {\n+        if (wrapped != NULL)\n+            *wrapped = 0;\n+        clearop(cap->oap);\n+        return 0;\n+    }\n     cap->oap->inclusive = FALSE;\n     cap->oap->use_reg_one = TRUE;\n     curwin->w_set_curswant = TRUE;\n \n     CLEAR_FIELD(sia);\n     i = do_search(cap->oap, dir, dir, pat, patlen, cap->count1,\n-\t\t\t    opt | SEARCH_OPT | SEARCH_ECHO | SEARCH_MSG, &sia);\n+\t\t    opt | SEARCH_OPT | SEARCH_ECHO | SEARCH_MSG, &sia);\n     if (wrapped != NULL)\n \t*wrapped = sia.sa_wrapped;\n     if (i == 0)\n", "result": false, "error": "Exit code 2"}