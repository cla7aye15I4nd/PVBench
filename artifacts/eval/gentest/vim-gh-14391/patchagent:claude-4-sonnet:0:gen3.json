{"patch": "diff --git a/src/change.c b/src/change.c\nindex daf4faed5..6f12f11bf 100644\n--- a/src/change.c\n+++ b/src/change.c\n@@ -1118,7 +1118,12 @@ ins_char_bytes(char_u *buf, int charlen)\n \t}\n     }\n \n-    newp = alloc(linelen + newlen - oldlen);\n+    // Calculate buffer size with safety margin to prevent buffer overflow\n+    int required_size = linelen + newlen - oldlen;\n+    // Ensure minimum size of at least 256 bytes or the calculated size, whichever is larger\n+    if (required_size < 256)\n+\trequired_size = 256;\n+    newp = alloc(required_size);\n     if (newp == NULL)\n \treturn;\n \n", "result": true}