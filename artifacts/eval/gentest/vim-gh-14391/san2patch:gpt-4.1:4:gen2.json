{"patch": "diff --git a/src/change.c b/src/change.c\nindex daf4faed5..f9840af16 100644\n--- a/src/change.c\n+++ b/src/change.c\n@@ -1111,14 +1111,15 @@ ins_char_bytes(char_u *buf, int charlen)\n \treplace_push(NUL);\n \tfor (i = 0; i < oldlen; ++i)\n \t{\n-\t    if (has_mbyte)\n-\t\ti += replace_push_mb(oldp + col + i) - 1;\n-\t    else\n-\t\treplace_push(oldp[col + i]);\n+    if (has_mbyte)\n+\ti += replace_push_mb(oldp + col + i) - 1;\n+    else\n+\treplace_push(oldp[col + i]);\n \t}\n     }\n-\n-    newp = alloc(linelen + newlen - oldlen);\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+     // Add safety margin of 4 bytes to avoid out-of-bounds read\n+     newp = alloc(linelen + newlen - oldlen + 4);\n     if (newp == NULL)\n \treturn;\n \n", "result": true}