{"patch": "diff --git a/src/xxd/xxd.c b/src/xxd/xxd.c\nindex cf8b4ea6a..2554d89c6 100644\n--- a/src/xxd/xxd.c\n+++ b/src/xxd/xxd.c\n@@ -1098,6 +1098,11 @@ main(int argc, char *argv[])\n           if (hextype == HEX_LITTLEENDIAN)\n             c += 1;\n \n+        /* Bounds check before writing color sequences */\n+        if (c + 5 + 1 + 4 + 1 + 1 >= LLEN) {\n+          /* Not enough space for COLOR_PROLOGUE + char + COLOR_EPILOGUE + char + newline + null */\n+          break;\n+        }\n           COLOR_PROLOGUE\n           begin_coloring_char(l,&c,e,ebcdic);\n #if defined(__MVS__) && __CHARSET_LIB == 0\n", "result": true}