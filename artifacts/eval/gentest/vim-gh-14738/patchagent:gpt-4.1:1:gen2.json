{"patch": "diff --git a/src/xxd/xxd.c b/src/xxd/xxd.c\nindex cf8b4ea6a..3978517ba 100644\n--- a/src/xxd/xxd.c\n+++ b/src/xxd/xxd.c\n@@ -1098,6 +1098,15 @@ main(int argc, char *argv[])\n           if (hextype == HEX_LITTLEENDIAN)\n             c += 1;\n \n+          /* Ensure there is enough space for COLOR_PROLOGUE (5 bytes) */\n+          if (c + 5 >= (int)sizeof(l)) {\n+            if (c < (int)sizeof(l)) l[c] = '\\0';\n+            else l[sizeof(l)-1] = '\\0';\n+            xxdline(fpo, l, autoskip ? nonzero : 1);\n+            nonzero = 0;\n+            p = 0;\n+            c = 0;\n+          }\n           COLOR_PROLOGUE\n           begin_coloring_char(l,&c,e,ebcdic);\n #if defined(__MVS__) && __CHARSET_LIB == 0\n", "result": true}