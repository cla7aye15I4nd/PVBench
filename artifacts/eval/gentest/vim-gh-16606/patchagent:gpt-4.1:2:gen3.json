{"patch": "diff --git a/src/message.c b/src/message.c\nindex 24984123b..dd8de5d0d 100644\n--- a/src/message.c\n+++ b/src/message.c\n@@ -518,9 +518,10 @@ get_emsg_lnum(void)\n \n     // lnum is 0 when executing a command from the command line\n     // argument, we don't want a line number then\n-    if (SOURCING_NAME != NULL\n-\t    && (other_sourcing_name() || SOURCING_LNUM != last_sourcing_lnum)\n-\t    && SOURCING_LNUM != 0)\n+    if (HAVE_SOURCING_INFO\n+           && SOURCING_NAME != NULL\n+           && (other_sourcing_name() || SOURCING_LNUM != last_sourcing_lnum)\n+           && SOURCING_LNUM != 0)\n     {\n \tp = (char_u *)_(\"line %4ld:\");\n \tBuf = alloc(STRLEN(p) + 20);\n@@ -558,17 +559,18 @@ msg_source(int attr)\n     p = get_emsg_lnum();\n     if (p != NULL)\n     {\n-\tmsg_attr((char *)p, HL_ATTR(HLF_N));\n-\tvim_free(p);\n-\tlast_sourcing_lnum = SOURCING_LNUM;  // only once for each line\n+        msg_attr((char *)p, HL_ATTR(HLF_N));\n+        vim_free(p);\n+        if (HAVE_SOURCING_INFO)\n+            last_sourcing_lnum = SOURCING_LNUM;  // only once for each line\n     }\n \n     // remember the last sourcing name printed, also when it's empty\n-    if (SOURCING_NAME == NULL || other_sourcing_name())\n+    if (HAVE_SOURCING_INFO && (SOURCING_NAME == NULL || other_sourcing_name()))\n     {\n-\tVIM_CLEAR(last_sourcing_name);\n-\tif (SOURCING_NAME != NULL)\n-\t    last_sourcing_name = vim_strsave(SOURCING_NAME);\n+        VIM_CLEAR(last_sourcing_name);\n+        if (SOURCING_NAME != NULL)\n+            last_sourcing_name = vim_strsave(SOURCING_NAME);\n     }\n     --no_wait_return;\n \n", "result": true}