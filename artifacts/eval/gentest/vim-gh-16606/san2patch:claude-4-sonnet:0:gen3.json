{"patch": "diff --git a/src/logfile.c b/src/logfile.c\nindex 999acf03f..e9ae8fbf6 100644\n--- a/src/logfile.c\n+++ b/src/logfile.c\n@@ -46,9 +46,14 @@ ch_logfile(char_u *fname, char_u *opt)\n     if (*fname != NUL)\n     {\n \tfile = fopen((char *)fname, mode);\n-\tif (file == NULL)\n+// FIXME: Crash CWE-416: Use After Free\n+ \tif (file == NULL)\n \t{\n-\t    semsg(_(e_cant_open_file_str), fname);\n+\t    // Validate fname pointer and global state before calling semsg\n+\t    if (fname != NULL && !ignore_error_for_testing)\n+\t    {\n+\t\tsemsg(_(e_cant_open_file_str), fname);\n+\t    }\n \t    return;\n \t}\n \tvim_free(log_name);\n", "result": false, "error": "Exit code 2"}