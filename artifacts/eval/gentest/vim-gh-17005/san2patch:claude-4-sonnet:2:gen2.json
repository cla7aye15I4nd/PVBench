{"patch": "diff --git a/src/popupmenu.c b/src/popupmenu.c\nindex 71bb49984..8ad0a3d96 100644\n--- a/src/popupmenu.c\n+++ b/src/popupmenu.c\n@@ -847,9 +847,16 @@ pum_redraw(void)\n \n \t\t\t\tif (last_char != NULL)\n \t\t\t\t{\n-\t\t\t\t    if (used_cells < ellipsis_width)\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+ \t\t\t\t    if (used_cells < ellipsis_width)\n \t\t\t\t    {\n-\t\t\t\t\tMB_PTR_BACK(st, st_end);\n+\t\t\t\t\tchar_u *buffer_start = st;\n+\t\t\t\t\tif (st < st_end)\n+\t\t\t\t\t{\n+\t\t\t\t\t    MB_PTR_BACK(st, st_end);\n+\t\t\t\t\t    if (st < buffer_start)\n+\t\t\t\t\t\tst = buffer_start;\n+\t\t\t\t\t}\n \t\t\t\t\tlast_char = st_end;\n \t\t\t\t\tover_cell = ellipsis_width - used_cells;\n \t\t\t\t    }\n", "result": true}