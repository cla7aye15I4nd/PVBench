{"patch": "diff --git a/.gitignore b/.gitignore\nindex 6f76849e2..06ada5b75 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -18,3 +18,13 @@ test/tmp/*\n doc/html\n \n contrib/vms/.vagrant\n+build/\n+Build/\n+bin/\n+lib/\n+*.out\n+*.obj\n+*.exe\n+*.dll\n+*.so\n+*.dylib\ndiff --git a/src/crwimage_int.cpp b/src/crwimage_int.cpp\nindex c2fd5f3a5..a00f35573 100644\n--- a/src/crwimage_int.cpp\n+++ b/src/crwimage_int.cpp\n@@ -235,15 +235,19 @@ namespace Exiv2 {\n                                ByteOrder   byteOrder)\n     {\n         if (size < 10) throw Error(kerNotACrwImage);\n+        if (start > size || start > size - 2) throw Error(kerCorruptedMetadata);\n         tag_ = getUShort(pData + start, byteOrder);\n \n         DataLocId dl = dataLocation();\n         assert(dl == directoryData || dl == valueData);\n \n         if (dl == valueData) {\n+            if (start > size - 6) throw Error(kerCorruptedMetadata);\n             size_   = getULong(pData + start + 2, byteOrder);\n+            if (start > size - 10) throw Error(kerCorruptedMetadata);\n             offset_ = getULong(pData + start + 6, byteOrder);\n         }\n+\n         if ( size_ > size || offset_ > size ) throw Error(kerOffsetOutOfRange); // #889\n         if (dl == directoryData) {\n             size_ = 8;\n@@ -281,7 +285,7 @@ namespace Exiv2 {\n         if (size < 4)\n             throw Error(kerCorruptedMetadata);\n         uint32_t o = getULong(pData + size - 4, byteOrder);\n-        if ( o+2 > size )\n+        if ( o > size || o > size - 2 )\n             throw Error(kerCorruptedMetadata);\n         uint16_t count = getUShort(pData + o, byteOrder);\n #ifdef DEBUG\n@@ -289,7 +293,7 @@ namespace Exiv2 {\n                   <<\", \" << count << \" entries \\n\";\n #endif\n         o += 2;\n-        if ( (o + (count * 10)) > size )\n+        if ( o > size || (count > 0 && count > (size - o) / 10) )\n             throw Error(kerCorruptedMetadata);\n \n         for (uint16_t i = 0; i < count; ++i) {\n", "result": true}