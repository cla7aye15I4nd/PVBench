
diff --git a/.gitignore b/.gitignore
index d3090138a..109566f69 100644
--- a/.gitignore
+++ b/.gitignore
@@ -23,4 +23,13 @@ src/doxygen.hpp
 test/tmp/*
 doc/html
 contrib/vms/.vagrant
-/.vscode
\ No newline at end of file
+/.vscodebuild/
+Build/
+bin/
+lib/
+*.out
+*.obj
+*.exe
+*.dll
+*.so
+*.dylib
diff --git a/xmpsdk/src/XMPUtils.cpp b/xmpsdk/src/XMPUtils.cpp
index 8474b8dd3..ae009b337 100644
--- a/xmpsdk/src/XMPUtils.cpp
+++ b/xmpsdk/src/XMPUtils.cpp
@@ -15,6 +15,7 @@
 
 #include <map>
 #include <limits>
+#include <climits>
 
 #include <time.h>
 #include <string.h>
@@ -1311,6 +1312,10 @@ XMPUtils::ConvertToDate ( XMP_StringPtr	 strValue,
 		if ( (strValue[pos] != 0) && (strValue[pos] != '-') ) XMP_Throw ( "Invalid date string, after year", kXMPErr_BadParam );
 		if ( strValue[0] == '-' ) temp = -temp;
 		binValue->year = temp;
+		// Check for reasonable year range to prevent integer overflow in SetTimeZone
+		if (temp < -999999 || temp > 999999) {
+			XMP_Throw ( "Year value out of reasonable range", kXMPErr_BadParam );
+		}
 		if ( strValue[pos] == 0 ) return;
 
 		++pos;
@@ -1960,6 +1965,13 @@ XMPUtils::SetTimeZone ( XMP_DateTime * xmpTime )
 		if ( now == -1 ) XMP_Throw ( "Failure from ANSI C time function", kXMPErr_ExternalFailure );
 		ansi_localtime ( &now, &tmLocal );
 	} else {
+		// Check for potential integer overflow before subtracting 1900
+		if (xmpTime->year < (std::numeric_limits<int>::min() + 1900)) {
+			XMP_Throw ( "Year value too small, would cause integer overflow", kXMPErr_BadParam );
+		}
+		if (xmpTime->year > (std::numeric_limits<int>::max() - 1900)) {
+			XMP_Throw ( "Year value too large, would cause integer overflow", kXMPErr_BadParam );
+		}
 		tmLocal.tm_year = xmpTime->year - 1900;
 #if 0
 		// Removed to fix https://github.com/Exiv2/exiv2/issues/1901
