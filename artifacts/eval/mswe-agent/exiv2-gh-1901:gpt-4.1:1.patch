
diff --git a/.gitignore b/.gitignore
index d3090138a..109566f69 100644
--- a/.gitignore
+++ b/.gitignore
@@ -23,4 +23,13 @@ src/doxygen.hpp
 test/tmp/*
 doc/html
 contrib/vms/.vagrant
-/.vscode
\ No newline at end of file
+/.vscodebuild/
+Build/
+bin/
+lib/
+*.out
+*.obj
+*.exe
+*.dll
+*.so
+*.dylib
diff --git a/xmpsdk/src/XMPUtils.cpp b/xmpsdk/src/XMPUtils.cpp
index 8474b8dd3..20e082eb7 100644
--- a/xmpsdk/src/XMPUtils.cpp
+++ b/xmpsdk/src/XMPUtils.cpp
@@ -1960,7 +1960,11 @@ XMPUtils::SetTimeZone ( XMP_DateTime * xmpTime )
 		if ( now == -1 ) XMP_Throw ( "Failure from ANSI C time function", kXMPErr_ExternalFailure );
 		ansi_localtime ( &now, &tmLocal );
 	} else {
-		tmLocal.tm_year = xmpTime->year - 1900;
+        // Prevent integer overflow when subtracting 1900 from year
+        if (xmpTime->year < (std::numeric_limits<XMP_Int32>::min() + 1900) || xmpTime->year > (std::numeric_limits<XMP_Int32>::max() - 1900)) {
+            XMP_Throw("Year value out of range in SetTimeZone", kXMPErr_BadParam);
+        }
+        tmLocal.tm_year = xmpTime->year - 1900;
 #if 0
 		// Removed to fix https://github.com/Exiv2/exiv2/issues/1901
 		while ( tmLocal.tm_year < 70 ) tmLocal.tm_year += 4;	// ! Some versions of mktime barf on years before 1970.
