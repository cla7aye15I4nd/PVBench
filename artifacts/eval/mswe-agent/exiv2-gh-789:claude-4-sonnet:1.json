[{"patch": "diff --git a/.gitignore b/.gitignore\nindex 6f76849e2..06ada5b75 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -18,3 +18,13 @@ test/tmp/*\n doc/html\n \n contrib/vms/.vagrant\n+build/\n+Build/\n+bin/\n+lib/\n+*.out\n+*.obj\n+*.exe\n+*.dll\n+*.so\n+*.dylib\ndiff --git a/src/pngimage.cpp b/src/pngimage.cpp\nindex 4ccec39d8..45f6f2743 100644\n--- a/src/pngimage.cpp\n+++ b/src/pngimage.cpp\n@@ -446,6 +446,12 @@ namespace Exiv2 {\n             // Perform a chunk triage for item that we need.\n             if (chunkType == \"IEND\" || chunkType == \"IHDR\" || chunkType == \"tEXt\" || chunkType == \"zTXt\" ||\n                 chunkType == \"iTXt\" || chunkType == \"iCCP\") {\n+                \n+                // Special handling for iCCP chunks - they must have data\n+                if (chunkType == \"iCCP\" && chunkLength == 0) {\n+                    throw Error(kerCorruptedMetadata);\n+                }\n+                \n                 DataBuf chunkData(chunkLength);\n                 readChunk(chunkData, *io_);  // Extract chunk data.\n \n@@ -460,6 +466,7 @@ namespace Exiv2 {\n                 } else if (chunkType == \"iTXt\") {\n                     PngChunk::decodeTXTChunk(this, chunkData, PngChunk::iTXt_Chunk);\n                 } else if (chunkType == \"iCCP\") {\n+                    \n                     // The ICC profile name can vary from 1-79 characters.\n                     uint32_t iccOffset = 0;\n                     while (iccOffset < 80 && iccOffset < chunkLength) {\n@@ -467,7 +474,26 @@ namespace Exiv2 {\n                             break;\n                          }\n                     }\n+                    \n+                    // Check if we found a null terminator within bounds\n+                    // iccOffset will be > 0 if we found a null terminator\n+                    if (iccOffset == 0 || iccOffset > chunkLength) {\n+                        throw Error(kerCorruptedMetadata);\n+                    }\n+                    \n+                    // Ensure we actually found a null terminator (not just reached the limit)\n+                    if (chunkData.pData_[iccOffset-1] != 0x00) {\n+                        throw Error(kerCorruptedMetadata);\n+                    }\n+                    \n+                    // Create profile name safely - iccOffset-1 is now guaranteed to be valid\n                     profileName_ = std::string(reinterpret_cast<char *>(chunkData.pData_), iccOffset-1);\n+                    \n+                    // Check bounds before accessing compression flag\n+                    if (iccOffset >= chunkLength) {\n+                        throw Error(kerCorruptedMetadata);\n+                    }\n+                    \n                     ++iccOffset; // +1 = 'compressed' flag\n                     enforce(iccOffset <= chunkLength, Exiv2::kerCorruptedMetadata);\n \n"}]