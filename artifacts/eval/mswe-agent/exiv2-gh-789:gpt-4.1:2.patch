
diff --git a/.gitignore b/.gitignore
index 6f76849e2..06ada5b75 100644
--- a/.gitignore
+++ b/.gitignore
@@ -18,3 +18,13 @@ test/tmp/*
 doc/html
 
 contrib/vms/.vagrant
+build/
+Build/
+bin/
+lib/
+*.out
+*.obj
+*.exe
+*.dll
+*.so
+*.dylib
diff --git a/src/pngimage.cpp b/src/pngimage.cpp
index 4ccec39d8..20d76e95a 100644
--- a/src/pngimage.cpp
+++ b/src/pngimage.cpp
@@ -467,10 +467,16 @@ namespace Exiv2 {
                             break;
                          }
                     }
+                    if (iccOffset == chunkLength) {
+                        // Null terminator not found, invalid ICC profile chunk
+                        throw Exiv2::Error(Exiv2::kerCorruptedMetadata, "ICC profile name not null-terminated or chunk too short");
+                    }
                     profileName_ = std::string(reinterpret_cast<char *>(chunkData.pData_), iccOffset-1);
                     ++iccOffset; // +1 = 'compressed' flag
+                    if (iccOffset >= chunkLength) {
+                        throw Exiv2::Error(Exiv2::kerCorruptedMetadata, "ICC profile chunk too short for compressed flag or profile data");
+                    }
                     enforce(iccOffset <= chunkLength, Exiv2::kerCorruptedMetadata);
-
                     zlibToDataBuf(chunkData.pData_ + iccOffset, chunkLength - iccOffset, iccProfile_);
 #ifdef DEBUG
                     std::cout << "Exiv2::PngImage::readMetadata: profile name: " << profileName_ << std::endl;
