[{"patch": "diff --git a/.gitignore b/.gitignore\nindex d6b8b714dc..20a5dca7fa 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -45,3 +45,14 @@ src/H5version.h\n /.classpath\n /CMakeUserPresets.json\n HDF5Examples/CMakeUserPresets.json\n+build/\n+Build/\n+bin/\n+lib/\n+*.o\n+*.out\n+*.obj\n+*.exe\n+*.dll\n+*.so\n+*.dylib\ndiff --git a/src/H5F.c b/src/H5F.c\nindex 5dcda18924..49755d4054 100644\n--- a/src/H5F.c\n+++ b/src/H5F.c\n@@ -114,8 +114,9 @@ H5Fget_create_plist(hid_t file_id)\n     H5VL_object_t       *vol_obj;                     /* File for file_id */\n     H5VL_file_get_args_t vol_cb_args;                 /* Arguments to VOL callback */\n     hid_t                ret_value = H5I_INVALID_HID; /* Return value */\n-\n     FUNC_ENTER_API(H5I_INVALID_HID)\n+    if (H5I_FILE != H5I_get_type(file_id))\n+        HGOTO_ERROR(H5E_ARGS, H5E_BADTYPE, H5I_INVALID_HID, \"not a file ID\");\n \n     /* check args */\n     if (NULL == (vol_obj = (H5VL_object_t *)H5I_object(file_id)))\n@@ -163,7 +164,8 @@ H5Fget_access_plist(hid_t file_id)\n \n     FUNC_ENTER_API(H5I_INVALID_HID)\n \n-    /* Check args */\n+    if (H5I_FILE != H5I_get_type(file_id))\n+        HGOTO_ERROR(H5E_ARGS, H5E_BADTYPE, H5I_INVALID_HID, \"not a file ID\");\n     if (NULL == (vol_obj = (H5VL_object_t *)H5I_object(file_id)))\n         HGOTO_ERROR(H5E_ARGS, H5E_BADTYPE, H5I_INVALID_HID, \"invalid file identifier\");\n \n@@ -433,6 +435,8 @@ H5Fget_vfd_handle(hid_t file_id, hid_t fapl_id, void **file_handle /*out*/)\n     herr_t                           ret_value = SUCCEED; /* Return value */\n \n     FUNC_ENTER_API(FAIL)\n+    if (H5I_FILE != H5I_get_type(file_id))\n+        HGOTO_ERROR(H5E_ARGS, H5E_BADTYPE, FAIL, \"not a file ID\");\n \n     /* Check args */\n     if (!file_handle)\n@@ -1548,7 +1552,8 @@ H5Fget_intent(hid_t file_id, unsigned *intent_flags /*out*/)\n     herr_t ret_value = SUCCEED;\n \n     FUNC_ENTER_API(FAIL)\n-\n+    if (H5I_FILE != H5I_get_type(file_id))\n+        HGOTO_ERROR(H5E_ARGS, H5E_BADTYPE, FAIL, \"not a file ID\");\n     /* If no intent flags were passed in, exit quietly */\n     if (intent_flags) {\n         H5VL_object_t       *vol_obj;     /* File for file_id */\n@@ -1585,8 +1590,9 @@ herr_t\n H5Fget_fileno(hid_t file_id, unsigned long *fnumber /*out*/)\n {\n     herr_t ret_value = SUCCEED;\n-\n-    FUNC_ENTER_API(FAIL)\n+    FUNC_ENTER_API(SUCCEED)\n+    if (H5I_FILE != H5I_get_type(file_id))\n+        HGOTO_ERROR(H5E_ARGS, H5E_BADTYPE, FAIL, \"not a file ID\");\n \n     /* If no fnumber pointer was passed in, exit quietly */\n     if (fnumber) {\n@@ -1629,7 +1635,8 @@ H5Fget_freespace(hid_t file_id)\n     hssize_t                         ret_value;          /* Return value */\n \n     FUNC_ENTER_API((-1))\n-\n+    if (H5I_FILE != H5I_get_type(file_id))\n+        HGOTO_ERROR(H5E_ARGS, H5E_BADTYPE, (-1), \"not a file ID\");\n     /* Get the file object */\n     if (NULL == (vol_obj = (H5VL_object_t *)H5I_object(file_id)))\n         HGOTO_ERROR(H5E_ARGS, H5E_BADTYPE, (-1), \"invalid file identifier\");\ndiff --git a/src/H5VLnative_file.c b/src/H5VLnative_file.c\nindex 33a19bfd91..71dd4895a3 100644\n--- a/src/H5VLnative_file.c\n+++ b/src/H5VLnative_file.c\n@@ -177,7 +177,7 @@ H5VL__native_file_get(void *obj, H5VL_file_get_args_t *args, hid_t H5_ATTR_UNUSE\n             H5P_genplist_t *plist; /* Property list */\n \n             f = (H5F_t *)obj;\n-            if (NULL == (plist = (H5P_genplist_t *)H5I_object(f->shared->fcpl_id)))\n+            if (NULL == f || NULL == f->shared || NULL == (plist = (H5P_genplist_t *)H5I_object(f->shared->fcpl_id)))\n                 HGOTO_ERROR(H5E_ARGS, H5E_BADTYPE, FAIL, \"not a property list\");\n \n             /* Create the property list object to return */\n@@ -190,6 +190,8 @@ H5VL__native_file_get(void *obj, H5VL_file_get_args_t *args, hid_t H5_ATTR_UNUSE\n         /* H5Fget_intent */\n         case H5VL_FILE_GET_INTENT: {\n             f = (H5F_t *)obj;\n+            if (NULL == f) \n+                HGOTO_ERROR(H5E_ARGS, H5E_BADTYPE, FAIL, \"not a file object\");\n \n             /* HDF5 uses some flags internally that users don't know about.\n              * Simplify things for them so that they only get either H5F_ACC_RDWR\n@@ -216,13 +218,17 @@ H5VL__native_file_get(void *obj, H5VL_file_get_args_t *args, hid_t H5_ATTR_UNUSE\n         /* H5Fget_fileno */\n         case H5VL_FILE_GET_FILENO: {\n             unsigned long fileno = 0;\n+            f = (H5F_t *)obj;\n+            if (NULL == f)\n+                HGOTO_ERROR(H5E_ARGS, H5E_BADTYPE, FAIL, \"not a file object\");\n \n-            H5F_GET_FILENO((H5F_t *)obj, fileno);\n+            H5F_GET_FILENO(f, fileno);\n             *args->args.get_fileno.fileno = fileno;\n \n             break;\n         }\n \n+\n         /* H5Fget_name */\n         case H5VL_FILE_GET_NAME: {\n             H5VL_file_get_name_args_t *file_args = &args->args.get_name;\n"}]