[{"patch": "diff --git a/.gitignore b/.gitignore\nindex 85b3571c..3a8a8b43 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -78,3 +78,8 @@ venv/**\n \n #MacOS system files\n **/.DS_Store\n+Build/\n+bin/\n+lib/\n+*.out\n+*.exe\ndiff --git a/Packet++/src/GtpLayer.cpp b/Packet++/src/GtpLayer.cpp\nindex 2e935cf5..05e04867 100644\n--- a/Packet++/src/GtpLayer.cpp\n+++ b/Packet++/src/GtpLayer.cpp\n@@ -405,19 +405,21 @@ namespace pcpp\n \t\t\tPCPP_LOG_ERROR(\"Add extension failed: cannot extend layer\");\n \t\t\treturn {};\n \t\t}\n-\n-\t\t// lastExt != null means layer contains 1 or more extensions\n-\t\tif (!lastExt.isNull())\n-\t\t{\n-\t\t\t// set the next header type in the last extension\n-\t\t\tlastExt.setNextHeaderType(extensionType);\n-\t\t}\n-\t\telse\n-\t\t{\n-\t\t\t// mark extension flags in the layer\n-\t\t\theader->extensionHeaderFlag = 1;\n-\t\t\theaderExtra->nextExtensionHeader = extensionType;\n-\t\t}\n+        // lastExt != null means layer contains 1 or more extensions\n+        if (!lastExt.isNull())\n+        {\n+            // set the next header type in the last extension\n+            lastExt.setNextHeaderType(extensionType);\n+        }\n+        else\n+        {\n+            // Reacquire header pointers after extendLayer to avoid use-after-free\n+            header = getHeader();\n+            headerExtra = getHeaderExtra();\n+            // mark extension flags in the layer\n+            header->extensionHeaderFlag = 1;\n+            headerExtra->nextExtensionHeader = extensionType;\n+        }\n \n \t\t// create the extension data and return the extension object to the user\n \t\treturn GtpV1Layer::GtpExtension::createGtpExtension(\n"}]