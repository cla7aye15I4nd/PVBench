[{"patch": "diff --git a/.gitignore b/.gitignore\nindex 49acc9f2e17..de22b095dfc 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -297,3 +297,12 @@ tmp-php.ini\n !/ext/fileinfo/magicdata.patch\n !/ext/pcre/pcre2lib/config.h\n !/win32/build/Makefile\n+build/\n+Build/\n+bin/\n+lib/\n+*.out\n+*.exe\n+*.dll\n+*.so\n+*.dylib\ndiff --git a/ext/standard/array.c b/ext/standard/array.c\nindex eee260f2243..acf42f79e91 100644\n--- a/ext/standard/array.c\n+++ b/ext/standard/array.c\n@@ -2960,6 +2960,12 @@ PHP_FUNCTION(range)\n \t\t}\n \n \t\t/* Generate array of characters */\n+\t\t/* Ensure strings are valid and not empty before accessing first character */\n+\t\tif (UNEXPECTED(!user_start || Z_TYPE_P(user_start) != IS_STRING || Z_STRLEN_P(user_start) == 0 ||\n+\t\t               !user_end || Z_TYPE_P(user_end) != IS_STRING || Z_STRLEN_P(user_end) == 0)) {\n+\t\t\tphp_error_docref(NULL, E_WARNING, \"Invalid string arguments for character range\");\n+\t\t\tRETURN_THROWS();\n+\t\t}\n \t\tunsigned char low = (unsigned char)Z_STRVAL_P(user_start)[0];\n \t\tunsigned char high = (unsigned char)Z_STRVAL_P(user_end)[0];\n \n"}]