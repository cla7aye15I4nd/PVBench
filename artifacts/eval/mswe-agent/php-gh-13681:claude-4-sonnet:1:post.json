{"patch": "diff --git a/.gitignore b/.gitignore\nindex b8eb03412fa..e959803a362 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -296,3 +296,12 @@ tmp-php.ini\n !/ext/fileinfo/magicdata.patch\n !/ext/pcre/pcre2lib/config.h\n !/win32/build/Makefile\n+build/\n+Build/\n+bin/\n+lib/\n+*.out\n+*.exe\n+*.dll\n+*.so\n+*.dylib\ndiff --git a/sapi/phpdbg/phpdbg_watch.c b/sapi/phpdbg/phpdbg_watch.c\nindex 0468d4614fd..56409926693 100644\n--- a/sapi/phpdbg/phpdbg_watch.c\n+++ b/sapi/phpdbg/phpdbg_watch.c\n@@ -556,7 +556,7 @@ bool phpdbg_is_recursively_watched(void *ptr, phpdbg_watch_element *element) {\n \tphpdbg_watch_element *next = element;\n \tdo {\n \t\telement = next;\n-\t\tif (element->watch->addr.ptr == ptr) {\n+\t\tif (element->watch && element->watch->addr.ptr == ptr) {\n \t\t\treturn 1;\n \t\t}\n \t\tnext = element->parent;\n@@ -584,7 +584,7 @@ void phpdbg_add_recursive_watch_from_ht(phpdbg_watch_element *element, zend_long\n \tchild->name_in_parent = str;\n \tchild->parent = element;\n \tchild->child = NULL;\n-\tchild->parent_container = HT_WATCH_HT(element->watch);\n+\tchild->parent_container = element->watch ? HT_WATCH_HT(element->watch) : NULL;\n \tzend_hash_add_ptr(&element->child_container, child->str, child);\n \tphpdbg_add_bucket_watch_element((Bucket *) zv, child);\n }\n@@ -593,7 +593,7 @@ void phpdbg_recurse_watch_element(phpdbg_watch_element *element) {\n \tphpdbg_watch_element *child;\n \tzval *zv;\n \n-\tif (element->watch->type == WATCH_ON_ZVAL || element->watch->type == WATCH_ON_BUCKET) {\n+\tif (element->watch && (element->watch->type == WATCH_ON_ZVAL || element->watch->type == WATCH_ON_BUCKET)) {\n \t\tzv = element->watch->addr.zv;\n \t\twhile (Z_TYPE_P(zv) == IS_INDIRECT) {\n \t\t\tzv = Z_INDIRECT_P(zv);\n@@ -626,7 +626,7 @@ void phpdbg_recurse_watch_element(phpdbg_watch_element *element) {\n \t\t}\n \t\tzend_hash_init(&child->child_container, 8, NULL, NULL, 0);\n \t\tphpdbg_add_ht_watch_element(zv, child);\n-\t} else if (zend_hash_num_elements(&element->child_container) == 0) {\n+\t} else if (element->watch && zend_hash_num_elements(&element->child_container) == 0) {\n \t\tzend_string *str;\n \t\tzend_long idx;\n \n@@ -638,7 +638,7 @@ void phpdbg_recurse_watch_element(phpdbg_watch_element *element) {\n }\n \n void phpdbg_watch_parent_ht(phpdbg_watch_element *element) {\n-\tif (element->watch->type == WATCH_ON_BUCKET) {\n+\tif (element->watch && element->watch->type == WATCH_ON_BUCKET) {\n \t\tphpdbg_btree_result *res;\n \t\tHashPosition pos;\n \t\tphpdbg_watch_ht_info *hti;\n@@ -668,7 +668,7 @@ void phpdbg_watch_parent_ht(phpdbg_watch_element *element) {\n }\n \n void phpdbg_unwatch_parent_ht(phpdbg_watch_element *element) {\n-\tif (element->watch->type == WATCH_ON_BUCKET) {\n+\tif (element->watch && element->watch->type == WATCH_ON_BUCKET) {\n \t\tphpdbg_btree_result *res = phpdbg_btree_find(&PHPDBG_G(watch_HashTables), (zend_ulong) element->parent_container);\n \t\tZEND_ASSERT(element->parent_container);\n \t\tif (res) {\n@@ -859,7 +859,9 @@ void phpdbg_remove_watch_element(phpdbg_watch_element *element) {\n }\n \n void phpdbg_backup_watch_element(phpdbg_watch_element *element) {\n-\tmemcpy(&element->backup, &element->watch->backup, /* element->watch->size */ sizeof(element->backup));\n+\tif (element->watch) {\n+\t\tmemcpy(&element->backup, &element->watch->backup, /* element->watch->size */ sizeof(element->backup));\n+\t}\n }\n \n /* until argument to prevent double remove of children elements */\n@@ -917,7 +919,7 @@ void phpdbg_update_watch_element_watch(phpdbg_watch_element *element) {\n \t\t\tchild = child->child;\n \t\t}\n \n-\t\tZEND_ASSERT(element->watch->type == WATCH_ON_ZVAL || element->watch->type == WATCH_ON_BUCKET);\n+\t\tZEND_ASSERT(element->watch && (element->watch->type == WATCH_ON_ZVAL || element->watch->type == WATCH_ON_BUCKET));\n \t\tphpdbg_queue_element_for_recreation(element);\n \t} else if (element->flags & (PHPDBG_WATCH_RECURSIVE_ROOT | PHPDBG_WATCH_SIMPLE)) {\n \t\tphpdbg_queue_element_for_recreation(element);\n@@ -969,11 +971,13 @@ void phpdbg_remove_watchpoint(phpdbg_watchpoint_t *watch) {\n }\n \n void phpdbg_clean_watch_element(phpdbg_watch_element *element) {\n-\tHashTable *elements = &element->watch->elements;\n-\tphpdbg_unwatch_parent_ht(element);\n-\tzend_hash_del(elements, element->str);\n-\tif (zend_hash_num_elements(elements) == 0) {\n-\t\tphpdbg_remove_watchpoint(element->watch);\n+\tif (element->watch) {\n+\t\tHashTable *elements = &element->watch->elements;\n+\t\tphpdbg_unwatch_parent_ht(element);\n+\t\tzend_hash_del(elements, element->str);\n+\t\tif (zend_hash_num_elements(elements) == 0) {\n+\t\t\tphpdbg_remove_watchpoint(element->watch);\n+\t\t}\n \t}\n }\n \n", "result": true}