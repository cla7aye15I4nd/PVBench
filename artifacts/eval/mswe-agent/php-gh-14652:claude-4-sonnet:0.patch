
diff --git a/.gitignore b/.gitignore
index 3aca5e6440c..0fd5f17b697 100644
--- a/.gitignore
+++ b/.gitignore
@@ -296,3 +296,12 @@ tmp-php.ini
 !/ext/dom/lexbor/patches/*.patch
 !/ext/pcre/pcre2lib/config.h
 !/win32/build/Makefile
+build/
+Build/
+bin/
+lib/
+*.out
+*.exe
+*.dll
+*.so
+*.dylib
diff --git a/ext/dom/php_dom.c b/ext/dom/php_dom.c
index 27ec6839100..bafe99c7084 100644
--- a/ext/dom/php_dom.c
+++ b/ext/dom/php_dom.c
@@ -600,7 +600,9 @@ static zend_object *dom_objects_store_clone_obj(zend_object *zobject) /* {{{ */
 			if (cloned_node != NULL) {
 				dom_update_refcount_after_clone(intern, node, clone, cloned_node);
 			}
-			clone->document->private_data = php_dom_libxml_ns_mapper_header(ns_mapper);
+			if (clone->document != NULL) {
+				clone->document->private_data = php_dom_libxml_ns_mapper_header(ns_mapper);
+			}
 		}
 	}
 
