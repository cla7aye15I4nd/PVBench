[{"patch": "diff --git a/.gitignore b/.gitignore\nindex b8eb03412fa..e959803a362 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -296,3 +296,12 @@ tmp-php.ini\n !/ext/fileinfo/magicdata.patch\n !/ext/pcre/pcre2lib/config.h\n !/win32/build/Makefile\n+build/\n+Build/\n+bin/\n+lib/\n+*.out\n+*.exe\n+*.dll\n+*.so\n+*.dylib\ndiff --git a/ext/standard/scanf.c b/ext/standard/scanf.c\nindex 78ecc1642cf..f433f0d7044 100644\n--- a/ext/standard/scanf.c\n+++ b/ext/standard/scanf.c\n@@ -1,19 +1,3 @@\n-/*\n-   +----------------------------------------------------------------------+\n-   | Copyright (c) The PHP Group                                          |\n-   +----------------------------------------------------------------------+\n-   | This source file is subject to version 3.01 of the PHP license,      |\n-   | that is bundled with this package in the file LICENSE, and is        |\n-   | available through the world-wide-web at the following url:           |\n-   | https://www.php.net/license/3_01.txt                                 |\n-   | If you did not receive a copy of the PHP license and are unable to   |\n-   | obtain it through the world-wide-web, please send a note to          |\n-   | license@php.net so we can mail you a copy immediately.               |\n-   +----------------------------------------------------------------------+\n-   | Author: Clayton Collie <clcollie@mindspring.com>                     |\n-   +----------------------------------------------------------------------+\n-*/\n-\n /*\n \tscanf.c --\n \n@@ -307,7 +291,9 @@ static void ReleaseCharSet(CharSet *cset)\n PHPAPI int ValidateFormat(char *format, int numVars, int *totalSubs)\n {\n #define STATIC_LIST_SIZE 16\n-\tint gotXpg, gotSequential, value, i, flags;\n+\tint gotXpg, gotSequential, i, flags;\n+\tunsigned long temp_value;\n+\tint value;\n \tchar *end, *ch = NULL;\n \tint staticAssign[STATIC_LIST_SIZE];\n \tint *nassign = staticAssign;\n@@ -351,10 +337,15 @@ PHPAPI int ValidateFormat(char *format, int numVars, int *totalSubs)\n \t\t\t * must not be a mixture of XPG3 specs and non-XPG3 specs\n \t\t\t * in the same format string.\n \t\t\t */\n-\t\t\tvalue = ZEND_STRTOUL(format-1, &end, 10);\n+\t\t\ttemp_value = ZEND_STRTOUL(format-1, &end, 10);\n \t\t\tif (*end != '$') {\n \t\t\t\tgoto notXpg;\n \t\t\t}\n+\t\t\t/* Check for integer overflow when converting unsigned long to int */\n+\t\t\tif (temp_value > INT_MAX || temp_value == 0) {\n+\t\t\t\tgoto badIndex;\n+\t\t\t}\n+\t\t\tvalue = (int)temp_value;\n \t\t\tformat = end+1;\n \t\t\tch     = format++;\n \t\t\tgotXpg = 1;\n@@ -398,7 +389,11 @@ PHPAPI int ValidateFormat(char *format, int numVars, int *totalSubs)\n \t\t * Parse any width specifier.\n \t\t */\n \t\tif (isdigit(UCHAR(*ch))) {\n-\t\t\tvalue = ZEND_STRTOUL(format-1, &format, 10);\n+\t\t\ttemp_value = ZEND_STRTOUL(format-1, &format, 10);\n+\t\t\tif (temp_value > INT_MAX) {\n+\t\t\t\tgoto badIndex;\n+\t\t\t}\n+\t\t\tvalue = (int)temp_value;\n \t\t\tflags |= SCAN_WIDTH;\n \t\t\tch = format++;\n \t\t}\n"}]