
diff --git a/.gitignore b/.gitignore
index b8eb03412fa..e959803a362 100644
--- a/.gitignore
+++ b/.gitignore
@@ -296,3 +296,12 @@ tmp-php.ini
 !/ext/fileinfo/magicdata.patch
 !/ext/pcre/pcre2lib/config.h
 !/win32/build/Makefile
+build/
+Build/
+bin/
+lib/
+*.out
+*.exe
+*.dll
+*.so
+*.dylib
diff --git a/ext/standard/scanf.c b/ext/standard/scanf.c
index 78ecc1642cf..b87db3b79fe 100644
--- a/ext/standard/scanf.c
+++ b/ext/standard/scanf.c
@@ -362,7 +362,7 @@ PHPAPI int ValidateFormat(char *format, int numVars, int *totalSubs)
 				goto mixedXPG;
 			}
 			objIndex = value - 1;
-			if ((objIndex < 0) || (numVars && (objIndex >= numVars))) {
+			if ((objIndex < 0) || (objIndex >= SCAN_MAX_ARGS) || (numVars && (objIndex >= numVars))) {
 				goto badIndex;
 			} else if (numVars == 0) {
 				/*
diff --git a/test_reproduce.php b/test_reproduce.php
new file mode 100644
index 00000000000..439931c57b2
--- /dev/null
+++ b/test_reproduce.php
@@ -0,0 +1,12 @@
+<?php
+// Test case to reproduce the integer overflow issue
+// Using a large XPG format specifier that could cause overflow
+$format = "%999999999\$d";
+$input = "123";
+$result = array();
+
+// This should trigger the vulnerability
+sscanf($input, $format, $result);
+
+echo "Test completed\n";
+?>
