
diff --git a/.gitignore b/.gitignore
index d54334f599a..3a5943bfb9b 100644
--- a/.gitignore
+++ b/.gitignore
@@ -297,3 +297,12 @@ tmp-php.ini
 !/ext/dom/lexbor/patches/*.patch
 !/ext/pcre/pcre2lib/config.h
 !/win32/build/Makefile
+build/
+Build/
+bin/
+lib/
+*.out
+*.exe
+*.dll
+*.so
+*.dylib
diff --git a/ext/dom/inner_html_mixin.c b/ext/dom/inner_html_mixin.c
index 262c85411aa..af3bf900976 100644
--- a/ext/dom/inner_html_mixin.c
+++ b/ext/dom/inner_html_mixin.c
@@ -179,8 +179,15 @@ static lxb_dom_document_cmode_t dom_translate_quirks_mode(php_libxml_quirks_mode
 }
 
 /* https://html.spec.whatwg.org/#html-fragment-parsing-algorithm */
+
 static xmlNodePtr dom_html_fragment_parsing_algorithm(dom_object *obj, xmlNodePtr context_node, const zend_string *input, php_libxml_quirks_mode quirks_mode)
 {
+	/* Add null check to prevent crash */
+	if (context_node == NULL) {
+		php_dom_throw_error(INVALID_STATE_ERR, true);
+		return NULL;
+	}
+
 	/* The whole algorithm is implemented in Lexbor, we just have to be the adapter between the
 	 * data structures used in PHP and what Lexbor expects. */
 
@@ -222,6 +229,11 @@ static xmlNodePtr dom_html_fragment_parsing_algorithm(dom_object *obj, xmlNodePt
 
 static void dom_xml_parser_tag_name(const xmlNode *context_node, xmlParserCtxtPtr parser)
 {
+	/* Add null check to prevent crash */
+	if (context_node == NULL) {
+		return;
+	}
+
 	if (context_node->ns != NULL && context_node->ns->prefix != NULL) {
 		xmlParseChunk(parser, (const char *) context_node->ns->prefix, xmlStrlen(context_node->ns->prefix), 0);
 		xmlParseChunk(parser, ":", 1, 0);
@@ -230,6 +242,7 @@ static void dom_xml_parser_tag_name(const xmlNode *context_node, xmlParserCtxtPt
 	xmlParseChunk(parser, (const char *) context_node->name, xmlStrlen(context_node->name), 0);
 }
 
+
 static void dom_xml_fragment_parsing_algorithm_parse(php_dom_libxml_ns_mapper *ns_mapper, const xmlNode *context_node, const zend_string *input, xmlParserCtxtPtr parser)
 {
 	xmlParseChunk(parser, "<", 1, 0);
@@ -266,8 +279,15 @@ static void dom_xml_fragment_parsing_algorithm_parse(php_dom_libxml_ns_mapper *n
 }
 
 /* https://html.spec.whatwg.org/#xml-fragment-parsing-algorithm */
+
 static xmlNodePtr dom_xml_fragment_parsing_algorithm(dom_object *obj, const xmlNode *context_node, const zend_string *input)
 {
+	/* Add null check to prevent crash */
+	if (context_node == NULL) {
+		php_dom_throw_error(INVALID_STATE_ERR, true);
+		return NULL;
+	}
+
 	/* Steps 1-4 below */
 	xmlParserCtxtPtr parser = xmlCreatePushParserCtxt(NULL, NULL, NULL, 0, NULL);
 	if (UNEXPECTED(parser == NULL)) {
