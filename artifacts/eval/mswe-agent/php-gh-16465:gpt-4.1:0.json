[{"patch": "diff --git a/.gitignore b/.gitignore\nindex d54334f599a..3a5943bfb9b 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -297,3 +297,12 @@ tmp-php.ini\n !/ext/dom/lexbor/patches/*.patch\n !/ext/pcre/pcre2lib/config.h\n !/win32/build/Makefile\n+build/\n+Build/\n+bin/\n+lib/\n+*.out\n+*.exe\n+*.dll\n+*.so\n+*.dylib\ndiff --git a/Zend/zend_alloc.c b/Zend/zend_alloc.c\nindex 2c8023e6257..b0342d44d0d 100644\n--- a/Zend/zend_alloc.c\n+++ b/Zend/zend_alloc.c\n@@ -1480,7 +1480,7 @@ static zend_always_inline void *zend_mm_alloc_heap(zend_mm_heap *heap, size_t si\n \tsize = MAX(size, 1);\n \tsize = ZEND_MM_ALIGNED_SIZE(size) + ZEND_MM_ALIGNED_SIZE(sizeof(zend_mm_debug_info));\n \tif (UNEXPECTED(size < real_size)) {\n-\t\tzend_error_noreturn(E_ERROR, \"Possible integer overflow in memory allocation (%zu + %zu)\", ZEND_MM_ALIGNED_SIZE(real_size), ZEND_MM_ALIGNED_SIZE(sizeof(zend_mm_debug_info)));\n+        return NULL;\n \t\treturn NULL;\n \t}\n #endif\ndiff --git a/ext/dom/php_dom.c b/ext/dom/php_dom.c\nindex 939c1794520..0ca40eeee29 100644\n--- a/ext/dom/php_dom.c\n+++ b/ext/dom/php_dom.c\n@@ -1480,7 +1480,11 @@ void dom_namednode_iter(dom_object *basenode, int ntype, dom_object *intern, xml\n \t\t\tmapptr->local = xmlCharStrndup(local, len);\n \t\t\tmapptr->free_local = true;\n \t\t}\n-\t\tmapptr->local_lower = BAD_CAST estrdup(local);\n+        if (len < 0) {\n+            mapptr->local_lower = BAD_CAST estrdup(local);\n+        } else {\n+            mapptr->local_lower = BAD_CAST estrndup(local, len);\n+        }\n \t\tif (len < 0) {\n \t\t\tzend_str_tolower((char *) mapptr->local_lower, strlen((const char *) mapptr->local_lower));\n \t\t} else {\n"}]