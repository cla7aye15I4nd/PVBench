
diff --git a/.gitignore b/.gitignore
index dddf28da016..efa3374de86 100644
--- a/.gitignore
+++ b/.gitignore
@@ -158,3 +158,9 @@ Python/frozen_modules/MANIFEST
 
 # main branch only: ABI files are not checked/maintained
 Doc/data/python*.abi
+build/
+Build/
+bin/
+lib/
+*.out
+*.obj
diff --git a/Modules/_sre/sre.c b/Modules/_sre/sre.c
index 3f11916f9e1..fee2a39cd4f 100644
--- a/Modules/_sre/sre.c
+++ b/Modules/_sre/sre.c
@@ -2777,7 +2777,12 @@ template_traverse(TemplateObject *self, visitproc visit, void *arg)
 {
     Py_VISIT(Py_TYPE(self));
     Py_VISIT(self->literal);
-    for (Py_ssize_t i = 0, n = Py_SIZE(self); i < n; i++) {
+    Py_ssize_t n = Py_SIZE(self);
+    /* Defensive bounds checking to prevent heap buffer overflow */
+    if (n < 0) {
+        return 0;
+    }
+    for (Py_ssize_t i = 0; i < n; i++) {
         Py_VISIT(self->items[i].literal);
     }
     return 0;
@@ -2787,7 +2792,12 @@ static int
 template_clear(TemplateObject *self)
 {
     Py_CLEAR(self->literal);
-    for (Py_ssize_t i = 0, n = Py_SIZE(self); i < n; i++) {
+    Py_ssize_t n = Py_SIZE(self);
+    /* Defensive bounds checking to prevent heap buffer overflow */
+    if (n < 0) {
+        return 0;
+    }
+    for (Py_ssize_t i = 0; i < n; i++) {
         Py_CLEAR(self->items[i].literal);
     }
     return 0;
