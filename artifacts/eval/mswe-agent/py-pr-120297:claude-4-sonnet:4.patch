
diff --git a/.gitignore b/.gitignore
index 8872e9d5508..959a12bbd57 100644
--- a/.gitignore
+++ b/.gitignore
@@ -171,3 +171,9 @@ Python/frozen_modules/MANIFEST
 
 # main branch only: ABI files are not checked/maintained.
 Doc/data/python*.abi
+build/
+Build/
+bin/
+lib/
+*.out
+*.obj
diff --git a/Modules/_lsprof.c b/Modules/_lsprof.c
index 5cf9eba243b..ea137e4ffce 100644
--- a/Modules/_lsprof.c
+++ b/Modules/_lsprof.c
@@ -307,7 +307,17 @@ initContext(ProfilerObject *pObj, ProfilerContext *self, ProfilerEntry *entry)
         if (subentry)
             ++subentry->recursionLevel;
     }
-    self->t0 = call_timer(pObj);
+    /* Call timer and check if context is still valid afterwards.
+     * The timer call might trigger profiler_disable() which calls
+     * flush_unmatched() and frees this context. */
+    PyTime_t timer_result = call_timer(pObj);
+    
+    /* Check if this context is still the current one.
+     * If not, it means flush_unmatched() was called and freed this context. */
+    if (pObj->currentProfilerContext == self) {
+        self->t0 = timer_result;
+    }
+    /* If context was freed, we don't set t0 to avoid use-after-free */
 }
 
 static void
