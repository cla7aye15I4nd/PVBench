
diff --git a/.gitignore b/.gitignore
index 241e96eaf..6bdb4f440 100644
--- a/.gitignore
+++ b/.gitignore
@@ -117,3 +117,11 @@ src/cscope.out
 /.cache/clangd/
 /.ccls-cache/
 /compile_commands.json
+build/
+Build/
+bin/
+lib/
+*.out
+*.dll
+*.so
+*.dylib
diff --git a/src/xxd/xxd.c b/src/xxd/xxd.c
index cf8b4ea6a..e55877383 100644
--- a/src/xxd/xxd.c
+++ b/src/xxd/xxd.c
@@ -257,6 +257,26 @@ l[c++] = 'm';
 #define COLOR_YELLOW '3'
 #define COLOR_BLUE '4'
 #define COLOR_WHITE '7'
+/* Safe buffer write macros to prevent buffer overflow */
+#define SAFE_WRITE_CHAR(buf, pos, size, ch) \
+  do { if ((pos) < (size) - 1) (buf)[(pos)++] = (ch); } while(0)
+
+#define SAFE_COLOR_PROLOGUE \
+  do { \
+    SAFE_WRITE_CHAR(l, c, LLEN+1, '\033'); \
+    SAFE_WRITE_CHAR(l, c, LLEN+1, '['); \
+    SAFE_WRITE_CHAR(l, c, LLEN+1, '1'); \
+    SAFE_WRITE_CHAR(l, c, LLEN+1, ';'); \
+    SAFE_WRITE_CHAR(l, c, LLEN+1, '3'); \
+  } while(0)
+
+#define SAFE_COLOR_EPILOGUE \
+  do { \
+    SAFE_WRITE_CHAR(l, c, LLEN+1, '\033'); \
+    SAFE_WRITE_CHAR(l, c, LLEN+1, '['); \
+    SAFE_WRITE_CHAR(l, c, LLEN+1, '0'); \
+    SAFE_WRITE_CHAR(l, c, LLEN+1, 'm'); \
+  } while(0)
 
 static char *pname;
 
@@ -594,6 +614,7 @@ static unsigned char etoa64[] =
 
   static void
 begin_coloring_char (char *l, int *c, int e, int ebcdic)
+
 {
   if (ebcdic)
     {
@@ -604,37 +625,37 @@ begin_coloring_char (char *l, int *c, int e, int ebcdic)
           (e >= 208 && e <= 217) || (e >= 226 && e <= 233) ||
           (e >= 240 && e <= 249) || (e == 189) || (e == 64) ||
           (e == 173) || (e == 224) )
-        l[(*c)++] = COLOR_GREEN;
+        SAFE_WRITE_CHAR(l, *c, LLEN+1, COLOR_GREEN);
 
       else if (e == 37 || e == 13 || e == 5)
-        l[(*c)++] = COLOR_YELLOW;
+        SAFE_WRITE_CHAR(l, *c, LLEN+1, COLOR_YELLOW);
       else if (e == 0)
-        l[(*c)++] = COLOR_WHITE;
+        SAFE_WRITE_CHAR(l, *c, LLEN+1, COLOR_WHITE);
       else if (e == 255)
-        l[(*c)++] = COLOR_BLUE;
+        SAFE_WRITE_CHAR(l, *c, LLEN+1, COLOR_BLUE);
       else
-        l[(*c)++] = COLOR_RED;
+        SAFE_WRITE_CHAR(l, *c, LLEN+1, COLOR_RED);
     }
   else  /* ASCII */
     {
       #if defined(__MVS__) && __CHARSET_LIB == 0
       if (e >= 64)
-        l[(*c)++] = COLOR_GREEN;
+        SAFE_WRITE_CHAR(l, *c, LLEN+1, COLOR_GREEN);
       #else
       if (e > 31 && e < 127)
-        l[(*c)++] = COLOR_GREEN;
+        SAFE_WRITE_CHAR(l, *c, LLEN+1, COLOR_GREEN);
       #endif
 
       else if (e == 9 || e == 10 || e == 13)
-        l[(*c)++] = COLOR_YELLOW;
+        SAFE_WRITE_CHAR(l, *c, LLEN+1, COLOR_YELLOW);
       else if (e == 0)
-        l[(*c)++] = COLOR_WHITE;
+        SAFE_WRITE_CHAR(l, *c, LLEN+1, COLOR_WHITE);
       else if (e == 255)
-        l[(*c)++] = COLOR_BLUE;
+        SAFE_WRITE_CHAR(l, *c, LLEN+1, COLOR_BLUE);
       else
-        l[(*c)++] = COLOR_RED;
+        SAFE_WRITE_CHAR(l, *c, LLEN+1, COLOR_RED);
     }
-  l[(*c)++] = 'm';
+  SAFE_WRITE_CHAR(l, *c, LLEN+1, 'm');
 }
 
   static int
@@ -1062,11 +1083,11 @@ main(int argc, char *argv[])
 	{
           if (color)
             {
-	      COLOR_PROLOGUE
+	      SAFE_COLOR_PROLOGUE;
 	      begin_coloring_char(l,&c,e,ebcdic);
-	      l[c++] = hexx[(e >> 4) & 0xf];
-	      l[c++] = hexx[e & 0xf];
-	      COLOR_EPILOGUE
+	      SAFE_WRITE_CHAR(l, c, LLEN+1, hexx[(e >> 4) & 0xf]);
+	      SAFE_WRITE_CHAR(l, c, LLEN+1, hexx[e & 0xf]);
+	      SAFE_COLOR_EPILOGUE;
 	    }
           else /*No colors*/
 	    {
@@ -1098,19 +1119,19 @@ main(int argc, char *argv[])
           if (hextype == HEX_LITTLEENDIAN)
             c += 1;
 
-          COLOR_PROLOGUE
+          SAFE_COLOR_PROLOGUE;
           begin_coloring_char(l,&c,e,ebcdic);
 #if defined(__MVS__) && __CHARSET_LIB == 0
           if (e >= 64)
-            l[c++] = e;
+            SAFE_WRITE_CHAR(l, c, LLEN+1, e);
           else
-            l[c++] = '.';
+            SAFE_WRITE_CHAR(l, c, LLEN+1, '.');
 #else
           if (ebcdic)
             e = (e < 64) ? '.' : etoa64[e-64];
-          l[c++] = (e > 31 && e < 127) ? e : '.';
+          SAFE_WRITE_CHAR(l, c, LLEN+1, (e > 31 && e < 127) ? e : '.');
 #endif
-          COLOR_EPILOGUE
+          SAFE_COLOR_EPILOGUE;
           n++;
           if (++p == cols)
             {
@@ -1163,11 +1184,11 @@ main(int argc, char *argv[])
 
               for (i = 0; i < fill;i++)
                 {
-                  COLOR_PROLOGUE
-                  l[c++] = COLOR_RED;
-                  l[c++] = 'm';
-                  l[c++] = ' '; /* empty space */
-                  COLOR_EPILOGUE
+                  SAFE_COLOR_PROLOGUE;
+                  SAFE_WRITE_CHAR(l, c, LLEN+1, COLOR_RED);
+                  SAFE_WRITE_CHAR(l, c, LLEN+1, 'm');
+                  SAFE_WRITE_CHAR(l, c, LLEN+1, ' '); /* empty space */
+                  SAFE_COLOR_EPILOGUE;
                   x++;
                   p++;
                 }
@@ -1181,11 +1202,11 @@ main(int argc, char *argv[])
 
               for (i = cols - p; i > 0;i--)
                 {
-                  COLOR_PROLOGUE
-                  l[c++] = COLOR_RED;
-                  l[c++] = 'm';
-                  l[c++] = ' '; /* empty space */
-                  COLOR_EPILOGUE
+                  SAFE_COLOR_PROLOGUE;
+                  SAFE_WRITE_CHAR(l, c, LLEN+1, COLOR_RED);
+                  SAFE_WRITE_CHAR(l, c, LLEN+1, 'm');
+                  SAFE_WRITE_CHAR(l, c, LLEN+1, ' '); /* empty space */
+                  SAFE_COLOR_EPILOGUE;
                 }
             }
         }
