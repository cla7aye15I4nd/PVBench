
diff --git a/.gitignore b/.gitignore
index 241e96eaf..6bdb4f440 100644
--- a/.gitignore
+++ b/.gitignore
@@ -117,3 +117,11 @@ src/cscope.out
 /.cache/clangd/
 /.ccls-cache/
 /compile_commands.json
+build/
+Build/
+bin/
+lib/
+*.out
+*.dll
+*.so
+*.dylib
diff --git a/src/xxd/xxd.c b/src/xxd/xxd.c
index cf8b4ea6a..2ee10aa65 100644
--- a/src/xxd/xxd.c
+++ b/src/xxd/xxd.c
@@ -1097,8 +1097,11 @@ main(int argc, char *argv[])
 
           if (hextype == HEX_LITTLEENDIAN)
             c += 1;
-
-          COLOR_PROLOGUE
+          /* Prevent buffer overflow when writing color prologue */
+          if (c + 5 < (int)sizeof(l)) {
+            COLOR_PROLOGUE
+            begin_coloring_char(l,&c,e,ebcdic);
+          }
           begin_coloring_char(l,&c,e,ebcdic);
 #if defined(__MVS__) && __CHARSET_LIB == 0
           if (e >= 64)
