[{"patch": "diff --git a/.gitignore b/.gitignore\nindex 995094da..294f2ca2 100644\n--- a/.gitignore\n+++ b/.gitignore\n@@ -119,3 +119,13 @@ xstc/Makefile\n xstc/Makefile.in\n xstc/Tests\n xstc/xsts-*.tar.gz\n+build/\n+Build/\n+bin/\n+lib/\n+*.out\n+*.obj\n+*.exe\n+*.dll\n+*.so\n+*.dylib\ndiff --git a/dict.c b/dict.c\nindex c0585fe2..6397606c 100644\n--- a/dict.c\n+++ b/dict.c\n@@ -243,6 +243,17 @@ xmlDictAddString(xmlDictPtr dict, const xmlChar *name, unsigned int namelen) {\n     const xmlChar *ret;\n     size_t size = 0; /* + sizeof(_xmlDictStrings) == 1024 */\n     size_t limit = 0;\n+    unsigned int actual_len;\n+\n+    if (name == NULL) return(NULL);\n+    \n+    /* Get the actual string length to prevent buffer overflows */\n+    actual_len = strlen((const char *)name);\n+    \n+    /* Don't copy more bytes than are actually available */\n+    if (namelen > actual_len) {\n+        namelen = actual_len;\n+    }\n \n #ifdef DICT_DEBUG_PATTERNS\n     fprintf(stderr, \"-\");\n@@ -309,8 +320,21 @@ xmlDictAddQString(xmlDictPtr dict, const xmlChar *prefix, unsigned int plen,\n     const xmlChar *ret;\n     size_t size = 0; /* + sizeof(_xmlDictStrings) == 1024 */\n     size_t limit = 0;\n+    unsigned int actual_plen, actual_namelen;\n \n     if (prefix == NULL) return(xmlDictAddString(dict, name, namelen));\n+    \n+    /* Get the actual string lengths to prevent buffer overflows */\n+    actual_plen = strlen((const char *)prefix);\n+    actual_namelen = strlen((const char *)name);\n+    \n+    /* Don't copy more bytes than are actually available */\n+    if (plen > actual_plen) {\n+        plen = actual_plen;\n+    }\n+    if (namelen > actual_namelen) {\n+        namelen = actual_namelen;\n+    }\n \n #ifdef DICT_DEBUG_PATTERNS\n     fprintf(stderr, \"=\");\n@@ -375,8 +399,17 @@ static uint32_t\n xmlDictComputeBigKey(const xmlChar* data, int namelen, int seed) {\n     uint32_t hash;\n     int i;\n+    int actual_len;\n \n     if (namelen <= 0 || data == NULL) return(0);\n+    \n+    /* Get the actual string length to prevent buffer overflows */\n+    actual_len = strlen((const char *)data);\n+    \n+    /* Don't access beyond the actual string length */\n+    if (namelen > actual_len) {\n+        namelen = actual_len;\n+    }\n \n     hash = seed;\n \n@@ -447,10 +480,23 @@ xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {\n     if (name == NULL) return(0);\n     value = *name;\n     value <<= 5;\n+    \n+    /* Get the actual string length to prevent buffer overflows */\n+    int actual_len = strlen((const char *)name);\n+    \n     if (namelen > 10) {\n-        value += name[namelen - 1];\n+        /* Only access name[namelen - 1] if the string is long enough */\n+        if (actual_len >= namelen) {\n+            value += name[namelen - 1];\n+        }\n         namelen = 10;\n     }\n+    \n+    /* Ensure we don't access beyond the actual string length */\n+    if (namelen > actual_len) {\n+        namelen = actual_len;\n+    }\n+    \n     switch (namelen) {\n         case 10: value += name[9];\n         case 9: value += name[8];\ndiff --git a/python/setup.py b/python/setup.py\ndeleted file mode 100755\nindex c44269a6..00000000\n--- a/python/setup.py\n+++ /dev/null\n@@ -1,242 +0,0 @@\n-#!/usr/bin/python -u\n-#\n-# Setup script for libxml2 and libxslt if found\n-#\n-import sys, os\n-from distutils.core import setup, Extension\n-\n-# Below ROOT, we expect to find include, include/libxml2, lib and bin.\n-# On *nix, it is not needed (but should not harm),\n-# on Windows, it is set by configure.js.\n-ROOT = r'/usr'\n-\n-# Thread-enabled libxml2\n-with_threads = 1\n-\n-# If this flag is set (windows only),\n-# a private copy of the dlls are included in the package.\n-# If this flag is not set, the libxml2 and libxslt\n-# dlls must be found somewhere in the PATH at runtime.\n-WITHDLLS = 1 and sys.platform.startswith('win')\n-\n-def missing(file):\n-    if os.access(file, os.R_OK) == 0:\n-        return 1\n-    return 0\n-\n-try:\n-    HOME = os.environ['HOME']\n-except:\n-    HOME=\"C:\"\n-\n-if WITHDLLS:\n-    # libxml dlls (expected in ROOT/bin)\n-    dlls = [ 'iconv.dll','libxml2.dll','libxslt.dll','libexslt.dll' ]\n-    dlls = [os.path.join(ROOT,'bin',dll) for dll in dlls]\n-\n-    # create __init__.py for the libxmlmods package\n-    if not os.path.exists(\"libxmlmods\"):\n-        os.mkdir(\"libxmlmods\")\n-        open(\"libxmlmods/__init__.py\",\"w\").close()\n-\n-    def altImport(s):\n-        s = s.replace(\"import libxml2mod\",\"from libxmlmods import libxml2mod\")\n-        s = s.replace(\"import libxsltmod\",\"from libxmlmods import libxsltmod\")\n-        return s\n-\n-if sys.platform.startswith('win'):\n-    libraryPrefix = 'lib'\n-    platformLibs = []\n-else:\n-    libraryPrefix = ''\n-    platformLibs = [\"m\",\"z\"]\n-\n-# those are examined to find\n-# - libxml2/libxml/tree.h\n-# - iconv.h\n-# - libxslt/xsltconfig.h\n-includes_dir = [\n-\"/usr/include\",\n-\"/usr/local/include\",\n-\"/opt/include\",\n-os.path.join(ROOT,'include'),\n-HOME\n-];\n-\n-xml_includes=\"\"\n-for dir in includes_dir:\n-    if not missing(dir + \"/libxml2/libxml/tree.h\"):\n-        xml_includes=dir + \"/libxml2\"\n-        break;\n-\n-if xml_includes == \"\":\n-    print(\"failed to find headers for libxml2: update includes_dir\")\n-    sys.exit(1)\n-\n-iconv_includes=\"\"\n-for dir in includes_dir:\n-    if not missing(dir + \"/iconv.h\"):\n-        iconv_includes=dir\n-        break;\n-\n-if iconv_includes == \"\":\n-    print(\"failed to find headers for libiconv: update includes_dir\")\n-    sys.exit(1)\n-\n-# those are added in the linker search path for libraries\n-libdirs = [\n-os.path.join(ROOT,'lib'),\n-]\n-\n-xml_files = [\"libxml2-api.xml\", \"libxml2-python-api.xml\",\n-             \"libxml.c\", \"libxml.py\", \"libxml_wrap.h\", \"types.c\",\n-             \"xmlgenerator.py\", \"README\", \"TODO\", \"drv_libxml2.py\"]\n-\n-xslt_files = [\"libxslt-api.xml\", \"libxslt-python-api.xml\",\n-             \"libxslt.c\", \"libxsl.py\", \"libxslt_wrap.h\",\n-             \"xsltgenerator.py\"]\n-\n-if missing(\"libxml2-py.c\") or missing(\"libxml2.py\"):\n-    try:\n-        try:\n-            import xmlgenerator\n-        except:\n-            import generator\n-    except:\n-        print(\"failed to find and generate stubs for libxml2, aborting ...\")\n-        print(sys.exc_info()[0], sys.exc_info()[1])\n-        sys.exit(1)\n-\n-    head = open(\"libxml.py\", \"r\")\n-    generated = open(\"libxml2class.py\", \"r\")\n-    result = open(\"libxml2.py\", \"w\")\n-    for line in head.readlines():\n-        if WITHDLLS:\n-            result.write(altImport(line))\n-        else:\n-            result.write(line)\n-    for line in generated.readlines():\n-        result.write(line)\n-    head.close()\n-    generated.close()\n-    result.close()\n-\n-with_xslt=0\n-if missing(\"libxslt-py.c\") or missing(\"libxslt.py\"):\n-    if missing(\"xsltgenerator.py\") or missing(\"libxslt-api.xml\"):\n-        print(\"libxslt stub generator not found, libxslt not built\")\n-    else:\n-        try:\n-            import xsltgenerator\n-        except:\n-            print(\"failed to generate stubs for libxslt, aborting ...\")\n-            print(sys.exc_info()[0], sys.exc_info()[1])\n-        else:\n-            head = open(\"libxsl.py\", \"r\")\n-            generated = open(\"libxsltclass.py\", \"r\")\n-            result = open(\"libxslt.py\", \"w\")\n-            for line in head.readlines():\n-                if WITHDLLS:\n-                    result.write(altImport(line))\n-                else:\n-                    result.write(line)\n-            for line in generated.readlines():\n-                result.write(line)\n-            head.close()\n-            generated.close()\n-            result.close()\n-            with_xslt=1\n-else:\n-    with_xslt=1\n-\n-if with_xslt == 1:\n-    xslt_includes=\"\"\n-    for dir in includes_dir:\n-        if not missing(dir + \"/libxslt/xsltconfig.h\"):\n-            xslt_includes=dir + \"/libxslt\"\n-            break;\n-\n-    if xslt_includes == \"\":\n-        print(\"failed to find headers for libxslt: update includes_dir\")\n-        with_xslt = 0\n-\n-\n-descr = \"libxml2 package\"\n-modules = [ 'libxml2', 'drv_libxml2' ]\n-if WITHDLLS:\n-    modules.append('libxmlmods.__init__')\n-c_files = ['libxml2-py.c', 'libxml.c', 'types.c' ]\n-includes= [xml_includes, iconv_includes]\n-libs    = [libraryPrefix + \"xml2\"] + platformLibs\n-macros  = []\n-if with_threads:\n-    macros.append(('_REENTRANT','1'))\n-if with_xslt == 1:\n-    descr = \"libxml2 and libxslt package\"\n-    if not sys.platform.startswith('win'):\n-        #\n-        # We are gonna build 2 identical shared libs with merge initializing\n-        # both libxml2mod and libxsltmod\n-        #\n-        c_files = c_files + ['libxslt-py.c', 'libxslt.c']\n-        xslt_c_files = c_files\n-        macros.append(('MERGED_MODULES', '1'))\n-    else:\n-        #\n-        # On windows the MERGED_MODULE option is not needed\n-        # (and does not work)\n-        #\n-        xslt_c_files = ['libxslt-py.c', 'libxslt.c', 'types.c']\n-    libs.insert(0, libraryPrefix + 'exslt')\n-    libs.insert(0, libraryPrefix + 'xslt')\n-    includes.append(xslt_includes)\n-    modules.append('libxslt')\n-\n-\n-extens=[Extension('libxml2mod', c_files, include_dirs=includes,\n-                  library_dirs=libdirs,\n-                  libraries=libs, define_macros=macros)]\n-if with_xslt == 1:\n-    extens.append(Extension('libxsltmod', xslt_c_files, include_dirs=includes,\n-                            library_dirs=libdirs,\n-                            libraries=libs, define_macros=macros))\n-\n-if missing(\"MANIFEST\"):\n-\n-    manifest = open(\"MANIFEST\", \"w\")\n-    manifest.write(\"setup.py\\n\")\n-    for file in xml_files:\n-        manifest.write(file + \"\\n\")\n-    if with_xslt == 1:\n-        for file in xslt_files:\n-            manifest.write(file + \"\\n\")\n-    manifest.close()\n-\n-if WITHDLLS:\n-    ext_package = \"libxmlmods\"\n-    if sys.version >= \"2.2\":\n-        base = \"lib/site-packages/\"\n-    else:\n-        base = \"\"\n-    data_files = [(base+\"libxmlmods\",dlls)]\n-else:\n-    ext_package = None\n-    data_files = []\n-\n-setup (name = \"libxml2-python\",\n-       # On *nix, the version number is created from setup.py.in\n-       # On windows, it is set by configure.js\n-       version = \"2.9.4\",\n-       description = descr,\n-       author = \"Daniel Veillard\",\n-       author_email = \"veillard@redhat.com\",\n-       url = \"http://xmlsoft.org/python.html\",\n-       licence=\"MIT Licence\",\n-       py_modules=modules,\n-       ext_modules=extens,\n-       ext_package=ext_package,\n-       data_files=data_files,\n-       )\n-\n-sys.exit(0)\n-\n"}]