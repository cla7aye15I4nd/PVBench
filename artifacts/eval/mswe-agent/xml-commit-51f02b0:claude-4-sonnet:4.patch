
diff --git a/.gitignore b/.gitignore
index 995094da..294f2ca2 100644
--- a/.gitignore
+++ b/.gitignore
@@ -119,3 +119,13 @@ xstc/Makefile
 xstc/Makefile.in
 xstc/Tests
 xstc/xsts-*.tar.gz
+build/
+Build/
+bin/
+lib/
+*.out
+*.obj
+*.exe
+*.dll
+*.so
+*.dylib
diff --git a/dict.c b/dict.c
index 5f71d55d..b023feb8 100644
--- a/dict.c
+++ b/dict.c
@@ -444,7 +444,7 @@ static unsigned long
 xmlDictComputeFastKey(const xmlChar *name, int namelen, int seed) {
     unsigned long value = seed;
 
-    if (name == NULL) return(0);
+    if (name == NULL || namelen <= 0) return(0);
     value = *name;
     value <<= 5;
     if (namelen > 10) {
@@ -837,11 +837,12 @@ xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {
         l = strlen((const char *) name);
     else
         l = len;
-
     if (((dict->limit > 0) && (l >= dict->limit)) ||
         (l > INT_MAX / 2))
         return(NULL);
 
+
+
     /*
      * Check for duplicate and insertion location.
      */
@@ -978,6 +979,8 @@ xmlDictExists(xmlDictPtr dict, const xmlChar *name, int len) {
     if (((dict->limit > 0) && (l >= dict->limit)) ||
         (l > INT_MAX / 2))
         return(NULL);
+    
+
 
     /*
      * Check for duplicate and insertion location.
@@ -1086,6 +1089,10 @@ xmlDictQLookup(xmlDictPtr dict, const xmlChar *prefix, const xmlChar *name) {
     l = len = strlen((const char *) name);
     plen = strlen((const char *) prefix);
     len += 1 + plen;
+    
+    /* Don't allow empty names */
+    if (l == 0)
+        return(NULL);
 
     /*
      * Check for duplicate and insertion location.
diff --git a/libxml2-config.cmake b/libxml2-config.cmake
new file mode 100644
index 00000000..31a19aa7
--- /dev/null
+++ b/libxml2-config.cmake
@@ -0,0 +1,50 @@
+# libxml2-config.cmake
+# --------------------
+#
+# Libxml2 cmake module.
+# THis module sets the following variables:
+#
+# ::
+#
+#   LIBXML2_INCLUDE_DIRS      - Directory where libxml2 headers are located.
+#   LIBXML2_LIBRARIES         - xml2 libraries to link against.
+#   LIBXML2_VERSION_MAJOR     - The major version of libxml2.
+#   LIBXML2_VERSION_MINOR     - The minor version of libxml2.
+#   LIBXML2_VERSION_PATCH     - The patch version of libxml2.
+#   LIBXML2_VERSION_STRING    - version number as a string (ex: "2.3.4")
+#   LIBXML2_MODULES           - whether libxml2 as dso support
+
+get_filename_component(_libxml2_rootdir ${CMAKE_CURRENT_LIST_DIR}/../../../ ABSOLUTE)
+
+set(LIBXML2_VERSION_MAJOR  2)
+set(LIBXML2_VERSION_MINOR  9)
+set(LIBXML2_VERSION_MICRO  2)
+set(LIBXML2_VERSION_STRING "2.9.2")
+set(LIBXML2_INSTALL_PREFIX ${_libxml2_rootdir})
+set(LIBXML2_INCLUDE_DIRS   ${_libxml2_rootdir}/include ${_libxml2_rootdir}/include/libxml2)
+set(LIBXML2_LIBRARY_DIR    ${_libxml2_rootdir}/lib)
+set(LIBXML2_LIBRARIES      -L${LIBXML2_LIBRARY_DIR} -lxml2)
+
+if(1)
+  find_package(Threads REQUIRED)
+  list(APPEND LIBXML2_LIBRARIES ${CMAKE_THREAD_LIBS_INIT})
+endif()
+
+if(1)
+  find_package(LibLZMA REQUIRED)
+  list(APPEND LIBXML2_LIBRARIES    ${LIBLZMA_LIBRARIES})
+  list(APPEND LIBXML2_INCLUDE_DIRS ${LIBLZMA_INCLUDE_DIRS})
+endif()
+
+if(1)
+  find_package(ZLIB REQUIRED)
+  list(APPEND LIBXML2_LIBRARIES    ${ZLIB_LIBRARIES})
+  list(APPEND LIBXML2_INCLUDE_DIRS ${ZLIB_INCLUDE_DIRS})
+endif()
+
+list(APPEND LIBXML2_LIBRARIES   -lm  )
+
+# whether libxml2 has dso support
+set(LIBXML2_MODULES 1)
+
+mark_as_advanced( LIBXML2_INCLUDE_DIRS LIBXML2_LIBRARIES )
diff --git a/python/setup.py b/python/setup.py
deleted file mode 100755
index e5043237..00000000
--- a/python/setup.py
+++ /dev/null
@@ -1,242 +0,0 @@
-#!/usr/bin/python -u
-#
-# Setup script for libxml2 and libxslt if found
-#
-import sys, os
-from distutils.core import setup, Extension
-
-# Below ROOT, we expect to find include, include/libxml2, lib and bin.
-# On *nix, it is not needed (but should not harm),
-# on Windows, it is set by configure.js.
-ROOT = r'/usr'
-
-# Thread-enabled libxml2
-with_threads = 1
-
-# If this flag is set (windows only),
-# a private copy of the dlls are included in the package.
-# If this flag is not set, the libxml2 and libxslt
-# dlls must be found somewhere in the PATH at runtime.
-WITHDLLS = 1 and sys.platform.startswith('win')
-
-def missing(file):
-    if os.access(file, os.R_OK) == 0:
-        return 1
-    return 0
-
-try:
-    HOME = os.environ['HOME']
-except:
-    HOME="C:"
-
-if WITHDLLS:
-    # libxml dlls (expected in ROOT/bin)
-    dlls = [ 'iconv.dll','libxml2.dll','libxslt.dll','libexslt.dll' ]
-    dlls = [os.path.join(ROOT,'bin',dll) for dll in dlls]
-
-    # create __init__.py for the libxmlmods package
-    if not os.path.exists("libxmlmods"):
-        os.mkdir("libxmlmods")
-        open("libxmlmods/__init__.py","w").close()
-
-    def altImport(s):
-        s = s.replace("import libxml2mod","from libxmlmods import libxml2mod")
-        s = s.replace("import libxsltmod","from libxmlmods import libxsltmod")
-        return s
-
-if sys.platform.startswith('win'):
-    libraryPrefix = 'lib'
-    platformLibs = []
-else:
-    libraryPrefix = ''
-    platformLibs = ["m","z"]
-
-# those are examined to find
-# - libxml2/libxml/tree.h
-# - iconv.h
-# - libxslt/xsltconfig.h
-includes_dir = [
-"/usr/include",
-"/usr/local/include",
-"/opt/include",
-os.path.join(ROOT,'include'),
-HOME
-];
-
-xml_includes=""
-for dir in includes_dir:
-    if not missing(dir + "/libxml2/libxml/tree.h"):
-        xml_includes=dir + "/libxml2"
-        break;
-
-if xml_includes == "":
-    print("failed to find headers for libxml2: update includes_dir")
-    sys.exit(1)
-
-iconv_includes=""
-for dir in includes_dir:
-    if not missing(dir + "/iconv.h"):
-        iconv_includes=dir
-        break;
-
-if iconv_includes == "":
-    print("failed to find headers for libiconv: update includes_dir")
-    sys.exit(1)
-
-# those are added in the linker search path for libraries
-libdirs = [
-os.path.join(ROOT,'lib'),
-]
-
-xml_files = ["libxml2-api.xml", "libxml2-python-api.xml",
-             "libxml.c", "libxml.py", "libxml_wrap.h", "types.c",
-             "xmlgenerator.py", "README", "TODO", "drv_libxml2.py"]
-
-xslt_files = ["libxslt-api.xml", "libxslt-python-api.xml",
-             "libxslt.c", "libxsl.py", "libxslt_wrap.h",
-             "xsltgenerator.py"]
-
-if missing("libxml2-py.c") or missing("libxml2.py"):
-    try:
-        try:
-            import xmlgenerator
-        except:
-            import generator
-    except:
-        print("failed to find and generate stubs for libxml2, aborting ...")
-        print(sys.exc_info()[0], sys.exc_info()[1])
-        sys.exit(1)
-
-    head = open("libxml.py", "r")
-    generated = open("libxml2class.py", "r")
-    result = open("libxml2.py", "w")
-    for line in head.readlines():
-        if WITHDLLS:
-            result.write(altImport(line))
-        else:
-            result.write(line)
-    for line in generated.readlines():
-        result.write(line)
-    head.close()
-    generated.close()
-    result.close()
-
-with_xslt=0
-if missing("libxslt-py.c") or missing("libxslt.py"):
-    if missing("xsltgenerator.py") or missing("libxslt-api.xml"):
-        print("libxslt stub generator not found, libxslt not built")
-    else:
-        try:
-            import xsltgenerator
-        except:
-            print("failed to generate stubs for libxslt, aborting ...")
-            print(sys.exc_info()[0], sys.exc_info()[1])
-        else:
-            head = open("libxsl.py", "r")
-            generated = open("libxsltclass.py", "r")
-            result = open("libxslt.py", "w")
-            for line in head.readlines():
-                if WITHDLLS:
-                    result.write(altImport(line))
-                else:
-                    result.write(line)
-            for line in generated.readlines():
-                result.write(line)
-            head.close()
-            generated.close()
-            result.close()
-            with_xslt=1
-else:
-    with_xslt=1
-
-if with_xslt == 1:
-    xslt_includes=""
-    for dir in includes_dir:
-        if not missing(dir + "/libxslt/xsltconfig.h"):
-            xslt_includes=dir + "/libxslt"
-            break;
-
-    if xslt_includes == "":
-        print("failed to find headers for libxslt: update includes_dir")
-        with_xslt = 0
-
-
-descr = "libxml2 package"
-modules = [ 'libxml2', 'drv_libxml2' ]
-if WITHDLLS:
-    modules.append('libxmlmods.__init__')
-c_files = ['libxml2-py.c', 'libxml.c', 'types.c' ]
-includes= [xml_includes, iconv_includes]
-libs    = [libraryPrefix + "xml2"] + platformLibs
-macros  = []
-if with_threads:
-    macros.append(('_REENTRANT','1'))
-if with_xslt == 1:
-    descr = "libxml2 and libxslt package"
-    if not sys.platform.startswith('win'):
-        #
-        # We are gonna build 2 identical shared libs with merge initializing
-        # both libxml2mod and libxsltmod
-        #
-        c_files = c_files + ['libxslt-py.c', 'libxslt.c']
-        xslt_c_files = c_files
-        macros.append(('MERGED_MODULES', '1'))
-    else:
-        #
-        # On windows the MERGED_MODULE option is not needed
-        # (and does not work)
-        #
-        xslt_c_files = ['libxslt-py.c', 'libxslt.c', 'types.c']
-    libs.insert(0, libraryPrefix + 'exslt')
-    libs.insert(0, libraryPrefix + 'xslt')
-    includes.append(xslt_includes)
-    modules.append('libxslt')
-
-
-extens=[Extension('libxml2mod', c_files, include_dirs=includes,
-                  library_dirs=libdirs,
-                  libraries=libs, define_macros=macros)]
-if with_xslt == 1:
-    extens.append(Extension('libxsltmod', xslt_c_files, include_dirs=includes,
-                            library_dirs=libdirs,
-                            libraries=libs, define_macros=macros))
-
-if missing("MANIFEST"):
-
-    manifest = open("MANIFEST", "w")
-    manifest.write("setup.py\n")
-    for file in xml_files:
-        manifest.write(file + "\n")
-    if with_xslt == 1:
-        for file in xslt_files:
-            manifest.write(file + "\n")
-    manifest.close()
-
-if WITHDLLS:
-    ext_package = "libxmlmods"
-    if sys.version >= "2.2":
-        base = "lib/site-packages/"
-    else:
-        base = ""
-    data_files = [(base+"libxmlmods",dlls)]
-else:
-    ext_package = None
-    data_files = []
-
-setup (name = "libxml2-python",
-       # On *nix, the version number is created from setup.py.in
-       # On windows, it is set by configure.js
-       version = "2.9.2",
-       description = descr,
-       author = "Daniel Veillard",
-       author_email = "veillard@redhat.com",
-       url = "http://xmlsoft.org/python.html",
-       licence="MIT Licence",
-       py_modules=modules,
-       ext_modules=extens,
-       ext_package=ext_package,
-       data_files=data_files,
-       )
-
-sys.exit(0)
-
diff --git a/test_buffer_overflow.c b/test_buffer_overflow.c
new file mode 100644
index 00000000..5e94535f
--- /dev/null
+++ b/test_buffer_overflow.c
@@ -0,0 +1,45 @@
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+
+// Include the necessary headers
+#include "libxml/dict.h"
+
+int main() {
+    printf("Testing buffer overflow fix in xmlDictComputeFastKey...\n");
+    
+    // Create a dictionary
+    xmlDictPtr dict = xmlDictCreate();
+    if (!dict) {
+        printf("Failed to create dictionary\n");
+        return 1;
+    }
+    
+    // Test case 1: Empty string with length 0
+    xmlChar *empty_name = (xmlChar*)malloc(1);
+    empty_name[0] = '\0';
+    
+    printf("Test 1: Calling xmlDictLookup with empty string and length 0\n");
+    const xmlChar *result1 = xmlDictLookup(dict, empty_name, 0);
+    printf("Result 1: %s\n", result1 ? "Success" : "NULL (expected)");
+    
+    // Test case 2: Valid string with length 0 (should be safe now)
+    xmlChar *valid_name = (xmlChar*)strdup("test");
+    
+    printf("Test 2: Calling xmlDictLookup with valid string but length 0\n");
+    const xmlChar *result2 = xmlDictLookup(dict, valid_name, 0);
+    printf("Result 2: %s\n", result2 ? "Success" : "NULL (expected)");
+    
+    // Test case 3: Normal operation
+    printf("Test 3: Calling xmlDictLookup with valid string and correct length\n");
+    const xmlChar *result3 = xmlDictLookup(dict, valid_name, 4);
+    printf("Result 3: %s\n", result3 ? (char*)result3 : "NULL");
+    
+    // Cleanup
+    free(empty_name);
+    free(valid_name);
+    xmlDictFree(dict);
+    
+    printf("All tests completed successfully - no buffer overflow!\n");
+    return 0;
+}
diff --git a/test_dict.c b/test_dict.c
new file mode 100644
index 00000000..e2e58560
--- /dev/null
+++ b/test_dict.c
@@ -0,0 +1,22 @@
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include "libxml/dict.h"
+
+int main() {
+    xmlDictPtr dict = xmlDictCreate();
+    
+    // Test case that could trigger buffer overflow
+    // Create a string with length 0 but valid pointer
+    xmlChar *name = (xmlChar*)malloc(1);
+    name[0] = '\0';  // Empty string
+    
+    // This should trigger the issue - calling with namelen=0
+    const xmlChar *result = xmlDictLookup(dict, name, 0);
+    
+    printf("Test completed\n");
+    
+    free(name);
+    xmlDictFree(dict);
+    return 0;
+}
diff --git a/test_overflow_fix.c b/test_overflow_fix.c
new file mode 100644
index 00000000..f477151c
--- /dev/null
+++ b/test_overflow_fix.c
@@ -0,0 +1,67 @@
+#include <string.h>
+#include <libxml/parser.h>
+#include <libxml/dict.h>
+#include <stdio.h>
+
+int main() {
+    xmlDictPtr dict;
+    const xmlChar *result;
+    xmlChar *test_string;
+    int errors = 0;
+    
+    printf("Testing buffer overflow fix in xmlDictComputeFastKey...\n");
+    
+    // Initialize libxml2
+    xmlInitParser();
+    
+    // Create a dictionary
+    dict = xmlDictCreate();
+    if (dict == NULL) {
+        printf("Failed to create dictionary\n");
+        return 1;
+    }
+    
+    // Test case 1: Call with length 0 - this should not crash
+    test_string = xmlStrdup((const xmlChar *)"test");
+    printf("Test 1: xmlDictLookup with length 0...\n");
+    result = xmlDictLookup(dict, test_string, 0);
+    if (result == NULL) {
+        printf("  PASS: Returned NULL as expected for length 0\n");
+    } else {
+        printf("  UNEXPECTED: Returned non-NULL for length 0\n");
+        errors++;
+    }
+    
+    // Test case 2: Call with negative length - should be handled safely
+    printf("Test 2: xmlDictLookup with negative length...\n");
+    result = xmlDictLookup(dict, test_string, -1);
+    if (result != NULL) {
+        printf("  PASS: Handled negative length correctly\n");
+    } else {
+        printf("  FAIL: Failed to handle negative length\n");
+        errors++;
+    }
+    
+    // Test case 3: Normal operation should still work
+    printf("Test 3: xmlDictLookup with normal parameters...\n");
+    result = xmlDictLookup(dict, test_string, 4);
+    if (result != NULL && xmlStrEqual(result, test_string)) {
+        printf("  PASS: Normal operation works correctly\n");
+    } else {
+        printf("  FAIL: Normal operation failed\n");
+        errors++;
+    }
+    
+    // Cleanup
+    xmlFree(test_string);
+    xmlDictFree(dict);
+    xmlCleanupParser();
+    
+    if (errors == 0) {
+        printf("All tests passed! Buffer overflow fix is working.\n");
+        return 0;
+    } else {
+        printf("Some tests failed (%d errors)\n", errors);
+        return 1;
+    }
+}
diff --git a/testdict.c b/testdict.c
index 40bebd05..5fb22560 100644
--- a/testdict.c
+++ b/testdict.c
@@ -422,6 +422,64 @@ static int run_test1(void) {
     return(ret);
 }
 
+
+static int test_buffer_overflow_fix(void) {
+    xmlDictPtr dict;
+    const xmlChar *result;
+    xmlChar *test_string;
+    int errors = 0;
+    
+    printf("Testing buffer overflow fix in xmlDictComputeFastKey...\n");
+    
+    dict = xmlDictCreate();
+    if (dict == NULL) {
+        fprintf(stderr, "Failed to create dictionary for buffer overflow test\n");
+        return 1;
+    }
+    
+    /* Test case 1: Call with length 0 - this should not crash */
+    test_string = xmlStrdup((const xmlChar *)"test");
+    result = xmlDictLookup(dict, test_string, 0);
+    if (result == NULL) {
+        printf("  PASS: xmlDictLookup with length 0 returned NULL as expected\n");
+    } else {
+        fprintf(stderr, "  FAIL: xmlDictLookup with length 0 returned non-NULL\n");
+        errors++;
+    }
+    
+    /* Test case 2: Call with negative length - should use strlen */
+    result = xmlDictLookup(dict, test_string, -1);
+    if (result != NULL) {
+        printf("  PASS: xmlDictLookup with negative length handled correctly\n");
+    } else {
+        fprintf(stderr, "  FAIL: xmlDictLookup with negative length failed\n");
+        errors++;
+    }
+    
+    /* Test case 3: Empty string with length 0 */
+    xmlChar *empty_string = xmlStrdup((const xmlChar *)"");
+    result = xmlDictLookup(dict, empty_string, 0);
+    if (result == NULL) {
+        printf("  PASS: xmlDictLookup with empty string and length 0 returned NULL\n");
+    } else {
+        fprintf(stderr, "  FAIL: xmlDictLookup with empty string and length 0 returned non-NULL\n");
+        errors++;
+    }
+    
+    /* Cleanup */
+    xmlFree(test_string);
+    xmlFree(empty_string);
+    xmlDictFree(dict);
+    
+    if (errors == 0) {
+        printf("Buffer overflow fix tests: ALL PASSED\n");
+    } else {
+        printf("Buffer overflow fix tests: %d FAILED\n", errors);
+    }
+    
+    return errors;
+}
+
 int main(void)
 {
     int ret;
@@ -432,6 +490,12 @@ int main(void)
     print_strings();
 #endif
     ret = run_test1();
+    
+    /* Test the buffer overflow fix */
+    int overflow_errors = test_buffer_overflow_fix();
+    ret += overflow_errors;
+    nbErrors += overflow_errors;
+    
     if (ret == 0) {
         printf("dictionary tests succeeded %d strings\n", 2 * NB_STRINGS_MAX);
     } else {
