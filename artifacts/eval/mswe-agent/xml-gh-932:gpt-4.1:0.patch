
diff --git a/.gitignore b/.gitignore
index 1ec7961f..87231784 100644
--- a/.gitignore
+++ b/.gitignore
@@ -64,3 +64,12 @@ Makefile.in
 /m4/lt*.m4
 /py-compile
 /stamp-h1
+build/
+Build/
+bin/
+lib/
+*.out
+*.obj
+*.dll
+*.so
+*.dylib
diff --git a/schematron.c b/schematron.c
index 5c1a27bf..b0885eec 100644
--- a/schematron.c
+++ b/schematron.c
@@ -1453,7 +1453,14 @@ xmlSchematronFormatReport(xmlSchematronValidCtxtPtr ctxt,
             select = xmlGetNoNsProp(child, BAD_CAST "select");
             comp = xmlXPathCtxtCompile(ctxt->xctxt, select);
             eval = xmlXPathCompiledEval(comp, ctxt->xctxt);
-
+            if (eval == NULL) {
+                xmlSchematronVErr(ctxt, XML_ERR_INTERNAL_ERROR,
+                                  "Failed to evaluate XPath expression\n", NULL);
+                xmlXPathFreeCompExpr(comp);
+                xmlFree(select);
+                child = child->next;
+                continue;
+            }
             switch (eval->type) {
             case XPATH_NODESET: {
                 int indx;
