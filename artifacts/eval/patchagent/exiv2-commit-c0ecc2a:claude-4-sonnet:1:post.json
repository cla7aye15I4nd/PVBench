{"patch": "diff --git a/src/crwimage_int.cpp b/src/crwimage_int.cpp\nindex c2fd5f3a5..9d1a75a0c 100644\n--- a/src/crwimage_int.cpp\n+++ b/src/crwimage_int.cpp\n@@ -281,7 +281,7 @@ namespace Exiv2 {\n         if (size < 4)\n             throw Error(kerCorruptedMetadata);\n         uint32_t o = getULong(pData + size - 4, byteOrder);\n-        if ( o+2 > size )\n+        if (o >= size || o > size - 2)\n             throw Error(kerCorruptedMetadata);\n         uint16_t count = getUShort(pData + o, byteOrder);\n #ifdef DEBUG\n", "result": true}