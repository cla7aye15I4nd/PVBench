{"patch": "diff --git a/src/crwimage_int.cpp b/src/crwimage_int.cpp\nindex c2fd5f3a5..35a7c8d02 100644\n--- a/src/crwimage_int.cpp\n+++ b/src/crwimage_int.cpp\n@@ -281,8 +281,10 @@ namespace Exiv2 {\n         if (size < 4)\n             throw Error(kerCorruptedMetadata);\n         uint32_t o = getULong(pData + size - 4, byteOrder);\n-        if ( o+2 > size )\n+        // Ensure o is within bounds and will not overflow\n+        if (o > size || o + 2 > size) {\n             throw Error(kerCorruptedMetadata);\n+        }\n         uint16_t count = getUShort(pData + o, byteOrder);\n #ifdef DEBUG\n         std::cout << \"Directory at offset \" << std::dec << o\n", "result": true}