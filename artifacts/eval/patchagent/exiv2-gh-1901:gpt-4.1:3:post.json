{"patch": "diff --git a/xmpsdk/src/XMPUtils.cpp b/xmpsdk/src/XMPUtils.cpp\nindex 8474b8dd3..4d87a6c06 100644\n--- a/xmpsdk/src/XMPUtils.cpp\n+++ b/xmpsdk/src/XMPUtils.cpp\n@@ -15,6 +15,7 @@\n \n #include <map>\n #include <limits>\n+#include <limits.h>\n \n #include <time.h>\n #include <string.h>\n@@ -1960,7 +1961,15 @@ XMPUtils::SetTimeZone ( XMP_DateTime * xmpTime )\n \t\tif ( now == -1 ) XMP_Throw ( \"Failure from ANSI C time function\", kXMPErr_ExternalFailure );\n \t\tansi_localtime ( &now, &tmLocal );\n \t} else {\n-\t\ttmLocal.tm_year = xmpTime->year - 1900;\n+\t\t/* Prevent signed integer overflow and ensure tm_year fits in int */\n+\t\tif (xmpTime->year == LONG_MIN ||\n+\t\t    xmpTime->year - 1900 < INT_MIN ||\n+\t\t    xmpTime->year - 1900 > INT_MAX) {\n+\t\t\t/* Fallback to 1970 if year is out of range to avoid undefined behavior */\n+\t\t\ttmLocal.tm_year = 1970 - 1900;\n+\t\t} else {\n+\t\t\ttmLocal.tm_year = (int)(xmpTime->year - 1900);\n+\t\t}\n #if 0\n \t\t// Removed to fix https://github.com/Exiv2/exiv2/issues/1901\n \t\twhile ( tmLocal.tm_year < 70 ) tmLocal.tm_year += 4;\t// ! Some versions of mktime barf on years before 1970.\n", "result": true}