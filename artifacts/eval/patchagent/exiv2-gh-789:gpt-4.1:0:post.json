{"patch": "diff --git a/src/pngimage.cpp b/src/pngimage.cpp\nindex 4ccec39d8..569b5cc53 100644\n--- a/src/pngimage.cpp\n+++ b/src/pngimage.cpp\n@@ -463,11 +463,17 @@ namespace Exiv2 {\n                     // The ICC profile name can vary from 1-79 characters.\n                     uint32_t iccOffset = 0;\n                     while (iccOffset < 80 && iccOffset < chunkLength) {\n-                         if (chunkData.pData_[iccOffset++] ==  0x00) {\n+                        if (chunkData.pData_[iccOffset++] == 0x00) {\n                             break;\n-                         }\n+                        }\n+                    }\n+                    // After the loop, iccOffset points to the byte after the null terminator (or chunkLength if not found)\n+                    if (iccOffset == 0 || iccOffset > chunkLength || chunkData.pData_[iccOffset-1] != 0x00) {\n+                        throw Exiv2::Error(kerCorruptedMetadata);\n                     }\n                     profileName_ = std::string(reinterpret_cast<char *>(chunkData.pData_), iccOffset-1);\n+                    // Now iccOffset points to the compressed flag\n+                    enforce(iccOffset < chunkLength, Exiv2::kerCorruptedMetadata);\n                     ++iccOffset; // +1 = 'compressed' flag\n                     enforce(iccOffset <= chunkLength, Exiv2::kerCorruptedMetadata);\n \n", "result": true}