{"patch": "diff --git a/src/pngimage.cpp b/src/pngimage.cpp\nindex 4ccec39d8..a4689a7a3 100644\n--- a/src/pngimage.cpp\n+++ b/src/pngimage.cpp\n@@ -467,11 +467,21 @@ namespace Exiv2 {\n                             break;\n                          }\n                     }\n+                    // Only assign profileName_ if a null byte was found within bounds\n+                    if (iccOffset == 0 || iccOffset > chunkLength || iccOffset > 80 || chunkData.pData_[iccOffset-1] != 0x00) {\n+                        throw Exiv2::Error(kerCorruptedMetadata);\n+                    }\n+                    // iccOffset is at least 1 and points just after the null byte\n                     profileName_ = std::string(reinterpret_cast<char *>(chunkData.pData_), iccOffset-1);\n                     ++iccOffset; // +1 = 'compressed' flag\n                     enforce(iccOffset <= chunkLength, Exiv2::kerCorruptedMetadata);\n \n-                    zlibToDataBuf(chunkData.pData_ + iccOffset, chunkLength - iccOffset, iccProfile_);\n+                    // Only decompress if there is data left\n+                    if (iccOffset < chunkLength) {\n+                        zlibToDataBuf(chunkData.pData_ + iccOffset, chunkLength - iccOffset, iccProfile_);\n+                    } else {\n+                        iccProfile_.free();\n+                    }\n #ifdef DEBUG\n                     std::cout << \"Exiv2::PngImage::readMetadata: profile name: \" << profileName_ << std::endl;\n                     std::cout << \"Exiv2::PngImage::readMetadata: iccProfile.size_ (uncompressed) : \"\n", "result": true}