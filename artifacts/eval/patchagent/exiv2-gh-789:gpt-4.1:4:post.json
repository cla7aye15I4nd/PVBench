{"patch": "diff --git a/src/pngimage.cpp b/src/pngimage.cpp\nindex 4ccec39d8..7f312e149 100644\n--- a/src/pngimage.cpp\n+++ b/src/pngimage.cpp\n@@ -462,15 +462,26 @@ namespace Exiv2 {\n                 } else if (chunkType == \"iCCP\") {\n                     // The ICC profile name can vary from 1-79 characters.\n                     uint32_t iccOffset = 0;\n+                    // Find null terminator for profile name\n                     while (iccOffset < 80 && iccOffset < chunkLength) {\n-                         if (chunkData.pData_[iccOffset++] ==  0x00) {\n+                        if (chunkData.pData_[iccOffset] == 0x00) {\n                             break;\n-                         }\n+                        }\n+                        ++iccOffset;\n                     }\n-                    profileName_ = std::string(reinterpret_cast<char *>(chunkData.pData_), iccOffset-1);\n-                    ++iccOffset; // +1 = 'compressed' flag\n-                    enforce(iccOffset <= chunkLength, Exiv2::kerCorruptedMetadata);\n-\n+                    // If null not found or at position 0 or at/after end, error\n+                    if (iccOffset == 0 || iccOffset >= chunkLength || chunkData.pData_[iccOffset] != 0x00) {\n+                        throw Exiv2::Error(kerCorruptedMetadata);\n+                    }\n+                    // There must be at least 2 more bytes: 1 for compression method, 1 for compressed data\n+                    if (chunkLength < iccOffset + 2) {\n+                        throw Exiv2::Error(kerCorruptedMetadata);\n+                    }\n+                    profileName_ = std::string(reinterpret_cast<char *>(chunkData.pData_), iccOffset);\n+                    ++iccOffset; // move past null terminator to compression method\n+                    // skip compression method\n+                    ++iccOffset;\n+                    // Now iccOffset points to start of compressed data\n                     zlibToDataBuf(chunkData.pData_ + iccOffset, chunkLength - iccOffset, iccProfile_);\n #ifdef DEBUG\n                     std::cout << \"Exiv2::PngImage::readMetadata: profile name: \" << profileName_ << std::endl;\n", "result": true}