{"patch": "diff --git a/lib/AST/ES6Class.cpp b/lib/AST/ES6Class.cpp\nindex 42155e587..99c578dc9 100644\n--- a/lib/AST/ES6Class.cpp\n+++ b/lib/AST/ES6Class.cpp\n@@ -140,6 +140,13 @@ class ES6ClassesTransformations {\n       : context_(context),\n         identVar_(context.getIdentifier(\"var\").getUnderlyingPointer()) {}\n \n+  // Maximum allowed recursion depth to prevent stack overflow.\n+  static constexpr int kMaxRecursionDepth = 512;\n+\n+  // Track current recursion depth.\n+  int recursionDepth_ = 0;\n+  bool recursionFailed_ = false;\n+\n   ESTree::VisitResult visit(ESTree::ClassDeclarationNode *classDecl) {\n     auto *classBody = llvh::dyn_cast<ESTree::ClassBodyNode>(classDecl->_body);\n     if (classBody == nullptr) {\n@@ -223,10 +230,21 @@ class ES6ClassesTransformations {\n   }\n \n   bool incRecursionDepth(ESTree::Node *) {\n+    if (recursionFailed_) {\n+      return false;\n+    }\n+    if (++recursionDepth_ > kMaxRecursionDepth) {\n+      recursionFailed_ = true;\n+      return false;\n+    }\n     return true;\n   }\n \n-  void decRecursionDepth() {}\n+  void decRecursionDepth() {\n+    if (!recursionFailed_ && recursionDepth_ > 0) {\n+      --recursionDepth_;\n+    }\n+  }\n \n  private:\n   Context &context_;\n", "result": true}