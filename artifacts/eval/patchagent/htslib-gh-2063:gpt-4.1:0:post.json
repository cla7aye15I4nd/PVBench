{"patch": "diff --git a/hts.c b/hts.c\nindex 923eaaf0..61550b10 100644\n--- a/hts.c\n+++ b/hts.c\n@@ -4452,8 +4452,13 @@ int hts_itr_multi_next(htsFile *fd, hts_itr_t *iter, void *r)\n                                 if ((max>>32) != tid)\n                                     tid = HTS_IDX_START; // => no range limit\n \n-                                if (end < rl->intervals[max & 0xffffffff].end)\n-                                    end = rl->intervals[max & 0xffffffff].end;\n+                                uint32_t interval_idx = max & 0xffffffff;\n+                                if (interval_idx < rl->count) {\n+                                    if (end < rl->intervals[interval_idx].end)\n+                                        end = rl->intervals[interval_idx].end;\n+                                } else {\n+                                    hts_log_error(\"Interval index %u out of bounds (count=%u) in hts_itr_multi_next\", interval_idx, rl->count);\n+                                }\n                                 if (v < iter->off[j].v)\n                                     v = iter->off[j].v;\n                                 j++;\n", "result": true}