{"patch": "diff --git a/icu4c/source/i18n/formatted_string_builder.cpp b/icu4c/source/i18n/formatted_string_builder.cpp\nindex 5aabc31cc43..29321edf406 100644\n--- a/icu4c/source/i18n/formatted_string_builder.cpp\n+++ b/icu4c/source/i18n/formatted_string_builder.cpp\n@@ -276,8 +276,13 @@ int32_t FormattedStringBuilder::prepareForInsertHelper(int32_t index, int32_t co\n     char16_t *oldChars = getCharPtr();\n     Field *oldFields = getFieldPtr();\n     if (fLength + count > oldCapacity) {\n-        int32_t newCapacity = (fLength + count) * 2;\n-        int32_t newZero = newCapacity / 2 - (fLength + count) / 2;\n+        int32_t needed = fLength + count;\n+        if (needed <= 0 || needed > INT32_MAX / 2) {\n+            status = U_MEMORY_ALLOCATION_ERROR;\n+            return -1;\n+        }\n+        int32_t newCapacity = needed * 2;\n+        int32_t newZero = newCapacity / 2 - needed / 2;\n \n         // C++ note: malloc appears in two places: here and in the assignment operator.\n         auto newChars = static_cast<char16_t *> (uprv_malloc(sizeof(char16_t) * newCapacity));\n", "result": true}