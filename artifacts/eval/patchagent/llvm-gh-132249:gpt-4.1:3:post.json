{"patch": "diff --git a/clang/lib/Sema/SemaDeclCXX.cpp b/clang/lib/Sema/SemaDeclCXX.cpp\nindex 2142582adf6e..a5a5eeae5e48 100644\n--- a/clang/lib/Sema/SemaDeclCXX.cpp\n+++ b/clang/lib/Sema/SemaDeclCXX.cpp\n@@ -9006,8 +9006,10 @@ bool Sema::CheckExplicitlyDefaultedComparison(Scope *S, FunctionDecl *FD,\n       return true;\n \n     if (llvm::none_of(RD->friends(), [&](const FriendDecl *F) {\n-          return FD->getCanonicalDecl() ==\n-                 F->getFriendDecl()->getCanonicalDecl();\n+          if (NamedDecl *ND = F->getFriendDecl()) {\n+            return FD->getCanonicalDecl() == ND->getCanonicalDecl();\n+          }\n+          return false;\n         })) {\n       Diag(FD->getLocation(), diag::err_defaulted_comparison_not_friend)\n           << int(DCK) << int(0) << RD;\n", "result": true}