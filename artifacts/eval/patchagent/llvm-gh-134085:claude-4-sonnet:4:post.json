{"patch": "diff --git a/llvm/lib/Transforms/Vectorize/SLPVectorizer.cpp b/llvm/lib/Transforms/Vectorize/SLPVectorizer.cpp\nindex 838e952c024c..225ad48e840d 100644\n--- a/llvm/lib/Transforms/Vectorize/SLPVectorizer.cpp\n+++ b/llvm/lib/Transforms/Vectorize/SLPVectorizer.cpp\n@@ -14698,6 +14698,10 @@ BoUpSLP::isGatherShuffledSingleRegisterEntry(\n   // scalar in the list.\n   for (const std::pair<unsigned, int> &Pair : EntryLanes) {\n     unsigned Idx = Part * VL.size() + Pair.second;\n+    // Ensure Pair.first is within bounds of Entries vector\n+    if (Pair.first >= Entries.size()) {\n+      return std::nullopt;\n+    }\n     Mask[Idx] =\n         Pair.first * VF +\n         (ForOrder ? std::distance(\n", "result": true}