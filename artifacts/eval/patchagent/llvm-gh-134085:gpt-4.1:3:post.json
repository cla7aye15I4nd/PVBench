{"patch": "diff --git a/llvm/lib/Transforms/Vectorize/SLPVectorizer.cpp b/llvm/lib/Transforms/Vectorize/SLPVectorizer.cpp\nindex 838e952c024c..9c840f6ad144 100644\n--- a/llvm/lib/Transforms/Vectorize/SLPVectorizer.cpp\n+++ b/llvm/lib/Transforms/Vectorize/SLPVectorizer.cpp\n@@ -14698,12 +14698,19 @@ BoUpSLP::isGatherShuffledSingleRegisterEntry(\n   // scalar in the list.\n   for (const std::pair<unsigned, int> &Pair : EntryLanes) {\n     unsigned Idx = Part * VL.size() + Pair.second;\n+    // Bounds check for Entries and VL\n+    if (Pair.first >= Entries.size() || Pair.second < 0 || static_cast<size_t>(Pair.second) >= VL.size()) {\n+      // Skip this entry if out of bounds\n+      continue;\n+    }\n+    const auto *Entry = Entries[Pair.first];\n+    auto *Val = VL[Pair.second];\n     Mask[Idx] =\n         Pair.first * VF +\n         (ForOrder ? std::distance(\n-                        Entries[Pair.first]->Scalars.begin(),\n-                        find(Entries[Pair.first]->Scalars, VL[Pair.second]))\n-                  : Entries[Pair.first]->findLaneForValue(VL[Pair.second]));\n+                        Entry->Scalars.begin(),\n+                        find(Entry->Scalars, Val))\n+                  : Entry->findLaneForValue(Val));\n     IsIdentity &= Mask[Idx] == Pair.second;\n   }\n   if (ForOrder || IsIdentity || Entries.empty()) {\n", "result": true}