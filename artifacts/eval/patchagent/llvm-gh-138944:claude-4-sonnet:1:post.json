{"patch": "diff --git a/llvm/lib/Target/X86/X86ISelLowering.cpp b/llvm/lib/Target/X86/X86ISelLowering.cpp\nindex f04603867a58..0176e69d9592 100644\n--- a/llvm/lib/Target/X86/X86ISelLowering.cpp\n+++ b/llvm/lib/Target/X86/X86ISelLowering.cpp\n@@ -54741,10 +54741,22 @@ SDValue X86TargetLowering::getNegatedExpression(SDValue Op, SelectionDAG &DAG,\n     Cost = (NegA || NegB || NegC) ? NegatibleCost::Cheaper\n                                   : NegatibleCost::Neutral;\n \n-    // Fill in the non-negated ops with the original values.\n-    for (int i = 0, e = Op.getNumOperands(); i != e; ++i)\n-      if (!NewOps[i])\n-        NewOps[i] = Op.getOperand(i);\n+    // Fill in the non-negated ops with the original values, but only if they\n+    // are still valid (not DELETED_NODE).\n+    for (int i = 0, e = Op.getNumOperands(); i != e; ++i) {\n+      if (!NewOps[i]) {\n+        SDValue OrigOp = Op.getOperand(i);\n+        if (OrigOp && OrigOp.getOpcode() != ISD::DELETED_NODE)\n+          NewOps[i] = OrigOp;\n+      }\n+    }\n+\n+    // Only create the new node if all operands are valid\n+    for (const SDValue &OpVal : NewOps) {\n+      if (!OpVal || OpVal.getOpcode() == ISD::DELETED_NODE)\n+        return SDValue();\n+    }\n+\n     return DAG.getNode(NewOpc, SDLoc(Op), VT, NewOps);\n   }\n   case X86ISD::FRCP:\n", "result": true}