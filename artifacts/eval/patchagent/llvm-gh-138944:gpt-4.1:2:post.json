{"patch": "diff --git a/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp b/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\nindex bbf1b0fd590e..86b4c0780324 100644\n--- a/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\n+++ b/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\n@@ -10402,9 +10402,21 @@ SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n   unsigned NumOps = Ops.size();\n   switch (NumOps) {\n   case 0: return getNode(Opcode, DL, VT);\n-  case 1: return getNode(Opcode, DL, VT, Ops[0], Flags);\n-  case 2: return getNode(Opcode, DL, VT, Ops[0], Ops[1], Flags);\n-  case 3: return getNode(Opcode, DL, VT, Ops[0], Ops[1], Ops[2], Flags);\n+  case 1:\n+    if (Ops[0].getOpcode() == ISD::DELETED_NODE)\n+      return SDValue();\n+    return getNode(Opcode, DL, VT, Ops[0], Flags);\n+  case 2:\n+    if (Ops[0].getOpcode() == ISD::DELETED_NODE ||\n+        Ops[1].getOpcode() == ISD::DELETED_NODE)\n+      return SDValue();\n+    return getNode(Opcode, DL, VT, Ops[0], Ops[1], Flags);\n+  case 3:\n+    if (Ops[0].getOpcode() == ISD::DELETED_NODE ||\n+        Ops[1].getOpcode() == ISD::DELETED_NODE ||\n+        Ops[2].getOpcode() == ISD::DELETED_NODE)\n+      return SDValue();\n+    return getNode(Opcode, DL, VT, Ops[0], Ops[1], Ops[2], Flags);\n   default: break;\n   }\n \n", "result": true}