{"patch": "diff --git a/llvm/lib/Transforms/Vectorize/LoopVectorize.cpp b/llvm/lib/Transforms/Vectorize/LoopVectorize.cpp\nindex 275b3d567856..6740279e759f 100644\n--- a/llvm/lib/Transforms/Vectorize/LoopVectorize.cpp\n+++ b/llvm/lib/Transforms/Vectorize/LoopVectorize.cpp\n@@ -7475,14 +7475,19 @@ VectorizationFactor LoopVectorizationPlanner::computeBestVF() {\n   // Verify that the VPlan-based and legacy cost models agree, except for VPlans\n   // with early exits and plans with additional VPlan simplifications. The\n   // legacy cost model doesn't properly model costs for such loops.\n-  assert((BestFactor.Width == LegacyVF.Width || BestPlan.hasEarlyExit() ||\n+    if (!(BestFactor.Width == LegacyVF.Width || BestPlan.hasEarlyExit() ||\n           planContainsAdditionalSimplifications(getPlanFor(BestFactor.Width),\n-                                                CostCtx, OrigLoop) ||\n+                                               CostCtx, OrigLoop) ||\n           planContainsAdditionalSimplifications(getPlanFor(LegacyVF.Width),\n-                                                CostCtx, OrigLoop)) &&\n-         \" VPlan cost model and legacy cost model disagreed\");\n-  assert((BestFactor.Width.isScalar() || BestFactor.ScalarCost > 0) &&\n-         \"when vectorizing, the scalar cost must be computed.\");\n+                                               CostCtx, OrigLoop))) {\n+      LLVM_DEBUG(dbgs() << \"LV: [DEBUG] VPlan cost model and legacy cost model disagreed for function: \"\n+                        << OrigLoop->getHeader()->getParent()->getName() << \"\\n\"\n+                        << \"  BestFactor.Width: \" << BestFactor.Width\n+                        << \", LegacyVF.Width: \" << LegacyVF.Width << \"\\n\");\n+    } else {\n+      assert((BestFactor.Width.isScalar() || BestFactor.ScalarCost > 0) &&\n+             \"when vectorizing, the scalar cost must be computed.\");\n+    }\n #endif\n \n   LLVM_DEBUG(dbgs() << \"LV: Selecting VF: \" << BestFactor.Width << \".\\n\");\n", "result": true}