{"patch": "diff --git a/Packet++/src/Packet.cpp b/Packet++/src/Packet.cpp\nindex 30a2790f..6c6fe01f 100644\n--- a/Packet++/src/Packet.cpp\n+++ b/Packet++/src/Packet.cpp\n@@ -84,9 +84,17 @@ namespace pcpp\n \n \t\tif (curLayer != nullptr && curLayer->getOsiModelLayer() > parseUntilLayer)\n \t\t{\n-\t\t\tm_LastLayer = curLayer->getPrevLayer();\n+\t\t\tLayer* prevLayer = curLayer->getPrevLayer();\n+\t\t\tLayer* nextLayer = curLayer->getNextLayer();\n+\t\t\tif (prevLayer != nullptr)\n+\t\t\t\tprevLayer->m_NextLayer = nullptr;\n+\t\t\tif (nextLayer != nullptr)\n+\t\t\t\tnextLayer->m_PrevLayer = nullptr;\n+\t\t\t// If curLayer is head, adjust m_FirstLayer\n+\t\t\tif (m_FirstLayer == curLayer)\n+\t\t\t\tm_FirstLayer = nextLayer;\n \t\t\tdelete curLayer;\n-\t\t\tm_LastLayer->m_NextLayer = nullptr;\n+\t\t\tm_LastLayer = prevLayer;\n \t\t}\n \n \t\tif (m_LastLayer != nullptr && parseUntil == UnknownProtocol && parseUntilLayer == OsiModelLayerUnknown)\n", "result": true}