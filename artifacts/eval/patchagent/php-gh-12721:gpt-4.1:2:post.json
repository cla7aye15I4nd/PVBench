{"patch": "diff --git a/ext/spl/spl_directory.c b/ext/spl/spl_directory.c\nindex 0dcb34b6a69..581183d38f4 100644\n--- a/ext/spl/spl_directory.c\n+++ b/ext/spl/spl_directory.c\n@@ -925,7 +925,6 @@ PHP_METHOD(SplFileInfo, getFilename)\n \n \tpath = spl_filesystem_object_get_path(intern);\n \n-\tZEND_ASSERT(path);\n \tif (path && ZSTR_LEN(path) && ZSTR_LEN(path) < ZSTR_LEN(intern->file_name)) {\n \t\t/* +1 to skip the trailing / of the path in the file name */\n \t\tsize_t path_len = ZSTR_LEN(path) + 1;\n@@ -933,7 +932,9 @@ PHP_METHOD(SplFileInfo, getFilename)\n \t} else {\n \t\tRETVAL_STR_COPY(intern->file_name);\n \t}\n-\tzend_string_release_ex(path, /* persistent */ false);\n+\tif (path) {\n+\t\tzend_string_release_ex(path, /* persistent */ false);\n+\t}\n }\n /* }}} */\n \n@@ -973,14 +974,16 @@ PHP_METHOD(SplFileInfo, getExtension)\n \n \tpath = spl_filesystem_object_get_path(intern);\n \n-\tif (ZSTR_LEN(path) && ZSTR_LEN(path) < ZSTR_LEN(intern->file_name)) {\n+\tif (path && ZSTR_LEN(path) && ZSTR_LEN(path) < ZSTR_LEN(intern->file_name)) {\n \t\tfname = ZSTR_VAL(intern->file_name) + ZSTR_LEN(path) + 1;\n \t\tflen = ZSTR_LEN(intern->file_name) - (ZSTR_LEN(path) + 1);\n \t} else {\n \t\tfname = ZSTR_VAL(intern->file_name);\n \t\tflen = ZSTR_LEN(intern->file_name);\n \t}\n-\tzend_string_release_ex(path, /* persistent */ false);\n+\tif (path) {\n+\t\tzend_string_release_ex(path, /* persistent */ false);\n+\t}\n \n \tret = php_basename(fname, flen, NULL, 0);\n \n@@ -1052,7 +1055,9 @@ PHP_METHOD(SplFileInfo, getBasename)\n \t\tfname = ZSTR_VAL(intern->file_name);\n \t\tflen = ZSTR_LEN(intern->file_name);\n \t}\n-\tzend_string_release_ex(path, /* persistent */ false);\n+\tif (path) {\n+\t\tzend_string_release_ex(path, /* persistent */ false);\n+\t}\n \n \tRETURN_STR(php_basename(fname, flen, suffix, slen));\n }\n", "result": true}