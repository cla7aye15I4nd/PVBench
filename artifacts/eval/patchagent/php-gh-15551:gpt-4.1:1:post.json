{"patch": "diff --git a/ext/dom/dom_iterators.c b/ext/dom/dom_iterators.c\nindex 866cb5a07e9..3f4feea9ea5 100644\n--- a/ext/dom/dom_iterators.c\n+++ b/ext/dom/dom_iterators.c\n@@ -185,13 +185,25 @@ static void php_dom_iterator_move_forward(zend_object_iterator *iter) /* {{{ */\n \n \tphp_dom_iterator *iterator = (php_dom_iterator *)iter;\n \n-\tobject = &iterator->intern.data;\n-\tnnmap = Z_DOMOBJ_P(object);\n-\tobjmap = (dom_nnodemap_object *)nnmap->ptr;\n-\n-\tintern = Z_DOMOBJ_P(&iterator->curobj);\n-\n-\tif (intern != NULL && intern->ptr != NULL) {\n+    object = &iterator->intern.data;\n+    if (Z_TYPE_P(object) != IS_OBJECT) {\n+        goto err;\n+    }\n+    nnmap = Z_DOMOBJ_P(object);\n+    if (nnmap == NULL || nnmap->ptr == NULL) {\n+        goto err;\n+    }\n+    objmap = (dom_nnodemap_object *)nnmap->ptr;\n+    if (objmap == NULL) {\n+        goto err;\n+    }\n+\n+    if (Z_TYPE(iterator->curobj) != IS_OBJECT) {\n+        goto err;\n+    }\n+    intern = Z_DOMOBJ_P(&iterator->curobj);\n+\n+    if (intern != NULL && intern->ptr != NULL) {\n \t\tif (objmap->nodetype != XML_ENTITY_NODE &&\n \t\t\tobjmap->nodetype != XML_NOTATION_NODE) {\n \t\t\tif (objmap->nodetype == DOM_NODESET) {\n", "result": true}