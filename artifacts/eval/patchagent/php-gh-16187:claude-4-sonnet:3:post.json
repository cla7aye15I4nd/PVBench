{"patch": "diff --git a/ext/reflection/php_reflection.c b/ext/reflection/php_reflection.c\nindex f24b00a2857..98e272e468a 100644\n--- a/ext/reflection/php_reflection.c\n+++ b/ext/reflection/php_reflection.c\n@@ -476,17 +476,33 @@ static void _class_string(smart_str *str, zend_class_entry *ce, zval *obj, char\n \t\tsmart_str prop_str = {0};\n \n \t\tcount = 0;\n-\t\tif (properties && zend_hash_num_elements(properties)) {\n-\t\t\tZEND_HASH_MAP_FOREACH_STR_KEY(properties, prop_name) {\n-\t\t\t\tif (prop_name && ZSTR_LEN(prop_name) && ZSTR_VAL(prop_name)[0]) { /* skip all private and protected properties */\n-\t\t\t\t\tif (!zend_hash_exists(&ce->properties_info, prop_name)) {\n-\t\t\t\t\t\tcount++;\n-\t\t\t\t\t\t_property_string(&prop_str, NULL, ZSTR_VAL(prop_name), ZSTR_VAL(sub_indent));\n+\t\tif (properties && zend_hash_num_elements(properties) && ce) {\n+\t\t\t/* Use safer iteration approach to avoid corrupted prop_name pointers */\n+\t\t\tzval *val;\n+\t\t\tZEND_HASH_FOREACH_STR_KEY_VAL(properties, prop_name, val) {\n+\t\t\t\t/* Extra safety: ensure prop_name is valid before any access */\n+\t\t\t\tif (!prop_name) {\n+\t\t\t\t\tcontinue;\n+\t\t\t\t}\n+\t\t\t\t\n+\t\t\t\t/* Validate pointer range to avoid accessing invalid memory */\n+\t\t\t\tif ((uintptr_t)prop_name < 0x1000) {\n+\t\t\t\t\tcontinue;\n+\t\t\t\t}\n+\t\t\t\t\n+\t\t\t\t/* Now safely check the string properties */\n+\t\t\t\tsize_t len = ZSTR_LEN(prop_name);\n+\t\t\t\tif (len > 0) {\n+\t\t\t\t\tconst char *prop_val = ZSTR_VAL(prop_name);\n+\t\t\t\t\tif (prop_val && prop_val[0]) { /* skip all private and protected properties */\n+\t\t\t\t\t\tif (!zend_hash_exists(&ce->properties_info, prop_name)) {\n+\t\t\t\t\t\t\tcount++;\n+\t\t\t\t\t\t\t_property_string(&prop_str, NULL, prop_val, ZSTR_VAL(sub_indent));\n+\t\t\t\t\t\t}\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t} ZEND_HASH_FOREACH_END();\n \t\t}\n-\n \t\tsmart_str_append_printf(str, \"\\n%s  - Dynamic properties [%d] {\\n\", indent, count);\n \t\tsmart_str_append_smart_str(str, &prop_str);\n \t\tsmart_str_append_printf(str, \"%s  }\\n\", indent);\n", "result": true}