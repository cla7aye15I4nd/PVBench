{"patch": "diff --git a/ext/spl/spl_dllist.c b/ext/spl/spl_dllist.c\nindex 186b9a34c7e..00ca2ad00b4 100644\n--- a/ext/spl/spl_dllist.c\n+++ b/ext/spl/spl_dllist.c\n@@ -735,10 +735,10 @@ PHP_METHOD(SplDoublyLinkedList, offsetSet)\n \t\telement = spl_ptr_llist_offset(intern->llist, index, intern->flags & SPL_DLLIST_IT_LIFO);\n \n \t\tif (element != NULL) {\n-\t\t\t/* the element is replaced, delref the old one as in\n-\t\t\t * SplDoublyLinkedList::pop() */\n-\t\t\tzval_ptr_dtor(&element->data);\n+\t\t\tzval old_data;\n+\t\t\tZVAL_COPY_VALUE(&old_data, &element->data);\n \t\t\tZVAL_COPY(&element->data, value);\n+\t\t\tzval_ptr_dtor(&old_data);\n \t\t} else {\n \t\t\tzval_ptr_dtor(value);\n \t\t\tzend_argument_error(spl_ce_OutOfRangeException, 1, \"is an invalid offset\");\n", "result": true}