{"patch": "diff --git a/ext/spl/spl_fixedarray.c b/ext/spl/spl_fixedarray.c\nindex 7c08a189c6f..fbec220eca3 100644\n--- a/ext/spl/spl_fixedarray.c\n+++ b/ext/spl/spl_fixedarray.c\n@@ -484,8 +484,13 @@ static void spl_fixedarray_object_unset_dimension_helper(spl_fixedarray_object *\n \t\treturn;\n \t} else {\n \t\tintern->array.should_rebuild_properties = true;\n-\t\tzval_ptr_dtor(&(intern->array.elements[index]));\n-\t\tZVAL_NULL(&intern->array.elements[index]);\n+\t\t/* Only destroy if not already NULL to avoid use-after-free */\n+\t\tif (Z_TYPE(intern->array.elements[index]) != IS_NULL) {\n+\t\t\tzval tmp;\n+\t\t\tZVAL_COPY_VALUE(&tmp, &intern->array.elements[index]);\n+\t\t\tZVAL_NULL(&intern->array.elements[index]);\n+\t\t\tzval_ptr_dtor(&tmp);\n+\t\t}\n \t}\n }\n \n", "result": true}