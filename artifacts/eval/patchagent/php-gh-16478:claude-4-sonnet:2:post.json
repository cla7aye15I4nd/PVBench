{"patch": "diff --git a/ext/spl/spl_fixedarray.c b/ext/spl/spl_fixedarray.c\nindex 7c08a189c6f..1c648cc5b3a 100644\n--- a/ext/spl/spl_fixedarray.c\n+++ b/ext/spl/spl_fixedarray.c\n@@ -484,8 +484,12 @@ static void spl_fixedarray_object_unset_dimension_helper(spl_fixedarray_object *\n \t\treturn;\n \t} else {\n \t\tintern->array.should_rebuild_properties = true;\n-\t\tzval_ptr_dtor(&(intern->array.elements[index]));\n-\t\tZVAL_NULL(&intern->array.elements[index]);\n+\t\t/* Fix use-after-free: copy the zval before destroying it */\n+\t\tzval *ptr = &(intern->array.elements[index]);\n+\t\tzval tmp;\n+\t\tZVAL_COPY_VALUE(&tmp, ptr);\n+\t\tZVAL_NULL(ptr);\n+\t\tzval_ptr_dtor(&tmp);\n \t}\n }\n \n", "result": true}