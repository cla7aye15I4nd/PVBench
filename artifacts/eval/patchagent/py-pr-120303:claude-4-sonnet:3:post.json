{"patch": "diff --git a/Objects/object.c b/Objects/object.c\nindex b7730475ac3..3c62bf99589 100644\n--- a/Objects/object.c\n+++ b/Objects/object.c\n@@ -910,6 +910,10 @@ static const char * const opstrings[] = {\"<\", \"<=\", \"==\", \"!=\", \">\", \">=\"};\n static PyObject *\n do_richcompare(PyThreadState *tstate, PyObject *v, PyObject *w, int op)\n {\n+    /* Protect the objects from being freed during recursive comparisons */\n+    Py_INCREF(v);\n+    Py_INCREF(w);\n+    \n     richcmpfunc f;\n     PyObject *res;\n     int checked_reverse_op = 0;\n@@ -919,20 +923,29 @@ do_richcompare(PyThreadState *tstate, PyObject *v, PyObject *w, int op)\n         (f = Py_TYPE(w)->tp_richcompare) != NULL) {\n         checked_reverse_op = 1;\n         res = (*f)(w, v, _Py_SwappedOp[op]);\n-        if (res != Py_NotImplemented)\n+        if (res != Py_NotImplemented) {\n+            Py_DECREF(v);\n+            Py_DECREF(w);\n             return res;\n+        }\n         Py_DECREF(res);\n     }\n     if ((f = Py_TYPE(v)->tp_richcompare) != NULL) {\n         res = (*f)(v, w, op);\n-        if (res != Py_NotImplemented)\n+        if (res != Py_NotImplemented) {\n+            Py_DECREF(v);\n+            Py_DECREF(w);\n             return res;\n+        }\n         Py_DECREF(res);\n     }\n     if (!checked_reverse_op && (f = Py_TYPE(w)->tp_richcompare) != NULL) {\n         res = (*f)(w, v, _Py_SwappedOp[op]);\n-        if (res != Py_NotImplemented)\n+        if (res != Py_NotImplemented) {\n+            Py_DECREF(v);\n+            Py_DECREF(w);\n             return res;\n+        }\n         Py_DECREF(res);\n     }\n     /* If neither object implements it, provide a sensible default\n@@ -950,8 +963,12 @@ do_richcompare(PyThreadState *tstate, PyObject *v, PyObject *w, int op)\n                       opstrings[op],\n                       Py_TYPE(v)->tp_name,\n                       Py_TYPE(w)->tp_name);\n+        Py_DECREF(v);\n+        Py_DECREF(w);\n         return NULL;\n     }\n+    Py_DECREF(v);\n+    Py_DECREF(w);\n     return Py_NewRef(res);\n }\n \n", "result": true}