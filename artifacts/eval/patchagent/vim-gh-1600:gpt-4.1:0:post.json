{"patch": "diff --git a/src/edit.c b/src/edit.c\nindex cdde11e40..b161700e8 100644\n--- a/src/edit.c\n+++ b/src/edit.c\n@@ -4948,15 +4948,22 @@ ins_compl_next(\n      */\n     if (compl_shown_match->cp_fname != NULL)\n     {\n-\tSTRCPY(IObuff, \"match in file \");\n-\ti = (vim_strsize(compl_shown_match->cp_fname) + 16) - sc_col;\n-\tif (i <= 0)\n-\t    i = 0;\n-\telse\n-\t    STRCAT(IObuff, \"<\");\n-\tSTRCAT(IObuff, compl_shown_match->cp_fname + i);\n-\tmsg(IObuff);\n-\tredraw_cmdline = FALSE;\t    /* don't overwrite! */\n+        int msg_len;\n+        int fname_len = (int)STRLEN(compl_shown_match->cp_fname);\n+        i = (vim_strsize(compl_shown_match->cp_fname) + 16) - sc_col;\n+        if (i <= 0)\n+            i = 0;\n+        else if (i > fname_len)\n+            i = fname_len;\n+        /* Compose the message safely into IObuff */\n+        if (i > 0)\n+            msg_len = vim_snprintf((char *)IObuff, IOSIZE, \"match in file <%s\", compl_shown_match->cp_fname + i);\n+        else\n+            msg_len = vim_snprintf((char *)IObuff, IOSIZE, \"match in file %s\", compl_shown_match->cp_fname);\n+        /* Ensure null-termination and no overflow */\n+        IObuff[IOSIZE-1] = '\\0';\n+        msg(IObuff);\n+        redraw_cmdline = FALSE;        /* don't overwrite! */\n     }\n \n     return num_matches;\n", "result": true}