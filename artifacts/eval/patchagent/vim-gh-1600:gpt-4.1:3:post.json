{"patch": "diff --git a/src/edit.c b/src/edit.c\nindex cdde11e40..abf33d77a 100644\n--- a/src/edit.c\n+++ b/src/edit.c\n@@ -4954,7 +4954,17 @@ ins_compl_next(\n \t    i = 0;\n \telse\n \t    STRCAT(IObuff, \"<\");\n-\tSTRCAT(IObuff, compl_shown_match->cp_fname + i);\n+\t{\n+\t    size_t len = STRLEN(IObuff);\n+\t    size_t space = IOSIZE - len - 1; /* leave space for NUL */\n+\t    char_u *fname_part = compl_shown_match->cp_fname + i;\n+\t    size_t fname_len = STRLEN(fname_part);\n+\t    if (fname_len > space)\n+\t\tfname_len = space;\n+\t    /* Use STRNCPY to append only up to 'space' bytes */\n+\t    mch_memmove(IObuff + len, fname_part, fname_len);\n+\t    IObuff[len + fname_len] = NUL;\n+\t}\n \tmsg(IObuff);\n \tredraw_cmdline = FALSE;\t    /* don't overwrite! */\n     }\n", "result": true}