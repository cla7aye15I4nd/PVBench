{"patch": "diff --git a/src/edit.c b/src/edit.c\nindex cdde11e40..7569273e8 100644\n--- a/src/edit.c\n+++ b/src/edit.c\n@@ -4948,15 +4948,22 @@ ins_compl_next(\n      */\n     if (compl_shown_match->cp_fname != NULL)\n     {\n-\tSTRCPY(IObuff, \"match in file \");\n-\ti = (vim_strsize(compl_shown_match->cp_fname) + 16) - sc_col;\n-\tif (i <= 0)\n-\t    i = 0;\n-\telse\n-\t    STRCAT(IObuff, \"<\");\n-\tSTRCAT(IObuff, compl_shown_match->cp_fname + i);\n-\tmsg(IObuff);\n-\tredraw_cmdline = FALSE;\t    /* don't overwrite! */\n+        STRCPY(IObuff, \"match in file \");\n+        int fname_len = (int)STRLEN(compl_shown_match->cp_fname);\n+        i = (vim_strsize(compl_shown_match->cp_fname) + 16) - sc_col;\n+        if (i <= 0)\n+            i = 0;\n+        else if (i > fname_len)\n+            i = fname_len;\n+        if (i > 0)\n+            STRCAT(IObuff, \"<\");\n+        /* Calculate remaining space in IObuff */\n+        int obuf_len = (int)STRLEN(IObuff);\n+        int maxcat = IOSIZE - obuf_len - 1;\n+        if (maxcat > 0)\n+            STRNCAT(IObuff, compl_shown_match->cp_fname + i, maxcat);\n+        msg(IObuff);\n+        redraw_cmdline = FALSE;        /* don't overwrite! */\n     }\n \n     return num_matches;\n", "result": true}