{"patch": "diff --git a/xpath.c b/xpath.c\nindex d40bdda6..9133c1fb 100644\n--- a/xpath.c\n+++ b/xpath.c\n@@ -12065,7 +12065,15 @@ xmlXPathIsPositionalPredicate(xmlXPathParserContextPtr ctxt,\n \t* like it \"[position() < 5]\", is also not detected.\n \t* Maybe we could rewrite the AST to ease the optimization.\n \t*/\n-\t*maxPos = (int) ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n+\tdouble floatval = ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n+\t\n+\t/* Check if the value is within the representable range of int */\n+\tif ((floatval < 1.0) || (floatval > (double)XPATH_MAX_NODESET_LENGTH)) {\n+\t    /* Value is out of reasonable range, not a valid positional predicate */\n+\t    return(0);\n+\t}\n+\t\n+\t*maxPos = (int) floatval;\n \n \tif (((xmlXPathObjectPtr) exprOp->value4)->floatval ==\n \t    (float) *maxPos)\n", "result": true}