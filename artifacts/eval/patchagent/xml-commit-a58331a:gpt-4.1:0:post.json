{"patch": "diff --git a/xpath.c b/xpath.c\nindex d40bdda6..9d3a20c6 100644\n--- a/xpath.c\n+++ b/xpath.c\n@@ -12065,13 +12065,14 @@ xmlXPathIsPositionalPredicate(xmlXPathParserContextPtr ctxt,\n \t* like it \"[position() < 5]\", is also not detected.\n \t* Maybe we could rewrite the AST to ease the optimization.\n \t*/\n-\t*maxPos = (int) ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n-\n-\tif (((xmlXPathObjectPtr) exprOp->value4)->floatval ==\n-\t    (float) *maxPos)\n-\t{\n-\t    return(1);\n-\t}\n+    double val = ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n+    if (val >= (double)INT_MIN && val <= (double)INT_MAX) {\n+        *maxPos = (int)val;\n+        if (val == (double)*maxPos) {\n+            return(1);\n+        }\n+    }\n+    /* Value is out of int range or not an integer, not a positional predicate */\n     }\n     return(0);\n }\n", "result": true}