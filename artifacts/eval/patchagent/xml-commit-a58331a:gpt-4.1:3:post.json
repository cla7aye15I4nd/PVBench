{"patch": "diff --git a/xpath.c b/xpath.c\nindex d40bdda6..0c094371 100644\n--- a/xpath.c\n+++ b/xpath.c\n@@ -12065,13 +12065,13 @@ xmlXPathIsPositionalPredicate(xmlXPathParserContextPtr ctxt,\n \t* like it \"[position() < 5]\", is also not detected.\n \t* Maybe we could rewrite the AST to ease the optimization.\n \t*/\n-\t*maxPos = (int) ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n-\n-\tif (((xmlXPathObjectPtr) exprOp->value4)->floatval ==\n-\t    (float) *maxPos)\n-\t{\n-\t    return(1);\n-\t}\n+    double floatval = ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n+    if (floatval >= (double)INT_MIN && floatval <= (double)INT_MAX) {\n+        *maxPos = (int) floatval;\n+        if (floatval == (double) *maxPos) {\n+            return(1);\n+        }\n+    }\n     }\n     return(0);\n }\n", "result": true}