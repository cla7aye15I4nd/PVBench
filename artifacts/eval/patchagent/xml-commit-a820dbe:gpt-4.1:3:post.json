{"patch": "diff --git a/HTMLparser.c b/HTMLparser.c\nindex 69eed2bd..de042e2d 100644\n--- a/HTMLparser.c\n+++ b/HTMLparser.c\n@@ -2514,6 +2514,17 @@ htmlParseNameComplex(xmlParserCtxtPtr ctxt) {\n \tNEXTL(l);\n \tc = CUR_CHAR(l);\n     }\n+    /* Bounds check: ensure we do not read before base or past end */\n+    if (len < 0 ||\n+        ctxt->input->cur - len < ctxt->input->base ||\n+        ctxt->input->cur > ctxt->input->end ||\n+        ctxt->input->cur - len + len > ctxt->input->end) {\n+        /* Try to grow the buffer if possible */\n+        GROW;\n+        if (ctxt->input->cur - len < ctxt->input->base ||\n+            ctxt->input->cur - len + len > ctxt->input->end)\n+            return NULL;\n+    }\n     return(xmlDictLookup(ctxt->dict, ctxt->input->cur - len, len));\n }\n \n", "result": true}