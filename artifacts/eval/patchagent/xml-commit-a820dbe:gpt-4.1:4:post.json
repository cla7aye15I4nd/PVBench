{"patch": "diff --git a/HTMLparser.c b/HTMLparser.c\nindex 69eed2bd..280aad28 100644\n--- a/HTMLparser.c\n+++ b/HTMLparser.c\n@@ -2514,6 +2514,10 @@ htmlParseNameComplex(xmlParserCtxtPtr ctxt) {\n \tNEXTL(l);\n \tc = CUR_CHAR(l);\n     }\n+    if (ctxt->input->cur - len < ctxt->input->base) {\n+        /* Prevent reading before buffer base */\n+        return NULL;\n+    }\n     return(xmlDictLookup(ctxt->dict, ctxt->input->cur - len, len));\n }\n \ndiff --git a/dict.c b/dict.c\nindex c0585fe2..cf9cfff0 100644\n--- a/dict.c\n+++ b/dict.c\n@@ -282,6 +282,10 @@ xmlDictAddString(xmlDictPtr dict, const xmlChar *name, unsigned int namelen) {\n     }\n found_pool:\n     ret = pool->free;\n+    if (pool->free + namelen + 1 > pool->end) {\n+        /* Not enough space, do not overflow */\n+        return NULL;\n+    }\n     memcpy(pool->free, name, namelen);\n     pool->free += namelen;\n     *(pool->free++) = 0;\n", "result": true}