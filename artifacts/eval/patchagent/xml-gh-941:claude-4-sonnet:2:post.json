{"patch": "diff --git a/shell.c b/shell.c\nindex 8ecc05b9..2cce5bc5 100644\n--- a/shell.c\n+++ b/shell.c\n@@ -1126,7 +1126,7 @@ xmllintShell(xmlDoc *doc, const char *filename, FILE * output)\n         while ((*cur == ' ') || (*cur == '\\t'))\n             cur++;\n         i = 0;\n-        while ((*cur != ' ') && (*cur != '\\t') &&\n+        while (i < (sizeof(command) - 1) && (*cur != ' ') && (*cur != '\\t') &&\n                (*cur != '\\n') && (*cur != '\\r')) {\n             if (*cur == 0)\n                 break;\n@@ -1142,7 +1142,7 @@ xmllintShell(xmlDoc *doc, const char *filename, FILE * output)\n         while ((*cur == ' ') || (*cur == '\\t'))\n             cur++;\n         i = 0;\n-        while ((*cur != '\\n') && (*cur != '\\r') && (*cur != 0)) {\n+        while (i < (sizeof(arg) - 1) && (*cur != '\\n') && (*cur != '\\r') && (*cur != 0)) {\n             if (*cur == 0)\n                 break;\n             arg[i++] = *cur++;\n", "result": true}