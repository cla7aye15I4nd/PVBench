{"patch": "diff --git a/shell.c b/shell.c\nindex 8ecc05b9..cba69168 100644\n--- a/shell.c\n+++ b/shell.c\n@@ -1130,7 +1130,12 @@ xmllintShell(xmlDoc *doc, const char *filename, FILE * output)\n                (*cur != '\\n') && (*cur != '\\r')) {\n             if (*cur == 0)\n                 break;\n-            command[i++] = *cur++;\n+            if (i < (int)sizeof(command) - 1) {\n+                command[i++] = *cur++;\n+            } else {\n+                /* skip remaining input to avoid overflow */\n+                cur++;\n+            }\n         }\n         command[i] = 0;\n         if (i == 0)\n@@ -1145,7 +1150,12 @@ xmllintShell(xmlDoc *doc, const char *filename, FILE * output)\n         while ((*cur != '\\n') && (*cur != '\\r') && (*cur != 0)) {\n             if (*cur == 0)\n                 break;\n-            arg[i++] = *cur++;\n+            if (i < (int)sizeof(arg) - 1) {\n+                arg[i++] = *cur++;\n+            } else {\n+                /* skip remaining input to avoid overflow */\n+                cur++;\n+            }\n         }\n         arg[i] = 0;\n \n", "result": true}