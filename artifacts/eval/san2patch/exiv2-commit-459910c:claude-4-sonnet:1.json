[{"patch": "diff --git a/src/quicktimevideo.cpp b/src/quicktimevideo.cpp\nindex 352fe4b0d..6ff3a5fae 100644\n--- a/src/quicktimevideo.cpp\n+++ b/src/quicktimevideo.cpp\n@@ -828,9 +828,12 @@ void QuickTimeVideo::userDataDecoder(size_t size_external) {\n       CameraTagsDecoder(size - 8);\n \n     else if (equalsQTimeTag(buf, \"CNCV\") || equalsQTimeTag(buf, \"CNFV\") || equalsQTimeTag(buf, \"CNMN\") ||\n-             equalsQTimeTag(buf, \"NCHD\") || equalsQTimeTag(buf, \"FFMV\")) {\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+              equalsQTimeTag(buf, \"NCHD\") || equalsQTimeTag(buf, \"FFMV\")) {\n       io_->readOrThrow(buf.data(), size - 8);\n-      xmpData_[exvGettext(tv->label_)] = Exiv2::toString(buf.data());\n+      if (tv) {\n+        xmpData_[exvGettext(tv->label_)] = Exiv2::toString(buf.data());\n+      }\n     }\n \n     else if (equalsQTimeTag(buf, \"CMbo\") || equalsQTimeTag(buf, \"Cmbo\")) {\n@@ -838,9 +841,9 @@ void QuickTimeVideo::userDataDecoder(size_t size_external) {\n       buf.data()[2] = '\\0';\n       tv_internal = find(cameraByteOrderTags, Exiv2::toString(buf.data()));\n \n-      if (tv_internal)\n+      if (tv_internal && tv)\n         xmpData_[exvGettext(tv->label_)] = exvGettext(tv_internal->label_);\n-      else\n+      else if (tv)\n         xmpData_[exvGettext(tv->label_)] = Exiv2::toString(buf.data());\n     }\n \n"}]