{"patch": "diff --git a/xmpsdk/include/client-glue/TXMPUtils.incl_cpp b/xmpsdk/include/client-glue/TXMPUtils.incl_cpp\nindex 6898be73b..b6871d462 100644\n--- a/xmpsdk/include/client-glue/TXMPUtils.incl_cpp\n+++ b/xmpsdk/include/client-glue/TXMPUtils.incl_cpp\n@@ -302,25 +302,33 @@ SetTimeZone ( XMP_DateTime * time )\n XMP_MethodIntro(TXMPUtils,void)::\n ConvertToUTCTime ( XMP_DateTime * time )\n {\n-\tWrapCheckVoid ( zXMPUtils_ConvertToUTCTime_1 ( time ) );\n+\tif (time != NULL && time->year >= 1900 && time->year <= 9999) {\n+\t\tWrapCheckVoid ( zXMPUtils_ConvertToUTCTime_1 ( time ) );\n+\t}\n }\n \n // -------------------------------------------------------------------------------------------------\n \n XMP_MethodIntro(TXMPUtils,void)::\n-ConvertToLocalTime ( XMP_DateTime * time )\n+// FIXME: Crash CWE-190: Integer Overflow or Wraparound\n+ ConvertToLocalTime ( XMP_DateTime * time )\n {\n-\tWrapCheckVoid ( zXMPUtils_ConvertToLocalTime_1 ( time ) );\n+\tif (time != NULL && time->year >= 1900 && time->year <= 9999) {\n+\t\tWrapCheckVoid ( zXMPUtils_ConvertToLocalTime_1 ( time ) );\n+\t}\n }\n \n // -------------------------------------------------------------------------------------------------\n \n XMP_MethodIntro(TXMPUtils,int)::\n CompareDateTime ( const XMP_DateTime & left,\n-\t\t\t\t  const XMP_DateTime & right )\n+\t\t\t  const XMP_DateTime & right )\n {\n-\tWrapCheckInt32 ( result, zXMPUtils_CompareDateTime_1 ( left, right ) );\n-\treturn result;\n+\tif ((left.year >= 1900 && left.year <= 9999) && (right.year >= 1900 && right.year <= 9999)) {\n+\t\tWrapCheckInt32 ( result, zXMPUtils_CompareDateTime_1 ( left, right ) );\n+\t\treturn result;\n+\t}\n+\treturn 0;\n }\n \n // -------------------------------------------------------------------------------------------------\n", "result": true}