[{"patch": "diff --git a/src/pngimage.cpp b/src/pngimage.cpp\nindex 4ccec39d8..78fade7e2 100644\n--- a/src/pngimage.cpp\n+++ b/src/pngimage.cpp\n@@ -461,13 +461,24 @@ namespace Exiv2 {\n                     PngChunk::decodeTXTChunk(this, chunkData, PngChunk::iTXt_Chunk);\n                 } else if (chunkType == \"iCCP\") {\n                     // The ICC profile name can vary from 1-79 characters.\n+                    if (chunkLength < 2) { // Must be at least name + compression flag\n+                        throw Exiv2::Error(Exiv2::kerCorruptedMetadata, \"iCCP chunk too small\");\n+                    }\n                     uint32_t iccOffset = 0;\n                     while (iccOffset < 80 && iccOffset < chunkLength) {\n                          if (chunkData.pData_[iccOffset++] ==  0x00) {\n                             break;\n-                         }\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+                          }\n+                    }\n+                    // Ensure we stopped due to null byte and not due to running out of chunk\n+                    if (iccOffset == chunkLength && chunkData.pData_[iccOffset-1] != 0x00) {\n+                        throw Exiv2::Error(Exiv2::kerCorruptedMetadata, \"iCCP profile name not null-terminated\");\n                     }\n                     profileName_ = std::string(reinterpret_cast<char *>(chunkData.pData_), iccOffset-1);\n+                    if (iccOffset >= chunkLength) { // compressed flag must exist\n+                        throw Exiv2::Error(Exiv2::kerCorruptedMetadata, \"iCCP compressed flag missing\");\n+                    }\n                     ++iccOffset; // +1 = 'compressed' flag\n                     enforce(iccOffset <= chunkLength, Exiv2::kerCorruptedMetadata);\n \n"}]