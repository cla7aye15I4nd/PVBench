[{"patch": "diff --git a/lib/Parser/JSParserImpl.cpp b/lib/Parser/JSParserImpl.cpp\nindex 0589efb3a..1a30d75d5 100644\n--- a/lib/Parser/JSParserImpl.cpp\n+++ b/lib/Parser/JSParserImpl.cpp\n@@ -4133,28 +4133,38 @@ Optional<ESTree::Node *> JSParserImpl::parseConditionalExpression(\n     Param param,\n     CoverTypedParameters coverTypedParameters) {\n   SMLoc startLoc = tok_->getStartLoc();\n-  auto optTest = parseBinaryExpression(param);\n-  if (!optTest)\n-    return None;\n-  ESTree::Node *test = *optTest;\n+auto optTest = parseBinaryExpression(param);\n+if (!optTest)\n+  return None;\n+ESTree::Node *test = *optTest;\n+\n+// Add maximum parse depth check to prevent excessive recursion.\n+constexpr int MAX_PARSE_DEPTH = 1000;\n+static int parseDepth = 0;\n+if (++parseDepth > MAX_PARSE_DEPTH) {\n+  // Error: excessive nesting detected.\n+  --parseDepth;\n+  return None;\n+}\n \n-  if (!check(TokenKind::question)) {\n-    // No '?', so this isn't a conditional expression.\n-    // If CoverTypedParameters::Yes, we still need to account for this\n-    // being formal parameters, so try that.\n-    // TS doesn't have type casts with this syntax, but we must still\n-    // cover the typed identifier node for when it turns into an arrow function.\n+if (!check(TokenKind::question)) {\n+  // No '?', so this isn't a conditional expression.\n+  // If CoverTypedParameters::Yes, we still need to account for this\n+// FIXME: Crash CWE-834: Excessive Iteration\n+   // being formal parameters, so try that.\n+  // TS doesn't have type casts with this syntax, but we must still\n+  // cover the typed identifier node for when it turns into an arrow function.\n #if HERMES_PARSE_FLOW || HERMES_PARSE_TS\n-    if (context_.getParseTypes() &&\n-        coverTypedParameters == CoverTypedParameters::Yes) {\n-      auto optCover = tryParseCoverTypedIdentifierNode(test, false);\n-      if (!optCover)\n-        return None;\n-      if (*optCover)\n-        return *optCover;\n-    }\n+  if (context_.getParseTypes() &&\n+      coverTypedParameters == CoverTypedParameters::Yes) {\n+    auto optCover = tryParseCoverTypedIdentifierNode(test, false);\n+    if (!optCover)\n+      { --parseDepth; return None; }\n+    if (*optCover)\n+      { --parseDepth; return *optCover; }\n+  }\n #endif\n-\n+--parseDepth;\n     // No CoverTypedParameters found, just return the LHS.\n     return test;\n   }\n"}]