[{"patch": "diff --git a/lib/Regex/Executor.cpp b/lib/Regex/Executor.cpp\nindex fb73b8e56..ccbb3b5f5 100644\n--- a/lib/Regex/Executor.cpp\n+++ b/lib/Regex/Executor.cpp\n@@ -1307,7 +1307,7 @@ auto Context<Traits>::match(State<Traits> *s, bool onlyAtStart)\n           if (c.satisfiesConstraints(flags_, insn->constraints)) {\n             // Copy the state. This is because if the match fails (or if we are\n             // inverted) we need to restore its capture groups.\n-            State savedState{*s};\n+                    State savedState{*s};\n \n             // Set the direction of the cursor.\n             c.setForwards(insn->forwards);\n@@ -1316,7 +1316,18 @@ auto Context<Traits>::match(State<Traits> *s, bool onlyAtStart)\n             // Save and restore the position because lookaheads do not consume\n             // anything.\n             s->ip_ += sizeof(LookaroundInsn);\n+            \n+            // Prevent unbounded recursion by checking current depth\n+            static thread_local int currentDepth = 0;\n+            if (currentDepth >= 1000) {\n+                *s = std::move(savedState);\n+                return ExecutionStatus::RETURNED;\n+            }\n+            \n+            currentDepth++;\n             auto match = this->match(s, true /* onlyAtStart */);\n+            currentDepth--;\n+            \n             // There were no errors and we matched something (so non-null\n             // return)\n             matched = match && match.getValue();\n"}]