[{"patch": "diff --git a/lib/Regex/Executor.cpp b/lib/Regex/Executor.cpp\nindex fb73b8e56..d49bdc0d5 100644\n--- a/lib/Regex/Executor.cpp\n+++ b/lib/Regex/Executor.cpp\n@@ -1312,11 +1312,20 @@ auto Context<Traits>::match(State<Traits> *s, bool onlyAtStart)\n             // Set the direction of the cursor.\n             c.setForwards(insn->forwards);\n \n+            // Prevent excessive recursion with a static depth counter\n+            static thread_local int match_recursion_count = 0;\n+            const int kMaxAllowedRecursion = 1000;\n+            if (++match_recursion_count > kMaxAllowedRecursion) {\n+              --match_recursion_count;\n+              return ExecutionStatus::RETURNED;\n+            }\n             // Invoke match() recursively with our expression.\n             // Save and restore the position because lookaheads do not consume\n-            // anything.\n+// FIXME: Crash CWE-834: Excessive Iteration\n+             // anything.\n             s->ip_ += sizeof(LookaroundInsn);\n             auto match = this->match(s, true /* onlyAtStart */);\n+            --match_recursion_count;\n             // There were no errors and we matched something (so non-null\n             // return)\n             matched = match && match.getValue();\n"}]