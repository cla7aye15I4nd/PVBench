[{"patch": "diff --git a/lib/Regex/Executor.cpp b/lib/Regex/Executor.cpp\nindex fb73b8e56..f56c68a78 100644\n--- a/lib/Regex/Executor.cpp\n+++ b/lib/Regex/Executor.cpp\n@@ -1305,23 +1305,31 @@ auto Context<Traits>::match(State<Traits> *s, bool onlyAtStart)\n           const LookaroundInsn *insn = llvh::cast<LookaroundInsn>(base);\n           bool matched = false;\n           if (c.satisfiesConstraints(flags_, insn->constraints)) {\n-            // Copy the state. This is because if the match fails (or if we are\n+// FIXME: Crash CWE-834: Excessive Iteration\n+             // Copy the state. This is because if the match fails (or if we are\n             // inverted) we need to restore its capture groups.\n             State savedState{*s};\n \n-            // Set the direction of the cursor.\n-            c.setForwards(insn->forwards);\n-\n-            // Invoke match() recursively with our expression.\n-            // Save and restore the position because lookaheads do not consume\n-            // anything.\n-            s->ip_ += sizeof(LookaroundInsn);\n-            auto match = this->match(s, true /* onlyAtStart */);\n-            // There were no errors and we matched something (so non-null\n-            // return)\n-            matched = match && match.getValue();\n-            c.setCurrentPointer(savedState.cursor_.currentPointer());\n-            c.setForwards(savedState.cursor_.forwards());\n+            // Use a static counter and check at each depth\n+            static thread_local int matchRecDepth = 0;\n+            if (++matchRecDepth > 1000) {\n+              matched = false;\n+            } else {\n+              // Set the direction of the cursor.\n+              c.setForwards(insn->forwards);\n+\n+              // Invoke match() recursively with our expression.\n+              // Save and restore the position because lookaheads do not consume\n+              // anything.\n+              s->ip_ += sizeof(LookaroundInsn);\n+              auto match = this->match(s, true /* onlyAtStart */);\n+              // There were no errors and we matched something (so non-null\n+              // return)\n+              matched = match && match.getValue();\n+              c.setCurrentPointer(savedState.cursor_.currentPointer());\n+              c.setForwards(savedState.cursor_.forwards());\n+            }\n+            matchRecDepth--;\n \n             // Restore capture groups unless we are a positive lookaround that\n             // successfully matched. If we are a successfully matching positive\n"}]