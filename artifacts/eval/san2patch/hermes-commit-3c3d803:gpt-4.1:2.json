[{"patch": "diff --git a/lib/Regex/Executor.cpp b/lib/Regex/Executor.cpp\nindex fb73b8e56..cc00d8b63 100644\n--- a/lib/Regex/Executor.cpp\n+++ b/lib/Regex/Executor.cpp\n@@ -1305,21 +1305,31 @@ auto Context<Traits>::match(State<Traits> *s, bool onlyAtStart)\n           const LookaroundInsn *insn = llvh::cast<LookaroundInsn>(base);\n           bool matched = false;\n           if (c.satisfiesConstraints(flags_, insn->constraints)) {\n-            // Copy the state. This is because if the match fails (or if we are\n+// FIXME: Crash CWE-674: Uncontrolled Recursion\n+             // Copy the state. This is because if the match fails (or if we are\n             // inverted) we need to restore its capture groups.\n             State savedState{*s};\n \n             // Set the direction of the cursor.\n             c.setForwards(insn->forwards);\n \n-            // Invoke match() recursively with our expression.\n-            // Save and restore the position because lookaheads do not consume\n-            // anything.\n-            s->ip_ += sizeof(LookaroundInsn);\n-            auto match = this->match(s, true /* onlyAtStart */);\n-            // There were no errors and we matched something (so non-null\n-            // return)\n-            matched = match && match.getValue();\n+            // Insert a simple recursion depth guard\n+            static int recursion_count = 0;\n+            ++recursion_count;\n+            bool limitReached = recursion_count > 1000;\n+            if (!limitReached) {\n+              // Invoke match() recursively with our expression.\n+              // Save and restore the position because lookaheads do not consume\n+              // anything.\n+              s->ip_ += sizeof(LookaroundInsn);\n+              auto match = this->match(s, true /* onlyAtStart */);\n+              // There were no errors and we matched something (so non-null\n+              // return)\n+              matched = match && match.getValue();\n+            } else {\n+              matched = false;\n+            }\n+            --recursion_count;\n             c.setCurrentPointer(savedState.cursor_.currentPointer());\n             c.setForwards(savedState.cursor_.forwards());\n \n"}]