[{"patch": "diff --git a/lib/Regex/Executor.cpp b/lib/Regex/Executor.cpp\nindex fb73b8e56..8ae38b697 100644\n--- a/lib/Regex/Executor.cpp\n+++ b/lib/Regex/Executor.cpp\n@@ -1314,9 +1314,18 @@ auto Context<Traits>::match(State<Traits> *s, bool onlyAtStart)\n \n             // Invoke match() recursively with our expression.\n             // Save and restore the position because lookaheads do not consume\n+// FIXME: Crash CWE-834: Excessive Iteration\n             // anything.\n+            static const int MAX_REGEX_RECURSION = 1000;\n+            static thread_local int regex_recursion_depth = 0;\n+            if (++regex_recursion_depth > MAX_REGEX_RECURSION) {\n+              // Exceeded recursion depth; fail safely\n+              --regex_recursion_depth;\n+              return ExecutionStatus::RETURNED;\n+            }\n             s->ip_ += sizeof(LookaroundInsn);\n             auto match = this->match(s, true /* onlyAtStart */);\n+            --regex_recursion_depth;\n             // There were no errors and we matched something (so non-null\n             // return)\n             matched = match && match.getValue();\n"}]