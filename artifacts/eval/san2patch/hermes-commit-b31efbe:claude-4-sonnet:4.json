[{"patch": "diff --git a/lib/AST/ES6Class.cpp b/lib/AST/ES6Class.cpp\nindex 42155e587..a69588f52 100644\n--- a/lib/AST/ES6Class.cpp\n+++ b/lib/AST/ES6Class.cpp\n@@ -217,20 +217,34 @@ class ES6ClassesTransformations {\n     return createGetSuperProperty(\n         memberExpression, topClass->parentClass, memberExpression->_property);\n   }\n-\n+// FIXME: Crash CWE-674: Uncontrolled Recursion\n+ \n   void visit(ESTree::Node *node) {\n+    if (!incRecursionDepth(node)) {\n+      return;\n+    }\n     visitESTreeChildren(*this, node);\n+    decRecursionDepth();\n   }\n \n   bool incRecursionDepth(ESTree::Node *) {\n+    static thread_local int depth = 0;\n+    if (depth >= 1000) {\n+      return false;\n+    }\n+    depth++;\n     return true;\n   }\n \n-  void decRecursionDepth() {}\n+  void decRecursionDepth() {\n+    static thread_local int depth = 0;\n+    if (depth > 0) {\n+      depth--;\n+    }\n+  }\n \n  private:\n-  Context &context_;\n-  UniqueString *const identVar_;\n+  Context &context_;  UniqueString *const identVar_;\n   VisitedClass *_currentProcessingClass = nullptr;\n   const ResolvedClassMember *_currentClassMember = nullptr;\n \n"}]