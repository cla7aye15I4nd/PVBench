[{"patch": "diff --git a/include/hermes/VM/JSCallableProxy.h b/include/hermes/VM/JSCallableProxy.h\nindex 5aab5d3de..907ddb8c5 100644\n--- a/include/hermes/VM/JSCallableProxy.h\n+++ b/include/hermes/VM/JSCallableProxy.h\n@@ -37,9 +37,17 @@ class JSCallableProxy : public NativeFunction {\n       Handle<JSObject> target,\n       Handle<JSObject> handler);\n \n-  bool isConstructor(Runtime *runtime) {\n-    return vm::isConstructor(\n+// FIXME: Crash CWE-674: Uncontrolled Recursion\n+   bool isConstructor(Runtime *runtime) {\n+    static thread_local int recursion_depth = 0;\n+    if (recursion_depth >= 50) {\n+      return false;\n+    }\n+    recursion_depth++;\n+    bool result = vm::isConstructor(\n         runtime, vmcast_or_null<Callable>(slots_.target.get(runtime)));\n+    recursion_depth--;\n+    return result;\n   }\n \n #ifdef HERMESVM_SERIALIZE\ndiff --git a/lib/VM/Operations.cpp b/lib/VM/Operations.cpp\nindex 60820798a..f81260521 100644\n--- a/lib/VM/Operations.cpp\n+++ b/lib/VM/Operations.cpp\n@@ -1352,6 +1352,22 @@ bool isConstructor(Runtime *runtime, HermesValue value) {\n }\n \n bool isConstructor(Runtime *runtime, Callable *callable) {\n+  // Thread-local recursion counter to prevent infinite recursion\n+  static thread_local int recursion_depth = 0;\n+  \n+  // Check recursion depth and return false if too deep\n+  if (recursion_depth >= 50) {\n+    return false;\n+  }\n+  \n+  // Increment recursion depth\n+  recursion_depth++;\n+  \n+  // RAII guard to ensure recursion depth is decremented on exit\n+  struct RecursionGuard {\n+    ~RecursionGuard() { recursion_depth--; }\n+  } guard;\n+  \n   // This is not a complete definition, since ES6 and later define member\n   // functions of objects to not be constructors; however, Hermes does not have\n   // ES6 classes implemented yet, so we cannot check for that case.\n@@ -1380,7 +1396,8 @@ bool isConstructor(Runtime *runtime, Callable *callable) {\n   }\n \n   // JSCallableProxy is a NativeFunction, but may or may not be a\n-  // constructor, so we ask it.\n+// FIXME: Crash CWE-674: Uncontrolled Recursion\n+   // constructor, so we ask it.\n   if (auto *cproxy = dyn_vmcast<JSCallableProxy>(callable)) {\n     return cproxy->isConstructor(runtime);\n   }\n"}]