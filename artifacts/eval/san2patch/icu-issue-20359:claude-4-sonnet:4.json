[{"patch": "diff --git a/icu4c/source/i18n/regexcmp.cpp b/icu4c/source/i18n/regexcmp.cpp\nindex a4c12804237..d8236bf3d01 100644\n--- a/icu4c/source/i18n/regexcmp.cpp\n+++ b/icu4c/source/i18n/regexcmp.cpp\n@@ -4019,9 +4019,26 @@ void RegexCompile::nextChar(RegexPatternChar &c) {\n         c.fQuoted = TRUE;\n         if ((c.fChar==chBackSlash && peekCharLL()==chE && ((fModeFlags & UREGEX_LITERAL) == 0)) ||\n             c.fChar == (UChar32)-1) {\n-            fQuoteMode = FALSE;  //  Exit quote mode,\n+// FIXME: Crash CWE-834: Excessive Iteration\n+             fQuoteMode = FALSE;  //  Exit quote mode,\n             nextCharLL();        // discard the E\n-            nextChar(c);         // recurse to get the real next char\n+            // Use iterative approach instead of recursive call\n+            bool needsReprocessing = true;\n+            while (needsReprocessing) {\n+                c.fChar = nextCharLL();\n+                c.fQuoted = FALSE;\n+                needsReprocessing = false;\n+                \n+                if (fQuoteMode) {\n+                    c.fQuoted = TRUE;\n+                    if ((c.fChar==chBackSlash && peekCharLL()==chE && ((fModeFlags & UREGEX_LITERAL) == 0)) ||\n+                        c.fChar == (UChar32)-1) {\n+                        fQuoteMode = FALSE;\n+                        nextCharLL();\n+                        needsReprocessing = true;\n+                    }\n+                }\n+            }\n         }\n     }\n     else if (fInBackslashQuote) {\n@@ -4031,8 +4048,7 @@ void RegexCompile::nextChar(RegexPatternChar &c) {\n         //    dispatching on the character.\n         fInBackslashQuote = FALSE;\n     }\n-    else\n-    {\n+    else    {\n         // We are not in a \\Q quoted region \\E of the source.\n         //\n         if (fModeFlags & UREGEX_COMMENTS) {\n@@ -4138,9 +4154,18 @@ void RegexCompile::nextChar(RegexPatternChar &c) {\n             }\n             else if (peekCharLL() == chQ) {\n                 //  \"\\Q\"  enter quote mode, which will continue until \"\\E\"\n-                fQuoteMode = TRUE;\n+// FIXME: Crash CWE-834: Excessive Iteration\n+                 fQuoteMode = TRUE;\n                 nextCharLL();       // discard the 'Q'.\n+                // Prevent infinite recursion by using a depth counter\n+                static int recursionDepth = 0;\n+                if (recursionDepth >= 100) {\n+                    error(U_REGEX_STACK_OVERFLOW);\n+                    return;\n+                }\n+                recursionDepth++;\n                 nextChar(c);        // recurse to get the real next char.\n+                recursionDepth--;\n             }\n             else\n             {\n"}]