{"patch": "diff --git a/icu4c/source/common/ustring.cpp b/icu4c/source/common/ustring.cpp\nindex 7ab2e1bf891..7bd74d41434 100644\n--- a/icu4c/source/common/ustring.cpp\n+++ b/icu4c/source/common/ustring.cpp\n@@ -1264,6 +1264,12 @@ u_unescapeAt(UNESCAPE_CHAR_AT charAt,\n         break;\n     }\n     if (minDig != 0) {\n+        static const int32_t UNESCAPE_MAX_RECURSION = 32;\n+        static thread_local int32_t recursionDepth = 0;\n+        if (++recursionDepth > UNESCAPE_MAX_RECURSION) {\n+            recursionDepth--;\n+            goto err;\n+        }\n         while (*offset < length && n < maxDig) {\n             c = charAt(*offset, context);\n             dig = (int8_t)((bitsPerDigit == 3) ? _digit8(c) : _digit16(c));\n@@ -1275,15 +1281,18 @@ u_unescapeAt(UNESCAPE_CHAR_AT charAt,\n             ++n;\n         }\n         if (n < minDig) {\n+            recursionDepth--;\n             goto err;\n         }\n         if (braces) {\n             if (c != 0x7D /*}*/) {\n+                recursionDepth--;\n                 goto err;\n             }\n             ++(*offset);\n         }\n         if (result < 0 || result >= 0x110000) {\n+            recursionDepth--;\n             goto err;\n         }\n         /* If an escape sequence specifies a lead surrogate, see if\n@@ -1292,15 +1301,22 @@ u_unescapeAt(UNESCAPE_CHAR_AT charAt,\n          */\n         if (*offset < length && U16_IS_LEAD(result)) {\n             int32_t ahead = *offset + 1;\n-            c = charAt(*offset, context);\n+// FIXME: Crash CWE-834: Excessive Iteration\n+             c = charAt(*offset, context);\n             if (c == 0x5C /*'\\\\'*/ && ahead < length) {\n-                c = (UChar) u_unescapeAt(charAt, &ahead, length, context);\n+                if (recursionDepth < UNESCAPE_MAX_RECURSION) {\n+                    c = (UChar) u_unescapeAt(charAt, &ahead, length, context);\n+                } else {\n+                    recursionDepth--;\n+                    goto err;\n+                }\n             }\n             if (U16_IS_TRAIL(c)) {\n                 *offset = ahead;\n                 result = U16_GET_SUPPLEMENTARY(result, c);\n             }\n         }\n+        recursionDepth--;\n         return result;\n     }\n \n", "result": true}