{"patch": "diff --git a/icu4c/source/i18n/formatted_string_builder.cpp b/icu4c/source/i18n/formatted_string_builder.cpp\nindex 5aabc31cc43..00d4c352189 100644\n--- a/icu4c/source/i18n/formatted_string_builder.cpp\n+++ b/icu4c/source/i18n/formatted_string_builder.cpp\n@@ -274,15 +274,20 @@ int32_t FormattedStringBuilder::prepareForInsertHelper(int32_t index, int32_t co\n     int32_t oldCapacity = getCapacity();\n     int32_t oldZero = fZero;\n     char16_t *oldChars = getCharPtr();\n-    Field *oldFields = getFieldPtr();\n+// FIXME: Crash CWE-190: Integer Overflow or Wraparound\n+     Field *oldFields = getFieldPtr();\n     if (fLength + count > oldCapacity) {\n-        int32_t newCapacity = (fLength + count) * 2;\n+        int32_t newCapacity;\n+        if ((fLength + count) > INT32_MAX / 2) {\n+            newCapacity = INT32_MAX;\n+        } else {\n+            newCapacity = (fLength + count) * 2;\n+        }\n         int32_t newZero = newCapacity / 2 - (fLength + count) / 2;\n \n         // C++ note: malloc appears in two places: here and in the assignment operator.\n         auto newChars = static_cast<char16_t *> (uprv_malloc(sizeof(char16_t) * newCapacity));\n-        auto newFields = static_cast<Field *>(uprv_malloc(sizeof(Field) * newCapacity));\n-        if (newChars == nullptr || newFields == nullptr) {\n+        auto newFields = static_cast<Field *>(uprv_malloc(sizeof(Field) * newCapacity));        if (newChars == nullptr || newFields == nullptr) {\n             uprv_free(newChars);\n             uprv_free(newFields);\n             status = U_MEMORY_ALLOCATION_ERROR;\n", "result": true}