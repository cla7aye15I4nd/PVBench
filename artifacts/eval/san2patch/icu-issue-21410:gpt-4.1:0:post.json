{"patch": "diff --git a/icu4c/source/i18n/formatted_string_builder.cpp b/icu4c/source/i18n/formatted_string_builder.cpp\nindex 5aabc31cc43..b10f596bafe 100644\n--- a/icu4c/source/i18n/formatted_string_builder.cpp\n+++ b/icu4c/source/i18n/formatted_string_builder.cpp\n@@ -255,19 +255,28 @@ int32_t FormattedStringBuilder::prepareForInsert(int32_t index, int32_t count, U\n     U_ASSERT(index >= 0);\n     U_ASSERT(index <= fLength);\n     U_ASSERT(count >= 0);\n-    if (index == 0 && fZero - count >= 0) {\n-        // Append to start\n+    // Check that subtraction and addition won't overflow\n+    if (index == 0 && count <= fZero && count <= INT32_MAX - fLength) {\n         fZero -= count;\n         fLength += count;\n         return fZero;\n-    } else if (index == fLength && fZero + fLength + count < getCapacity()) {\n-        // Append to end\n-        fLength += count;\n-        return fZero + fLength - count;\n-    } else {\n-        // Move chars around and/or allocate more space\n-        return prepareForInsertHelper(index, count, status);\n+    } else if (index == fLength) {\n+        // Compute sum and check for overflow\n+        int32_t sum = fZero + fLength;\n+        if ((fZero > 0 && fLength > INT32_MAX - fZero) || (count > INT32_MAX - sum)) {\n+            status = U_INDEX_OUTOFBOUNDS_ERROR;\n+            return -1;\n+        }\n+        if (sum + count < getCapacity()) {\n+            if (fLength > INT32_MAX - count) {\n+                status = U_INDEX_OUTOFBOUNDS_ERROR;\n+                return -1;\n+            }\n+            fLength += count;\n+            return fZero + fLength - count;\n+        }\n     }\n+    return prepareForInsertHelper(index, count, status);\n }\n \n int32_t FormattedStringBuilder::prepareForInsertHelper(int32_t index, int32_t count, UErrorCode &status) {\n", "result": true}