[{"patch": "diff --git a/icu4c/source/common/messagepattern.cpp b/icu4c/source/common/messagepattern.cpp\nindex 9e318295f9a..318cce7db65 100644\n--- a/icu4c/source/common/messagepattern.cpp\n+++ b/icu4c/source/common/messagepattern.cpp\n@@ -712,58 +712,65 @@ MessagePattern::parseChoiceStyle(int32_t index, int32_t nestingLevel,\n         return 0;\n     }\n     for(;;) {\n-        // The choice argument style contains |-separated (number, separator, message) triples.\n-        // Parse the number.\n-        int32_t numberIndex=index;\n-        index=skipDouble(index);\n-        int32_t length=index-numberIndex;\n-        if(length==0) {\n-            setParseError(parseError, start);  // Bad choice pattern syntax.\n-            errorCode=U_PATTERN_SYNTAX_ERROR;\n-            return 0;\n-        }\n-        if(length>Part::MAX_LENGTH) {\n-            setParseError(parseError, numberIndex);  // Choice number too long.\n-            errorCode=U_INDEX_OUTOFBOUNDS_ERROR;\n-            return 0;\n-        }\n-        parseDouble(numberIndex, index, true, parseError, errorCode);  // adds ARG_INT or ARG_DOUBLE\n-        if(U_FAILURE(errorCode)) {\n-            return 0;\n-        }\n-        // Parse the separator.\n-        index=skipWhiteSpace(index);\n-        if(index==msg.length()) {\n-            setParseError(parseError, start);  // Bad choice pattern syntax.\n-            errorCode=U_PATTERN_SYNTAX_ERROR;\n-            return 0;\n-        }\n-        char16_t c=msg.charAt(index);\n-        if(!(c==u_pound || c==u_lessThan || c==u_lessOrEqual)) {  // U+2264 is <=\n-            setParseError(parseError, start);  // Expected choice separator (#<\\u2264) instead of c.\n-            errorCode=U_PATTERN_SYNTAX_ERROR;\n-            return 0;\n-        }\n-        addPart(UMSGPAT_PART_TYPE_ARG_SELECTOR, index, 1, 0, errorCode);\n-        // Parse the message fragment.\n-        index=parseMessage(++index, 0, nestingLevel+1, UMSGPAT_ARG_TYPE_CHOICE, parseError, errorCode);\n-        if(U_FAILURE(errorCode)) {\n-            return 0;\n-        }\n-        // parseMessage(..., CHOICE) returns the index of the terminator, or msg.length().\n-        if(index==msg.length()) {\n-            return index;\n-        }\n-        if(msg.charAt(index)==u_rightCurlyBrace) {\n-            if(!inMessageFormatPattern(nestingLevel)) {\n-                setParseError(parseError, start);  // Bad choice pattern syntax.\n-                errorCode=U_PATTERN_SYNTAX_ERROR;\n-                return 0;\n-            }\n-            return index;\n-        }  // else the terminator is '|'\n-        index=skipWhiteSpace(index+1);\n+// The choice argument style contains |-separated (number, separator, message) triples.\n+// Parse the number.\n+int32_t numberIndex=index;\n+index=skipDouble(index);\n+int32_t length=index-numberIndex;\n+if(length==0) {\n+    setParseError(parseError, start);  // Bad choice pattern syntax.\n+    errorCode=U_PATTERN_SYNTAX_ERROR;\n+    return 0;\n+}\n+if(length>Part::MAX_LENGTH) {\n+    setParseError(parseError, numberIndex);  // Choice number too long.\n+    errorCode=U_INDEX_OUTOFBOUNDS_ERROR;\n+    return 0;\n+}\n+parseDouble(numberIndex, index, true, parseError, errorCode);  // adds ARG_INT or ARG_DOUBLE\n+if(U_FAILURE(errorCode)) {\n+    return 0;\n+}\n+// Parse the separator.\n+index=skipWhiteSpace(index);\n+if(index==msg.length()) {\n+    setParseError(parseError, start);  // Bad choice pattern syntax.\n+    errorCode=U_PATTERN_SYNTAX_ERROR;\n+    return 0;\n+}\n+char16_t c=msg.charAt(index);\n+if(!(c==u_pound || c==u_lessThan || c==u_lessOrEqual)) {  // U+2264 is <=\n+    setParseError(parseError, start);  // Expected choice separator (#<\\u2264) instead of c.\n+    errorCode=U_PATTERN_SYNTAX_ERROR;\n+    return 0;\n+}\n+// FIXME: Crash CWE-834: Excessive Iteration\n+// Use a defined error code for limit exceeded. ICU typically uses U_ILLEGAL_ARGUMENT_ERROR for such cases if a specific error code is not defined.\n+if(nestingLevel > 32) {\n+    setParseError(parseError, index);  // Too deep nesting.\n+    errorCode=U_ILLEGAL_ARGUMENT_ERROR;\n+    return 0;\n+}\n+addPart(UMSGPAT_PART_TYPE_ARG_SELECTOR, index, 1, 0, errorCode);\n+// Parse the message fragment.\n+index=parseMessage(++index, 0, nestingLevel+1, UMSGPAT_ARG_TYPE_CHOICE, parseError, errorCode);\n+if(U_FAILURE(errorCode)) {\n+    return 0;\n+}\n+// parseMessage(..., CHOICE) returns the index of the terminator, or msg.length().\n+if(index==msg.length()) {\n+    return index;\n+}\n+if(msg.charAt(index)==u_rightCurlyBrace) {\n+    if(!inMessageFormatPattern(nestingLevel)) {\n+        setParseError(parseError, start);  // Bad choice pattern syntax.\n+        errorCode=U_PATTERN_SYNTAX_ERROR;\n+        return 0;\n     }\n+    return index;\n+}  // else the terminator is '|'\n+index=skipWhiteSpace(index+1);\n+}\n }\n \n int32_t\n"}]