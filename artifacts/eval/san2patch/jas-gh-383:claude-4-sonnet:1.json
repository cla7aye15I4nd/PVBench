[{"patch": "diff --git a/src/libjasper/heic/heic_dec.c b/src/libjasper/heic/heic_dec.c\nindex cde3843..fb235aa 100644\n--- a/src/libjasper/heic/heic_dec.c\n+++ b/src/libjasper/heic/heic_dec.c\n@@ -209,7 +209,7 @@ jas_image_t *jas_heic_decode(jas_stream_t *in, const char *optstr)\n \t\tjas_logerrorf(\n \t\t  \"maximum number of samples would be exceeded (%zu > %zu)\\n\",\n \t\t  num_samples, opts.max_samples);\n-\t\tgoto error;\n+\tgoto error;\n \t}\n \n \t/* Should I use:\n@@ -217,14 +217,31 @@ jas_image_t *jas_heic_decode(jas_stream_t *in, const char *optstr)\n \t*/\n \n \t/* Decode the image and convert the colorspace to RGB,\n-\t  saved as 24bit interleaved. */\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+ \t  saved as 24bit interleaved. */\n \tstruct heif_error err;\n+\t\n+\t/* Initialize img to NULL to handle potential errors */\n+\timg = NULL;\n+\t\n+\t/* Validate handle parameter before proceeding */\n+\tif (!handle) {\n+\t\tjas_logerrorf(\"Invalid handle parameter\\n\");\n+\t\tgoto error;\n+\t}\n+\t\n \terr = heif_decode_image(handle, &img, heif_colorspace_RGB,\n \t  heif_chroma_interleaved_RGB, 0);\n \tif (err.code != 0) {\n \t\tjas_logerrorf(\"heif_decode_image failed\\n\");\n \t\tgoto error;\n \t}\n+\t\n+\t/* Validate that img was properly initialized by heif_decode_image */\n+\tif (!img) {\n+\t\tjas_logerrorf(\"heif_decode_image returned NULL image\\n\");\n+\t\tgoto error;\n+\t}\n \n \tenum heif_colorspace colorspace = heif_image_get_colorspace(img);\n \tenum heif_chroma chroma = heif_image_get_chroma_format(img);\n"}]