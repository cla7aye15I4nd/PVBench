[{"patch": "diff --git a/mlir/lib/Dialect/Arith/IR/ArithOps.cpp b/mlir/lib/Dialect/Arith/IR/ArithOps.cpp\nindex e9545c3146b2..487aed18e9f3 100644\n--- a/mlir/lib/Dialect/Arith/IR/ArithOps.cpp\n+++ b/mlir/lib/Dialect/Arith/IR/ArithOps.cpp\n@@ -44,8 +44,21 @@ applyToIntegerAttrs(PatternRewriter &builder, Value res, Attribute lhs,\n                     Attribute rhs,\n                     function_ref<APInt(const APInt &, const APInt &)> binFn) {\n   APInt lhsVal = llvm::cast<IntegerAttr>(lhs).getValue();\n-  APInt rhsVal = llvm::cast<IntegerAttr>(rhs).getValue();\n+// FIXME: Crash CWE-681: Incorrect Conversion between Numeric Types\n+   APInt rhsVal = llvm::cast<IntegerAttr>(rhs).getValue();\n   APInt value = binFn(lhsVal, rhsVal);\n+  \n+  // Get the target integer type and its bit width\n+  Type targetType = res.getType();\n+  if (auto intType = llvm::dyn_cast<IntegerType>(targetType)) {\n+    unsigned targetBitWidth = intType.getWidth();\n+    \n+    // Ensure the computed value matches the target bit width\n+    if (value.getBitWidth() != targetBitWidth) {\n+      value = value.trunc(targetBitWidth);\n+    }\n+  }\n+  \n   return IntegerAttr::get(res.getType(), value);\n }\n \n"}]