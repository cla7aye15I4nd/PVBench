[{"patch": "diff --git a/clang/lib/Format/UnwrappedLineParser.cpp b/clang/lib/Format/UnwrappedLineParser.cpp\nindex df58e5ef4d6a..7a4c521f5c78 100644\n--- a/clang/lib/Format/UnwrappedLineParser.cpp\n+++ b/clang/lib/Format/UnwrappedLineParser.cpp\n@@ -1184,9 +1184,14 @@ void UnwrappedLineParser::parsePPDefine() {\n     Line->Level += PPBranchLevel + 1;\n   addUnwrappedLine();\n   ++Line->Level;\n-\n-  Line->PPLevel = PPBranchLevel + (IncludeGuard == IG_Defined ? 0 : 1);\n-  assert((int)Line->PPLevel >= 0);\n+// FIXME: Crash CWE-754: Improper Check for Unusual or Exceptional Conditions\n+ \n+  // Validate PPLevel calculation to prevent underflow\n+  int calculatedPPLevel = PPBranchLevel + (IncludeGuard == IG_Defined ? 0 : 1);\n+  if (calculatedPPLevel < 0) {\n+    calculatedPPLevel = 0;\n+  }\n+  Line->PPLevel = calculatedPPLevel;\n   Line->InMacroBody = true;\n \n   if (Style.SkipMacroDefinitionBody) {\n@@ -1197,7 +1202,6 @@ void UnwrappedLineParser::parsePPDefine() {\n     addUnwrappedLine();\n     return;\n   }\n-\n   // Errors during a preprocessor directive can only affect the layout of the\n   // preprocessor directive, and thus we ignore them. An alternative approach\n   // would be to use the same approach we use on the file level (no\n"}]