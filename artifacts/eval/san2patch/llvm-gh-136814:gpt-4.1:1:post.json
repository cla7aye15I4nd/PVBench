{"patch": "diff --git a/clang/lib/Format/UnwrappedLineParser.cpp b/clang/lib/Format/UnwrappedLineParser.cpp\nindex df58e5ef4d6a..b2cf8ad19721 100644\n--- a/clang/lib/Format/UnwrappedLineParser.cpp\n+++ b/clang/lib/Format/UnwrappedLineParser.cpp\n@@ -1185,7 +1185,12 @@ void UnwrappedLineParser::parsePPDefine() {\n   addUnwrappedLine();\n   ++Line->Level;\n \n+// FIXME: Crash CWE-754: Improper Check for Unusual or Exceptional Conditions\n   Line->PPLevel = PPBranchLevel + (IncludeGuard == IG_Defined ? 0 : 1);\n+  if ((int)Line->PPLevel < 0) {\n+    Line->PPLevel = 0;\n+    // Optionally, log or handle the incident\n+  }\n   assert((int)Line->PPLevel >= 0);\n   Line->InMacroBody = true;\n \n@@ -1197,7 +1202,6 @@ void UnwrappedLineParser::parsePPDefine() {\n     addUnwrappedLine();\n     return;\n   }\n-\n   // Errors during a preprocessor directive can only affect the layout of the\n   // preprocessor directive, and thus we ignore them. An alternative approach\n   // would be to use the same approach we use on the file level (no\n", "result": true}