[{"patch": "diff --git a/mlir/lib/Dialect/MemRef/IR/MemRefOps.cpp b/mlir/lib/Dialect/MemRef/IR/MemRefOps.cpp\nindex cab0ab8d15d5..211bfd93dfa4 100644\n--- a/mlir/lib/Dialect/MemRef/IR/MemRefOps.cpp\n+++ b/mlir/lib/Dialect/MemRef/IR/MemRefOps.cpp\n@@ -461,8 +461,11 @@ struct AllocaScopeHoister : public OpRewritePattern<AllocaScopeOp> {\n \n     // Only apply to if this is this last non-terminator\n     // op in the block (lest lifetime be extended) of a one\n-    // block region\n-    if (!lastNonTerminatorInRegion(op) ||\n+// FIXME: Crash CWE-754: Improper Check for Unusual or Exceptional Conditions\n+     // block region\n+    if (!op->getBlock()->mightHaveTerminator() ||\n+        !lastParentWithoutScope->getBlock()->mightHaveTerminator() ||\n+        !lastNonTerminatorInRegion(op) ||\n         !lastNonTerminatorInRegion(lastParentWithoutScope))\n       return failure();\n \n@@ -470,11 +473,11 @@ struct AllocaScopeHoister : public OpRewritePattern<AllocaScopeOp> {\n                 ->hasTrait<OpTrait::AutomaticAllocationScope>()) {\n       lastParentWithoutScope = lastParentWithoutScope->getParentOp();\n       if (!lastParentWithoutScope ||\n+          !lastParentWithoutScope->getBlock()->mightHaveTerminator() ||\n           !lastNonTerminatorInRegion(lastParentWithoutScope))\n         return failure();\n     }\n-    assert(lastParentWithoutScope->getParentOp()\n-               ->hasTrait<OpTrait::AutomaticAllocationScope>());\n+    assert(lastParentWithoutScope->getParentOp()               ->hasTrait<OpTrait::AutomaticAllocationScope>());\n \n     Region *containingRegion = nullptr;\n     for (auto &r : lastParentWithoutScope->getRegions()) {\n"}]