[{"patch": "diff --git a/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp b/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\nindex bbf1b0fd590e..c3bcc525b3fa 100644\n--- a/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\n+++ b/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\n@@ -7774,7 +7774,6 @@ SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n   NewSDValueDbgMsg(V, \"Creating new node: \", this);\n   return V;\n }\n-\n SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n                               SDValue N1, SDValue N2, SDValue N3) {\n   SDNodeFlags Flags;\n@@ -7782,20 +7781,22 @@ SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n     Flags = Inserter->getFlags();\n   return getNode(Opcode, DL, VT, N1, N2, N3, Flags);\n }\n-\n+// FIXME: Crash CWE-825: Expired Pointer Dereference\n+ \n SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n                               SDValue N1, SDValue N2, SDValue N3,\n                               const SDNodeFlags Flags) {\n-  assert(N1.getOpcode() != ISD::DELETED_NODE &&\n-         N2.getOpcode() != ISD::DELETED_NODE &&\n-         N3.getOpcode() != ISD::DELETED_NODE &&\n-         \"Operand is DELETED_NODE!\");\n+  // Check for expired pointer dereference - validate operands are not deleted\n+  if (N1.getOpcode() == ISD::DELETED_NODE ||\n+      N2.getOpcode() == ISD::DELETED_NODE ||\n+      N3.getOpcode() == ISD::DELETED_NODE) {\n+    return getUNDEF(VT);  // Return UNDEF node instead of crashing\n+  }\n   // Perform various simplifications.\n   switch (Opcode) {\n   case ISD::FMA:\n   case ISD::FMAD: {\n-    assert(VT.isFloatingPoint() && \"This operator only applies to FP types!\");\n-    assert(N1.getValueType() == VT && N2.getValueType() == VT &&\n+    assert(VT.isFloatingPoint() && \"This operator only applies to FP types!\");    assert(N1.getValueType() == VT && N2.getValueType() == VT &&\n            N3.getValueType() == VT && \"FMA types must match!\");\n     ConstantFPSDNode *N1CFP = dyn_cast<ConstantFPSDNode>(N1);\n     ConstantFPSDNode *N2CFP = dyn_cast<ConstantFPSDNode>(N2);\n"}]