[{"patch": "diff --git a/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp b/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\nindex bbf1b0fd590e..d33212b40de6 100644\n--- a/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\n+++ b/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\n@@ -10396,15 +10396,24 @@ SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n     Flags = Inserter->getFlags();\n   return getNode(Opcode, DL, VT, Ops, Flags);\n }\n-\n SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n                               ArrayRef<SDValue> Ops, const SDNodeFlags Flags) {\n   unsigned NumOps = Ops.size();\n+  \n+  // Check for deleted nodes before processing\n+  for (const auto &Op : Ops) {\n+    if (Op.getOpcode() == ISD::DELETED_NODE) {\n+      // Return undef node to handle expired pointer dereference\n+      return getUNDEF(VT);\n+    }\n+  }\n+  \n   switch (NumOps) {\n   case 0: return getNode(Opcode, DL, VT);\n   case 1: return getNode(Opcode, DL, VT, Ops[0], Flags);\n   case 2: return getNode(Opcode, DL, VT, Ops[0], Ops[1], Flags);\n-  case 3: return getNode(Opcode, DL, VT, Ops[0], Ops[1], Ops[2], Flags);\n+// FIXME: Crash CWE-825: Expired Pointer Dereference\n+   case 3: return getNode(Opcode, DL, VT, Ops[0], Ops[1], Ops[2], Flags);\n   default: break;\n   }\n \n@@ -10416,8 +10425,7 @@ SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n \n   switch (Opcode) {\n   default: break;\n-  case ISD::BUILD_VECTOR:\n-    // Attempt to simplify BUILD_VECTOR.\n+  case ISD::BUILD_VECTOR:    // Attempt to simplify BUILD_VECTOR.\n     if (SDValue V = FoldBUILD_VECTOR(DL, VT, Ops, *this))\n       return V;\n     break;\n"}]