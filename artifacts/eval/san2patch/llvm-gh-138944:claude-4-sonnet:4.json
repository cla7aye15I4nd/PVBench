[{"patch": "diff --git a/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp b/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\nindex bbf1b0fd590e..e6bc3de6d225 100644\n--- a/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\n+++ b/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\n@@ -7784,8 +7784,16 @@ SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n }\n \n SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n-                              SDValue N1, SDValue N2, SDValue N3,\n+// FIXME: Crash CWE-825: Expired Pointer Dereference\n+                               SDValue N1, SDValue N2, SDValue N3,\n                               const SDNodeFlags Flags) {\n+  // Check for deleted nodes and return UNDEF if any operand is deleted\n+  if (N1.getOpcode() == ISD::DELETED_NODE ||\n+      N2.getOpcode() == ISD::DELETED_NODE ||\n+      N3.getOpcode() == ISD::DELETED_NODE) {\n+    return getUNDEF(VT);\n+  }\n+  \n   assert(N1.getOpcode() != ISD::DELETED_NODE &&\n          N2.getOpcode() != ISD::DELETED_NODE &&\n          N3.getOpcode() != ISD::DELETED_NODE &&\n@@ -7796,8 +7804,7 @@ SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n   case ISD::FMAD: {\n     assert(VT.isFloatingPoint() && \"This operator only applies to FP types!\");\n     assert(N1.getValueType() == VT && N2.getValueType() == VT &&\n-           N3.getValueType() == VT && \"FMA types must match!\");\n-    ConstantFPSDNode *N1CFP = dyn_cast<ConstantFPSDNode>(N1);\n+           N3.getValueType() == VT && \"FMA types must match!\");    ConstantFPSDNode *N1CFP = dyn_cast<ConstantFPSDNode>(N1);\n     ConstantFPSDNode *N2CFP = dyn_cast<ConstantFPSDNode>(N2);\n     ConstantFPSDNode *N3CFP = dyn_cast<ConstantFPSDNode>(N3);\n     if (N1CFP && N2CFP && N3CFP) {\n"}]