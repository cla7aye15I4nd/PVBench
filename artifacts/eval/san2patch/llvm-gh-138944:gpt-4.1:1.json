[{"patch": "diff --git a/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp b/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\nindex bbf1b0fd590e..0b34a983956b 100644\n--- a/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\n+++ b/llvm/lib/CodeGen/SelectionDAG/SelectionDAG.cpp\n@@ -7786,10 +7786,18 @@ SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n SDValue SelectionDAG::getNode(unsigned Opcode, const SDLoc &DL, EVT VT,\n                               SDValue N1, SDValue N2, SDValue N3,\n                               const SDNodeFlags Flags) {\n+  // Check operands for deleted nodes instead of only asserting.\n+  if (N1.getOpcode() == ISD::DELETED_NODE ||\n+      N2.getOpcode() == ISD::DELETED_NODE ||\n+      N3.getOpcode() == ISD::DELETED_NODE) {\n+    // Return an undefined node to avoid dereferencing expired pointers.\n+    return getUNDEF(VT);\n+  }\n   assert(N1.getOpcode() != ISD::DELETED_NODE &&\n          N2.getOpcode() != ISD::DELETED_NODE &&\n          N3.getOpcode() != ISD::DELETED_NODE &&\n-         \"Operand is DELETED_NODE!\");\n+// FIXME: Crash CWE-825: Expired Pointer Dereference\n+          \"Operand is DELETED_NODE!\");\n   // Perform various simplifications.\n   switch (Opcode) {\n   case ISD::FMA:\n"}]