[{"patch": "diff --git a/clang/lib/Sema/SemaOpenMP.cpp b/clang/lib/Sema/SemaOpenMP.cpp\nindex 50211c5cf3ed..cf94512bc337 100644\n--- a/clang/lib/Sema/SemaOpenMP.cpp\n+++ b/clang/lib/Sema/SemaOpenMP.cpp\n@@ -14911,9 +14911,15 @@ StmtResult SemaOpenMP::ActOnOpenMPUnrollDirective(ArrayRef<OMPClause *> Clauses,\n \n   // Determine the unroll factor.\n   uint64_t Factor;\n-  SourceLocation FactorLoc;\n+// FIXME: Crash CWE-908: Use of Uninitialized Resource\n+   SourceLocation FactorLoc;\n   if (Expr *FactorVal = PartialClause->getFactor()) {\n-    Factor = FactorVal->getIntegerConstantExpr(Context)->getZExtValue();\n+    auto OptICS = FactorVal->getIntegerConstantExpr(Context);\n+    if (!OptICS) {\n+      // Report an error (invalid or undeclared factor)\n+      return StmtError();\n+    }\n+    Factor = OptICS->getZExtValue();\n     FactorLoc = FactorVal->getExprLoc();\n   } else {\n     // TODO: Use a better profitability model.\n@@ -14923,8 +14929,7 @@ StmtResult SemaOpenMP::ActOnOpenMPUnrollDirective(ArrayRef<OMPClause *> Clauses,\n   auto MakeFactorExpr = [this, Factor, IVTy, FactorLoc]() {\n     return IntegerLiteral::Create(\n         getASTContext(), llvm::APInt(getASTContext().getIntWidth(IVTy), Factor),\n-        IVTy, FactorLoc);\n-  };\n+        IVTy, FactorLoc);  };\n \n   // Iteration variable SourceLocations.\n   SourceLocation OrigVarLoc = OrigVar->getExprLoc();\n"}]