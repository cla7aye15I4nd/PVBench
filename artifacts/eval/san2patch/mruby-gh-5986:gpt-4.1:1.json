[{"patch": "diff --git a/src/string.c b/src/string.c\nindex 1bd3f6f8f..38a78a9bd 100644\n--- a/src/string.c\n+++ b/src/string.c\n@@ -2948,7 +2948,15 @@ str_bytesplice(mrb_state *mrb, mrb_value str, mrb_int idx1, mrb_int len1, mrb_va\n {\n   struct RString *s = RSTRING(str);\n   if (RSTR_LEN(s) < idx1 || RSTRING_LEN(replace) < idx2) {\n-    mrb_raise(mrb, E_INDEX_ERROR, \"index out of string\");\n+// FIXME: Crash CWE-190: Integer Overflow or Wraparound\n+     mrb_raise(mrb, E_INDEX_ERROR, \"index out of string\");\n+  }\n+  /* Addition overflow checks: idx1+len1 and idx2+len2 */\n+  if (len1 > 0 && idx1 > MRB_INT_MAX - len1) {\n+    mrb_raise(mrb, E_INDEX_ERROR, \"index and length addition overflow\");\n+  }\n+  if (len2 > 0 && idx2 > MRB_INT_MAX - len2) {\n+    mrb_raise(mrb, E_INDEX_ERROR, \"replace index and length addition overflow\");\n   }\n   if (RSTR_LEN(s) <= idx1+len1) {\n     len1 = RSTR_LEN(s) - idx1;\n@@ -2967,6 +2975,10 @@ str_bytesplice(mrb_state *mrb, mrb_value str, mrb_int idx1, mrb_int len1, mrb_va\n   }\n   else { /* len1 < len2 */\n     mrb_int slen = RSTR_LEN(s);\n+    /* slen+len2-len1 overflow check */\n+    if (len2-len1 > MRB_INT_MAX - slen) {\n+      mrb_raise(mrb, E_INDEX_ERROR, \"string resize overflow\");\n+    }\n     mrb_str_resize(mrb, str, slen+len2-len1);\n     memmove(RSTR_PTR(s)+idx1+len2, RSTR_PTR(s)+idx1+len1, slen-(idx1+len1));\n     memmove(RSTR_PTR(s)+idx1, RSTRING_PTR(replace)+idx2, len2);\n"}]