[{"patch": "diff --git a/Packet++/src/Packet.cpp b/Packet++/src/Packet.cpp\nindex 30a2790f..54698749 100644\n--- a/Packet++/src/Packet.cpp\n+++ b/Packet++/src/Packet.cpp\n@@ -53,6 +53,16 @@ namespace pcpp\n \n \t\tm_FirstLayer = nullptr;\n \t\tm_LastLayer = nullptr;\n+\t\t\n+\t\tif (rawPacket == nullptr)\n+\t\t{\n+\t\t\tm_MaxPacketLen = 0;\n+\t\t\tm_FreeRawPacket = false;\n+\t\t\tm_RawPacket = nullptr;\n+\t\t\tm_CanReallocateData = true;\n+\t\t\treturn;\n+\t\t}\n+\t\t\n \t\tm_MaxPacketLen = rawPacket->getRawDataLen();\n \t\tm_FreeRawPacket = freeRawPacket;\n \t\tm_RawPacket = rawPacket;\n@@ -84,9 +94,14 @@ namespace pcpp\n \n \t\tif (curLayer != nullptr && curLayer->getOsiModelLayer() > parseUntilLayer)\n \t\t{\n-\t\t\tm_LastLayer = curLayer->getPrevLayer();\n-\t\t\tdelete curLayer;\n-\t\t\tm_LastLayer->m_NextLayer = nullptr;\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+ \t\t\tLayer* prevLayer = curLayer->getPrevLayer();\n+\t\t\tif (prevLayer != nullptr)\n+\t\t\t{\n+\t\t\t\tm_LastLayer = prevLayer;\n+\t\t\t\tdelete curLayer;\n+\t\t\t\tm_LastLayer->m_NextLayer = nullptr;\n+\t\t\t}\n \t\t}\n \n \t\tif (m_LastLayer != nullptr && parseUntil == UnknownProtocol && parseUntilLayer == OsiModelLayerUnknown)\n"}]