[{"patch": "diff --git a/Packet++/src/GtpLayer.cpp b/Packet++/src/GtpLayer.cpp\nindex 2e935cf5..f2e59ec9 100644\n--- a/Packet++/src/GtpLayer.cpp\n+++ b/Packet++/src/GtpLayer.cpp\n@@ -398,7 +398,8 @@ namespace pcpp\n \t\t\t// add ext total length to offset\n \t\t\toffsetForNewExtension += lastExt.getTotalLength();\n \t\t}\n-\n+// FIXME: Crash CWE-416: Use After Free\n+ \n \t\t// allocate extension space in layer (assuming extension length can only be 4 bytes)\n \t\tif (!extendLayer(offsetForNewExtension, 4 * sizeof(uint8_t)))\n \t\t{\n@@ -406,6 +407,17 @@ namespace pcpp\n \t\t\treturn {};\n \t\t}\n \n+\t\t// refresh pointers after layer extension\n+\t\theader = getHeader();\n+\t\theaderExtra = getHeaderExtra();\n+\t\tlastExt = getNextExtension();\n+\n+\t\t// re-find the last GTP header extension after buffer reallocation\n+\t\twhile (!lastExt.getNextExtension().isNull())\n+\t\t{\n+\t\t\tlastExt = lastExt.getNextExtension();\n+\t\t}\n+\n \t\t// lastExt != null means layer contains 1 or more extensions\n \t\tif (!lastExt.isNull())\n \t\t{\n"}]