[{"patch": "diff --git a/Packet++/src/GtpLayer.cpp b/Packet++/src/GtpLayer.cpp\nindex 2e935cf5..cffa0ba8 100644\n--- a/Packet++/src/GtpLayer.cpp\n+++ b/Packet++/src/GtpLayer.cpp\n@@ -394,7 +394,8 @@ namespace pcpp\n \n \t\t// lastExt != null means layer contains 1 or more extensions\n \t\tif (!lastExt.isNull())\n-\t\t{\n+// FIXME: Crash CWE-416: Use After Free\n+ \t\t{\n \t\t\t// add ext total length to offset\n \t\t\toffsetForNewExtension += lastExt.getTotalLength();\n \t\t}\n@@ -406,6 +407,11 @@ namespace pcpp\n \t\t\treturn {};\n \t\t}\n \n+\t\t// RECALCULATE POINTERS TO AVOID USE-AFTER-FREE\n+\t\theader = getHeader();\n+\t\theaderExtra = getHeaderExtra();\n+\t\tlastExt = getNextExtension();\n+\n \t\t// lastExt != null means layer contains 1 or more extensions\n \t\tif (!lastExt.isNull())\n \t\t{\n"}]