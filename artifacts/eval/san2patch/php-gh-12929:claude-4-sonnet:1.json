[{"patch": "diff --git a/ext/simplexml/simplexml.c b/ext/simplexml/simplexml.c\nindex ae3c98b7e3e..2429fea4638 100644\n--- a/ext/simplexml/simplexml.c\n+++ b/ext/simplexml/simplexml.c\n@@ -411,28 +411,35 @@ static zval *sxe_prop_dim_write(zend_object *object, zval *member, zval *value,\n \n \t\t\tif (!Z_STRLEN_P(member)) {\n \t\t\t\tzend_value_error(\"Cannot create %s with an empty name\", attribs ? \"attribute\" : \"element\");\n-\t\t\t\tif (member == &tmp_zv) {\n-\t\t\t\t\tzval_ptr_dtor_str(&tmp_zv);\n-\t\t\t\t}\n-\t\t\t\treturn &EG(error_zval);\n+\t\t\tif (member == &tmp_zv) {\n+\t\t\t\tzval_ptr_dtor_str(&tmp_zv);\n \t\t\t}\n+\t\t\treturn &EG(error_zval);\n \t\t}\n \t}\n+}\n \n-\tGET_NODE(sxe, node);\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+GET_NODE(sxe, node);\n \n-\tphp_libxml_invalidate_node_list_cache_from_doc(node->doc);\n+if (!node || !node->doc) {\n+\tif (member == &tmp_zv) {\n+\t\tzval_ptr_dtor_str(&tmp_zv);\n+\t}\n+\treturn &EG(error_zval);\n+}\n \n-\tif (sxe->iter.type == SXE_ITER_ATTRLIST) {\n-\t\tattribs = 1;\n-\t\telements = 0;\n-\t\tnode = php_sxe_get_first_node(sxe, node);\n-\t\tattr = (xmlAttrPtr)node;\n-\t\ttest = sxe->iter.name != NULL;\n-\t} else if (sxe->iter.type != SXE_ITER_CHILD) {\n-\t\tmynode = node;\n-\t\tnode = php_sxe_get_first_node(sxe, node);\n-\t\tattr = node ? node->properties : NULL;\n+php_libxml_invalidate_node_list_cache_from_doc(node->doc);\n+\n+if (sxe->iter.type == SXE_ITER_ATTRLIST) {\n+\tattribs = 1;\n+\telements = 0;\n+\tnode = php_sxe_get_first_node(sxe, node);\n+\tattr = (xmlAttrPtr)node;\n+\ttest = sxe->iter.name != NULL;\n+} else if (sxe->iter.type != SXE_ITER_CHILD) {\n+\tmynode = node;\n+\tnode = php_sxe_get_first_node(sxe, node);\t\tattr = node ? node->properties : NULL;\n \t\ttest = 0;\n \t\tif (!member && node && node->parent &&\n \t\t    node->parent->type == XML_DOCUMENT_NODE) {\n"}]