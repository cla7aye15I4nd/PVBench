[{"patch": "diff --git a/ext/standard/array.c b/ext/standard/array.c\nindex eee260f2243..42b99591661 100644\n--- a/ext/standard/array.c\n+++ b/ext/standard/array.c\n@@ -2959,6 +2959,19 @@ PHP_FUNCTION(range)\n \t\t\tgoto handle_numeric_inputs;\n \t\t}\n \n+\t\t/* Validate string parameters before dereferencing */\n+\t\tif (UNEXPECTED(!user_start || Z_TYPE_P(user_start) != IS_STRING || \n+\t\t\t\t\t  !Z_STRVAL_P(user_start) || Z_STRLEN_P(user_start) == 0)) {\n+\t\t\tphp_error_docref(NULL, E_WARNING, \"Invalid start parameter for character range\");\n+\t\t\tRETURN_FALSE;\n+\t\t}\n+\t\t\n+\t\tif (UNEXPECTED(!user_end || Z_TYPE_P(user_end) != IS_STRING || \n+\t\t\t\t\t  !Z_STRVAL_P(user_end) || Z_STRLEN_P(user_end) == 0)) {\n+\t\t\tphp_error_docref(NULL, E_WARNING, \"Invalid end parameter for character range\");\n+\t\t\tRETURN_FALSE;\n+\t\t}\n+ \n \t\t/* Generate array of characters */\n \t\tunsigned char low = (unsigned char)Z_STRVAL_P(user_start)[0];\n \t\tunsigned char high = (unsigned char)Z_STRVAL_P(user_end)[0];\n"}]