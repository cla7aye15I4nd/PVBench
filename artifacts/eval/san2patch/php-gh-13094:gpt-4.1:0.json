[{"patch": "diff --git a/ext/standard/array.c b/ext/standard/array.c\nindex eee260f2243..90a36d8951c 100644\n--- a/ext/standard/array.c\n+++ b/ext/standard/array.c\n@@ -2958,7 +2958,13 @@ PHP_FUNCTION(range)\n \t\t\tstart_type = IS_LONG;\n \t\t\tgoto handle_numeric_inputs;\n \t\t}\n-\n+// FIXME: Crash CWE-824: Access of Uninitialized Pointer\n+\t\t/* Ensure user_start and user_end are valid strings with at least 1 char */\n+\t\tif (!user_start || Z_TYPE_P(user_start) != IS_STRING || Z_STRLEN_P(user_start) < 1 ||\n+\t\t    !user_end || Z_TYPE_P(user_end) != IS_STRING || Z_STRLEN_P(user_end) < 1) {\n+\t\t\tphp_error_docref(NULL, E_WARNING, \"Both $start and $end must be non-empty strings\");\n+\t\t\tRETURN_FALSE;\n+\t\t}\n \t\t/* Generate array of characters */\n \t\tunsigned char low = (unsigned char)Z_STRVAL_P(user_start)[0];\n \t\tunsigned char high = (unsigned char)Z_STRVAL_P(user_end)[0];\n@@ -3006,6 +3012,7 @@ PHP_FUNCTION(range)\n \t\treturn;\n \t}\n \n+\n \thandle_numeric_inputs:\n \tif (start_type == IS_DOUBLE || end_type == IS_DOUBLE || is_step_double) {\n \t\tdouble element;\n"}]