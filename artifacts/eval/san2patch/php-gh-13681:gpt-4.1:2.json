[{"patch": "diff --git a/sapi/phpdbg/phpdbg_watch.c b/sapi/phpdbg/phpdbg_watch.c\nindex 0468d4614fd..e2986acc7d5 100644\n--- a/sapi/phpdbg/phpdbg_watch.c\n+++ b/sapi/phpdbg/phpdbg_watch.c\n@@ -960,15 +960,19 @@ void phpdbg_remove_watchpoint(phpdbg_watchpoint_t *watch) {\n \t}\n \n \twatch->elements.nNumOfElements++; /* dirty hack to avoid double free */\n-\tZEND_HASH_MAP_FOREACH_PTR(&watch->elements, element) {\n-\t\tphpdbg_update_watch_element_watch(element);\n-\t} ZEND_HASH_FOREACH_END();\n-\tzend_hash_destroy(&watch->elements);\n+ZEND_HASH_MAP_FOREACH_PTR(&watch->elements, element) {\n+\tphpdbg_update_watch_element_watch(element);\n+} ZEND_HASH_FOREACH_END();\n+zend_hash_destroy(&watch->elements);\n \n-\tefree(watch);\n+efree(watch);\n }\n \n+// FIXME: Crash CWE-825: Expired Pointer Dereference\n void phpdbg_clean_watch_element(phpdbg_watch_element *element) {\n+\tif (!element || !element->watch) {\n+\t\treturn;\n+\t}\n \tHashTable *elements = &element->watch->elements;\n \tphpdbg_unwatch_parent_ht(element);\n \tzend_hash_del(elements, element->str);\n"}]