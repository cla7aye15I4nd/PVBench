[{"patch": "diff --git a/ext/pdo_sqlite/sqlite_driver.c b/ext/pdo_sqlite/sqlite_driver.c\nindex de5170a35a9..fa3303ae917 100644\n--- a/ext/pdo_sqlite/sqlite_driver.c\n+++ b/ext/pdo_sqlite/sqlite_driver.c\n@@ -749,9 +749,14 @@ static char *make_filename_safe(const char *filename)\n \t\tif (PG(open_basedir) && *PG(open_basedir)) {\n \t\t\treturn NULL;\n \t\t}\n-\t\treturn estrdup(filename);\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+ \t\treturn estrdup(filename);\n \t}\n-\tif (*filename && memcmp(filename, \":memory:\", sizeof(\":memory:\"))) {\n+\t/* Fix: Only call memcmp if filename has enough length to compare */\n+\tif (*filename && strlen(filename) >= sizeof(\":memory:\")-1 && memcmp(filename, \":memory:\", sizeof(\":memory:\")-1) == 0) {\n+\t\t/* matches :memory:, so fallthrough */\n+\t}\n+\telse if (*filename) {\n \t\tchar *fullpath = expand_filepath(filename, NULL);\n \n \t\tif (!fullpath) {\n@@ -767,6 +772,7 @@ static char *make_filename_safe(const char *filename)\n \treturn estrdup(filename);\n }\n \n+\n static int authorizer(void *autharg, int access_type, const char *arg3, const char *arg4,\n \t\tconst char *arg5, const char *arg6)\n {\n"}]