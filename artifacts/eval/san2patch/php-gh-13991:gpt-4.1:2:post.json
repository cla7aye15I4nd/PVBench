{"patch": "diff --git a/ext/pdo_sqlite/sqlite_driver.c b/ext/pdo_sqlite/sqlite_driver.c\nindex de5170a35a9..c8cd3a741ea 100644\n--- a/ext/pdo_sqlite/sqlite_driver.c\n+++ b/ext/pdo_sqlite/sqlite_driver.c\n@@ -751,7 +751,9 @@ static char *make_filename_safe(const char *filename)\n \t\t}\n \t\treturn estrdup(filename);\n \t}\n-\tif (*filename && memcmp(filename, \":memory:\", sizeof(\":memory:\"))) {\n+\t/* Ensure filename is at least as long as \":memory:\" before memcmp */\n+\tsize_t filename_len = strlen(filename);\n+\tif (*filename && filename_len >= sizeof(\":memory:\") - 1 && memcmp(filename, \":memory:\", sizeof(\":memory:\") - 1)) {\n \t\tchar *fullpath = expand_filepath(filename, NULL);\n \n \t\tif (!fullpath) {\n", "result": true}