{"patch": "diff --git a/Zend/zend_smart_str.h b/Zend/zend_smart_str.h\nindex affbb5c50ac..8d32b8f2b48 100644\n--- a/Zend/zend_smart_str.h\n+++ b/Zend/zend_smart_str.h\n@@ -170,11 +170,12 @@ static zend_always_inline void smart_str_appendl(smart_str *dest, const char *sr\n }\n static zend_always_inline void smart_str_appends_ex(smart_str *dest, const char *src, bool persistent)\n {\n-\tsmart_str_appendl_ex(dest, src, strlen(src), persistent);\n+\tsmart_str_appendl_ex(dest, src, src ? strlen(src) : 0, persistent);\n }\n-static zend_always_inline void smart_str_appends(smart_str *dest, const char *src)\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+ static zend_always_inline void smart_str_appends(smart_str *dest, const char *src)\n {\n-\tsmart_str_appendl_ex(dest, src, strlen(src), false);\n+\tsmart_str_appendl_ex(dest, src, src ? strlen(src) : 0, false);\n }\n static zend_always_inline void smart_str_append(smart_str *dest, const zend_string *src)\n {\n", "result": true}