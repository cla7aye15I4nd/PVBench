[{"patch": "diff --git a/ext/standard/url_scanner_ex.re b/ext/standard/url_scanner_ex.re\nindex 77b4d79793b..e9c3a7e64a3 100644\n--- a/ext/standard/url_scanner_ex.re\n+++ b/ext/standard/url_scanner_ex.re\n@@ -719,11 +719,18 @@ static inline void php_url_scanner_session_handler_impl(char *output, size_t out\n \n static void php_url_scanner_session_handler(char *output, size_t output_len, char **handled_output, size_t *handled_output_len, int mode)\n {\n+\tif (handled_output == NULL || handled_output_len == NULL) {\n+\t\treturn;\n+\t}\n \tphp_url_scanner_session_handler_impl(output, output_len, handled_output, handled_output_len, mode, 1);\n }\n-\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+ \n static void php_url_scanner_output_handler(char *output, size_t output_len, char **handled_output, size_t *handled_output_len, int mode)\n {\n+\tif (handled_output == NULL || handled_output_len == NULL) {\n+\t\treturn;\n+\t}\n \tphp_url_scanner_session_handler_impl(output, output_len, handled_output, handled_output_len, mode, 0);\n }\n \n@@ -733,8 +740,7 @@ static inline int php_url_scanner_add_var_impl(const char *name, size_t name_len\n \tsmart_str svalue = {0};\n \tsmart_str hname = {0};\n \tsmart_str hvalue = {0};\n-\tzend_string *encoded;\n-\turl_adapt_state_ex_t *url_state;\n+\tzend_string *encoded;\turl_adapt_state_ex_t *url_state;\n \tphp_output_handler_func_t handler;\n \n \tif (type) {\n"}]