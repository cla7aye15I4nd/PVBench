[{"patch": "diff --git a/ext/standard/scanf.c b/ext/standard/scanf.c\nindex 78ecc1642cf..36d56b39e27 100644\n--- a/ext/standard/scanf.c\n+++ b/ext/standard/scanf.c\n@@ -505,7 +505,9 @@ PHPAPI int ValidateFormat(char *format, int numVars, int *totalSubs)\n \t\t\t\t\tnassign[i] = 0;\n \t\t\t\t}\n \t\t\t}\n-\t\t\tnassign[objIndex]++;\n+\t\t\tif (objIndex >= 0 && objIndex < nspace) {\n+\t\t\t\tnassign[objIndex]++;\n+\t\t\t}\n \t\t\tobjIndex++;\n \t\t}\n \t} /* while (*format != '\\0') */\n"}]