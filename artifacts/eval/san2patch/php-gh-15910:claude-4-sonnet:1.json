[{"patch": "diff --git a/ext/dom/element.c b/ext/dom/element.c\nindex b4495559830..406e0e5c945 100644\n--- a/ext/dom/element.c\n+++ b/ext/dom/element.c\n@@ -690,6 +690,16 @@ static void dom_element_set_attribute_node_common(INTERNAL_FUNCTION_PARAMETERS,\n \tDOM_GET_OBJ(nodep, id, xmlNodePtr, intern);\n \tDOM_GET_OBJ(attrp, node, xmlAttrPtr, attrobj);\n \n+\t/* Comprehensive validation of attribute node */\n+\tif (attrp == NULL || attrp->name == NULL) {\n+\t\tphp_dom_throw_error(INVALID_ACCESS_ERR, dom_get_strict_error(intern->document));\n+\t\tif (modern) {\n+\t\t\tRETURN_THROWS();\n+\t\t} else {\n+\t\t\tRETURN_FALSE;\n+\t\t}\n+\t}\n+\n \t/* ZPP Guarantees that a DOMAttr class is given, as it is converted to a xmlAttr\n \t * to pass to libxml (see http://www.xmlsoft.org/html/libxml-tree.html#xmlAttr)\n \t * if it is not of type XML_ATTRIBUTE_NODE it indicates a bug somewhere */\n@@ -710,7 +720,8 @@ static void dom_element_set_attribute_node_common(INTERNAL_FUNCTION_PARAMETERS,\n \t\t}\n \t}\n \n-\tnsp = attrp->ns;\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+ \tnsp = attrp->ns;\n \tif (use_ns && nsp != NULL) {\n \t\texistattrp = xmlHasNsProp(nodep, attrp->name, nsp->href);\n \t} else {\n"}]