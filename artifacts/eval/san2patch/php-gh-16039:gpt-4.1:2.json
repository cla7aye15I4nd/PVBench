[{"patch": "diff --git a/ext/dom/parentnode.c b/ext/dom/parentnode.c\nindex c30db6fcd74..d9a84bdf89f 100644\n--- a/ext/dom/parentnode.c\n+++ b/ext/dom/parentnode.c\n@@ -270,8 +270,12 @@ static zend_result dom_sanity_check_node_list_for_insertion(php_libxml_ref_obj *\n \t\t\tconst zend_class_entry *ce = Z_OBJCE(nodes[i]);\n \n \t\t\tif (instanceof_function(ce, dom_node_class_entry)) {\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n \t\t\t\txmlNodePtr node = dom_object_get_node(Z_DOMOBJ_P(nodes + i));\n-\n+\t\t\t\tif (node == NULL) {\n+\t\t\t\t\tphp_dom_throw_error(INVALID_STATE_ERR, dom_get_strict_error(document));\n+\t\t\t\t\treturn FAILURE;\n+\t\t\t\t}\n \t\t\t\tif (node->doc != documentNode) {\n \t\t\t\t\tphp_dom_throw_error(WRONG_DOCUMENT_ERR, dom_get_strict_error(document));\n \t\t\t\t\treturn FAILURE;\n@@ -289,6 +293,7 @@ static zend_result dom_sanity_check_node_list_for_insertion(php_libxml_ref_obj *\n \t\t\tzend_argument_type_error(i + 1, \"must be of type DOMNode|string, %s given\", zend_zval_type_name(&nodes[i]));\n \t\t\treturn FAILURE;\n \t\t}\n+\n \t}\n \n \treturn SUCCESS;\n"}]