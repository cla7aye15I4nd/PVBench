[{"patch": "diff --git a/ext/dom/element.c b/ext/dom/element.c\nindex 46f1100a767..87df5d8b443 100644\n--- a/ext/dom/element.c\n+++ b/ext/dom/element.c\n@@ -329,18 +329,21 @@ PHP_METHOD(DOMElement, getAttributeNames)\n \n \tif (zend_parse_parameters_none() == FAILURE) {\n \t\tRETURN_THROWS();\n-\t}\n+}\n \n-\tDOM_GET_THIS_OBJ(nodep, id, xmlNodePtr, unused_intern);\n+DOM_GET_THIS_OBJ(nodep, id, xmlNodePtr, unused_intern);\n \n-\tarray_init(return_value);\n-\tHashTable *ht = Z_ARRVAL_P(return_value);\n-\tzend_hash_real_init_packed(ht);\n+array_init(return_value);\n+HashTable *ht = Z_ARRVAL_P(return_value);\n+zend_hash_real_init_packed(ht);\n \n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n \tfor (xmlNsPtr nsptr = nodep->nsDef; nsptr; nsptr = nsptr->next) {\n \t\tconst char *prefix = (const char *) nsptr->prefix;\n-\t\tZVAL_STR(&tmp, dom_node_concatenated_name_helper(strlen(prefix), prefix, strlen(\"xmlns\"), (const char *) \"xmlns\"));\n-\t\tzend_hash_next_index_insert(ht, &tmp);\n+        if (prefix != NULL) {\n+            ZVAL_STR(&tmp, dom_node_concatenated_name_helper(strlen(prefix), prefix, strlen(\"xmlns\"), (const char *) \"xmlns\"));\n+            zend_hash_next_index_insert(ht, &tmp);\n+        }\n \t}\n \n \tfor (xmlAttrPtr attr = nodep->properties; attr; attr = attr->next) {\n@@ -349,7 +352,6 @@ PHP_METHOD(DOMElement, getAttributeNames)\n \t}\n }\n /* }}} end DOMElement::getAttributeNames() */\n-\n static xmlNodePtr dom_create_attribute(xmlNodePtr nodep, const char *name, const char* value)\n {\n \tif (xmlStrEqual((xmlChar *)name, (xmlChar *)\"xmlns\")) {\n"}]