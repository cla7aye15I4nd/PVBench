[{"patch": "diff --git a/ext/dom/php_dom.c b/ext/dom/php_dom.c\nindex 939c1794520..7c76b31cbf0 100644\n--- a/ext/dom/php_dom.c\n+++ b/ext/dom/php_dom.c\n@@ -1480,9 +1480,10 @@ void dom_namednode_iter(dom_object *basenode, int ntype, dom_object *intern, xml\n \t\t\tmapptr->local = xmlCharStrndup(local, len);\n \t\t\tmapptr->free_local = true;\n \t\t}\n-\t\tmapptr->local_lower = BAD_CAST estrdup(local);\n+\t\tmapptr->local_lower = BAD_CAST estrndup(local, (len < 0) ? strlen(local) : len);\n \t\tif (len < 0) {\n-\t\t\tzend_str_tolower((char *) mapptr->local_lower, strlen((const char *) mapptr->local_lower));\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+ \t\t\tzend_str_tolower((char *) mapptr->local_lower, strlen((const char *) mapptr->local_lower));\n \t\t} else {\n \t\t\tzend_str_tolower((char *) mapptr->local_lower, len);\n \t\t}\n"}]