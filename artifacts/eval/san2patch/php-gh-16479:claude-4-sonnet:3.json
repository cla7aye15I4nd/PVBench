[{"patch": "diff --git a/ext/spl/spl_observer.c b/ext/spl/spl_observer.c\nindex 21b19cffa38..0018d5998a3 100644\n--- a/ext/spl/spl_observer.c\n+++ b/ext/spl/spl_observer.c\n@@ -744,9 +744,16 @@ PHP_METHOD(SplObjectStorage, setInfo)\n \t}\n \n \tif ((element = zend_hash_get_current_data_ptr_ex(&intern->storage, &intern->pos)) == NULL) {\n-\t\tRETURN_NULL();\n-\t}\n-\tzval_ptr_dtor(&element->inf);\n+// FIXME: Crash CWE-416: Use After Free\n+ \t\tRETURN_NULL();\n+\t}\n+\t\n+\t// Create a temporary copy of the element->inf and safely clear the original\n+\tzval temp_inf;\n+\tZVAL_COPY(&temp_inf, &element->inf);\n+\tZVAL_UNDEF(&element->inf);\n+\tzval_ptr_dtor(&temp_inf);\n+\t\n \tZVAL_COPY(&element->inf, inf);\n } /* }}} */\n \n@@ -756,8 +763,7 @@ PHP_METHOD(SplObjectStorage, next)\n \tspl_SplObjectStorage *intern = Z_SPLOBJSTORAGE_P(ZEND_THIS);\n \n \tif (zend_parse_parameters_none() == FAILURE) {\n-\t\tRETURN_THROWS();\n-\t}\n+\t\tRETURN_THROWS();\t}\n \n \tzend_hash_move_forward_ex(&intern->storage, &intern->pos);\n \tintern->index++;\n"}]