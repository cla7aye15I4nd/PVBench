[{"patch": "diff --git a/ext/spl/spl_observer.c b/ext/spl/spl_observer.c\nindex cc2956ccc27..5c366e11cf1 100644\n--- a/ext/spl/spl_observer.c\n+++ b/ext/spl/spl_observer.c\n@@ -797,8 +797,17 @@ PHP_METHOD(SplObjectStorage, serialize)\n \t\t\tRETURN_NULL();\n \t\t}\n \t\tZVAL_OBJ(&obj, element->obj);\n-\t\tphp_var_serialize(&buf, &obj, &var_hash);\n+\t\tif (Z_OBJ(obj) == NULL) {\n+\t\t\tzend_hash_move_forward_ex(&intern->storage, &pos);\n+\t\t\tcontinue;\n+\t\t}\n+// FIXME: Crash CWE-416: Use After Free\n+ \t\tphp_var_serialize(&buf, &obj, &var_hash);\n \t\tsmart_str_appendc(&buf, ',');\n+\t\tif ((element = zend_hash_get_current_data_ptr_ex(&intern->storage, &pos)) == NULL) {\n+\t\t\tzend_hash_move_forward_ex(&intern->storage, &pos);\n+\t\t\tcontinue;\n+\t\t}\n \t\tphp_var_serialize(&buf, &element->inf, &var_hash);\n \t\tsmart_str_appendc(&buf, ';');\n \t\tzend_hash_move_forward_ex(&intern->storage, &pos);\n"}]