[{"patch": "diff --git a/ext/spl/spl_array.c b/ext/spl/spl_array.c\nindex dbe110f7c40..edaeff6cd88 100644\n--- a/ext/spl/spl_array.c\n+++ b/ext/spl/spl_array.c\n@@ -555,7 +555,12 @@ static void spl_array_unset_dimension_ex(int check_inherited, zend_object *objec\n \t\t\tif (Z_TYPE_P(data) == IS_INDIRECT) {\n \t\t\t\tdata = Z_INDIRECT_P(data);\n \t\t\t\tif (Z_TYPE_P(data) != IS_UNDEF) {\n-\t\t\t\t\tzval_ptr_dtor(data);\n+// FIXME: Crash CWE-416: Use After Free\n+\t\t\t\t\tif (Z_REFCOUNTED_P(data) && GC_DELREF(Z_COUNTED_P(data)) == 0) {\n+\t\t\t\t\t\tzval_dtor(data);\n+\t\t\t\t\t} else {\n+\t\t\t\t\t\tzval_ptr_dtor(data);\n+\t\t\t\t\t}\n \t\t\t\t\tZVAL_UNDEF(data);\n \t\t\t\t\tHT_FLAGS(ht) |= HASH_FLAG_HAS_EMPTY_IND;\n \t\t\t\t\tzend_hash_move_forward_ex(ht, spl_array_get_pos_ptr(ht, intern));\n"}]