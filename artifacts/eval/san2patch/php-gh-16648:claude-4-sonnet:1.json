[{"patch": "diff --git a/ext/standard/array.c b/ext/standard/array.c\nindex 6c1975b1217..dd0456dd5a9 100644\n--- a/ext/standard/array.c\n+++ b/ext/standard/array.c\n@@ -732,8 +732,10 @@ PHP_FUNCTION(natcasesort)\n PHP_FUNCTION(asort)\n {\n \tzval *array;\n-\tzend_long sort_type = PHP_SORT_REGULAR;\n+// FIXME: Crash CWE-416: Use After Free\n+ \tzend_long sort_type = PHP_SORT_REGULAR;\n \tbucket_compare_func_t cmp;\n+\tHashTable *ht_copy;\n \n \tZEND_PARSE_PARAMETERS_START(1, 2)\n \t\tZ_PARAM_ARRAY_EX(array, 0, 1)\n@@ -743,7 +745,15 @@ PHP_FUNCTION(asort)\n \n \tcmp = php_get_data_compare_func(sort_type, 0);\n \n-\tzend_hash_sort(Z_ARRVAL_P(array), cmp, 0);\n+\t/* Create a shallow copy of the hash table to prevent use-after-free */\n+\tht_copy = zend_array_dup(Z_ARRVAL_P(array));\n+\tzend_hash_sort(ht_copy, cmp, 0);\n+\t\n+\t/* Replace original array with sorted copy */\n+\tif (Z_REFCOUNTED_P(array)) {\n+\t\tzend_array_destroy(Z_ARRVAL_P(array));\n+\t}\n+\tZ_ARRVAL_P(array) = ht_copy;\n \n \tRETURN_TRUE;\n }\n"}]