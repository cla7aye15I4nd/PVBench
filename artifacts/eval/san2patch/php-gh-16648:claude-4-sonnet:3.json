[{"patch": "diff --git a/ext/standard/array.c b/ext/standard/array.c\nindex 6c1975b1217..05e0c0df04a 100644\n--- a/ext/standard/array.c\n+++ b/ext/standard/array.c\n@@ -743,10 +743,17 @@ PHP_FUNCTION(asort)\n \n \tcmp = php_get_data_compare_func(sort_type, 0);\n \n-\tzend_hash_sort(Z_ARRVAL_P(array), cmp, 0);\n+\t/* Create immutable snapshot of array for safe sorting */\n+\tHashTable *ht_copy = zend_array_dup(Z_ARRVAL_P(array));\n+\tzend_hash_sort(ht_copy, cmp, 0);\n+\t\n+\t/* Replace original array with sorted copy */\n+\tzend_array_destroy(Z_ARRVAL_P(array));\n+\tZ_ARRVAL_P(array) = ht_copy;\n \n \tRETURN_TRUE;\n-}\n+// FIXME: Crash CWE-416: Use After Free\n+ }\n /* }}} */\n \n /* {{{ Sort an array in reverse order and maintain index association */\n@@ -758,8 +765,7 @@ PHP_FUNCTION(arsort)\n \n \tZEND_PARSE_PARAMETERS_START(1, 2)\n \t\tZ_PARAM_ARRAY_EX(array, 0, 1)\n-\t\tZ_PARAM_OPTIONAL\n-\t\tZ_PARAM_LONG(sort_type)\n+\t\tZ_PARAM_OPTIONAL\t\tZ_PARAM_LONG(sort_type)\n \tZEND_PARSE_PARAMETERS_END();\n \n \tcmp = php_get_data_compare_func(sort_type, 1);\n"}]