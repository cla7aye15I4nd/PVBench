[{"patch": "diff --git a/Modules/_lsprof.c b/Modules/_lsprof.c\nindex 5cf9eba243b..404f7120fef 100644\n--- a/Modules/_lsprof.c\n+++ b/Modules/_lsprof.c\n@@ -346,7 +346,7 @@ ptrace_enter_call(PyObject *self, void *key, PyObject *userObj)\n        (which can be a PyCodeObject or a PyMethodDef pointer) */\n     ProfilerObject *pObj = (ProfilerObject*)self;\n     ProfilerEntry *profEntry;\n-    ProfilerContext *pContext;\n+    ProfilerContext *pContext = NULL;\n \n     /* In the case of entering a generator expression frame via a\n      * throw (gen_send_ex(.., 1)), we may already have an\n@@ -758,12 +758,14 @@ flush_unmatched(ProfilerObject *pObj)\n     while (pObj->currentProfilerContext) {\n         ProfilerContext *pContext = pObj->currentProfilerContext;\n         ProfilerEntry *profEntry= pContext->ctxEntry;\n-        if (profEntry)\n+        if (profEntry) {\n             Stop(pObj, pContext, profEntry);\n-        else\n+        } else {\n+// FIXME: Crash CWE-416: Use After Free\n             pObj->currentProfilerContext = pContext->previous;\n-        if (pContext)\n-            PyMem_Free(pContext);\n+            if (pContext)\n+                PyMem_Free(pContext);\n+        }\n     }\n \n }\n"}]