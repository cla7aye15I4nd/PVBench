[{"patch": "diff --git a/Modules/_cursesmodule.c b/Modules/_cursesmodule.c\nindex ece6b13c788..6f48fe80e84 100644\n--- a/Modules/_cursesmodule.c\n+++ b/Modules/_cursesmodule.c\n@@ -3364,8 +3364,15 @@ _curses_initscr_impl(PyObject *module)\n /*[clinic end generated code: output=619fb68443810b7b input=514f4bce1821f6b5]*/\n {\n     WINDOW *win;\n-\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+ \n     if (curses_initscr_called) {\n+        /* Validate curses state before accessing stdscr */\n+        if (stdscr == NULL || getmaxy(stdscr) <= 0 || getmaxx(stdscr) <= 0) {\n+            _cursesmodule_state *state = get_cursesmodule_state(module);\n+            PyErr_SetString(state->error, \"invalid curses state detected\");\n+            return NULL;\n+        }\n         wrefresh(stdscr);\n         return (PyObject *)PyCursesWindow_New(stdscr, NULL);\n     }\n@@ -3377,7 +3384,6 @@ _curses_initscr_impl(PyObject *module)\n         PyErr_SetString(state->error, catchall_NULL);\n         return NULL;\n     }\n-\n     curses_initscr_called = curses_setupterm_called = TRUE;\n \n     PyObject *module_dict = PyModule_GetDict(module); // borrowed\n"}]