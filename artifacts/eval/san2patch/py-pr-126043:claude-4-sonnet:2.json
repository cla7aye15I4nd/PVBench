[{"patch": "diff --git a/Modules/_asynciomodule.c b/Modules/_asynciomodule.c\nindex 18dc2859357..e163c01f519 100644\n--- a/Modules/_asynciomodule.c\n+++ b/Modules/_asynciomodule.c\n@@ -291,6 +291,10 @@ call_soon(asyncio_state *state, PyObject *loop, PyObject *func, PyObject *arg,\n {\n     PyObject *handle;\n \n+    // Add reference protection for function and context to prevent use-after-free\n+    Py_XINCREF(func);\n+    Py_XINCREF(ctx);\n+\n     if (ctx == NULL) {\n         PyObject *stack[] = {loop, func, arg};\n         size_t nargsf = 3 | PY_VECTORCALL_ARGUMENTS_OFFSET;\n@@ -299,7 +303,7 @@ call_soon(asyncio_state *state, PyObject *loop, PyObject *func, PyObject *arg,\n     else {\n         /* All refs in 'stack' are borrowed. */\n         PyObject *stack[4];\n-        size_t nargs = 2;\n+         size_t nargs = 2;\n         stack[0] = loop;\n         stack[1] = func;\n         if (arg != NULL) {\n@@ -312,6 +316,10 @@ call_soon(asyncio_state *state, PyObject *loop, PyObject *func, PyObject *arg,\n                                            state->context_kwname);\n     }\n \n+    // Release references before checking result\n+    Py_XDECREF(func);\n+    Py_XDECREF(ctx);\n+\n     if (handle == NULL) {\n         return -1;\n     }\n"}]