[{"patch": "diff --git a/Modules/_ctypes/stgdict.c b/Modules/_ctypes/stgdict.c\nindex ad82e4891c5..22167e84e6d 100644\n--- a/Modules/_ctypes/stgdict.c\n+++ b/Modules/_ctypes/stgdict.c\n@@ -568,7 +568,12 @@ PyCStructUnionType_update_stginfo(PyObject *type, PyObject *fields, int isStruct\n     if (!isStruct) {\n         size = union_size;\n     }\n-\n+ \n+    /* Ensure total_align is non-zero before division to prevent divide by zero */\n+    if (total_align == 0) {\n+        total_align = 1;\n+    }\n+    \n     /* Adjust the size according to the alignment requirements */\n     aligned_size = ((size + total_align - 1) / total_align) * total_align;\n \n@@ -580,8 +585,7 @@ PyCStructUnionType_update_stginfo(PyObject *type, PyObject *fields, int isStruct\n         padding = aligned_size - size;\n         if (padding > 0) {\n             ptr = stginfo->format;\n-            stginfo->format = _ctypes_alloc_format_padding(ptr, padding);\n-            PyMem_Free(ptr);\n+            stginfo->format = _ctypes_alloc_format_padding(ptr, padding);            PyMem_Free(ptr);\n             if (stginfo->format == NULL) {\n                 return -1;\n             }\n"}]