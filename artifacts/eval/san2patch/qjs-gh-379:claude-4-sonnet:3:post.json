{"patch": "diff --git a/quickjs.c b/quickjs.c\nindex 46e124a..c0c18d6 100644\n--- a/quickjs.c\n+++ b/quickjs.c\n@@ -50325,11 +50325,27 @@ static JSValue js_typed_array_slice(JSContext *ctx, JSValue this_val,\n \n         p1 = get_typed_array(ctx, arr, 0);\n         if (p1 != NULL && p->class_id == p1->class_id &&\n-            typed_array_get_length(ctx, p1) >= count &&\n+// FIXME: Crash CWE-119: Buffer Overflow\n+             typed_array_get_length(ctx, p1) >= count &&\n             typed_array_get_length(ctx, p) >= start + count) {\n-            memcpy(p1->u.array.u.uint8_ptr,\n-                   p->u.array.u.uint8_ptr + (start << shift),\n-                   count << shift);\n+            uint8_t *src = p->u.array.u.uint8_ptr + (start << shift);\n+            uint8_t *dest = p1->u.array.u.uint8_ptr;\n+            size_t size = count << shift;\n+            \n+            // Check for memory overlap to prevent buffer overflow\n+            if (dest < src + size && src < dest + size) {\n+                // Use element-by-element copy for overlapping regions\n+                for (n = 0; n < count; n++) {\n+                    val = JS_GetPropertyValue(ctx, this_val, js_int32(start + n));\n+                    if (JS_IsException(val))\n+                        goto exception;\n+                    if (JS_SetPropertyValue(ctx, arr, js_int32(n), val,\n+                                            JS_PROP_THROW) < 0)\n+                        goto exception;\n+                }\n+            } else {\n+                memcpy(dest, src, size);\n+            }\n         } else {\n             for (n = 0; n < count; n++) {\n                 val = JS_GetPropertyValue(ctx, this_val, js_int32(start + n));\n", "result": false, "error": "\n        ===========Message===========\n            Return code 2\n        ===========Command===========\n            [PosixPath('/testcases/common/test.sh')]\n        ===========CWD===========\n            /tmp/qjs-gh-379/post_function\n        ===========STDOUT===========\n            cmake -B build -DCMAKE_BUILD_TYPE=RelWithDebInfo\n-- The C compiler identification is GNU 13.3.0\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Check for working C compiler: /usr/bin/cc - skipped\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Building in RelWithDebInfo mode\n-- Building with GNU 13.3.0 on Linux-5.15.0-130-generic\n-- Performing Test COMPILER_SUPPORTS_Wall\n-- Performing Test COMPILER_SUPPORTS_Wall - Success\n-- Performing Test COMPILER_SUPPORTS_Werror\n-- Performing Test COMPILER_SUPPORTS_Werror - Success\n-- Performing Test COMPILER_SUPPORTS_Wextra\n-- Performing Test COMPILER_SUPPORTS_Wextra - Success\n-- Performing Test COMPILER_SUPPORTS_Wnoimplicitfallthrough\n-- Performing Test COMPILER_SUPPORTS_Wnoimplicitfallthrough - Success\n-- Performing Test COMPILER_SUPPORTS_Wnosigncompare\n-- Performing Test COMPILER_SUPPORTS_Wnosigncompare - Success\n-- Performing Test COMPILER_SUPPORTS_Wnomissingfieldinitializers\n-- Performing Test COMPILER_SUPPORTS_Wnomissingfieldinitializers - Success\n-- Performing Test COMPILER_SUPPORTS_Wnounusedparameter\n-- Performing Test COMPILER_SUPPORTS_Wnounusedparameter - Success\n-- Performing Test COMPILER_SUPPORTS_Wnounusedvariable\n-- Performing Test COMPILER_SUPPORTS_Wnounusedvariable - Success\n-- Performing Test COMPILER_SUPPORTS_Wnounusedbutsetvariable\n-- Performing Test COMPILER_SUPPORTS_Wnounusedbutsetvariable - Success\n-- Performing Test COMPILER_SUPPORTS_Wnoarraybounds\n-- Performing Test COMPILER_SUPPORTS_Wnoarraybounds - Success\n-- Performing Test COMPILER_SUPPORTS_Wnoformattruncation\n-- Performing Test COMPILER_SUPPORTS_Wnoformattruncation - Success\n-- Performing Test COMPILER_SUPPORTS_funsignedchar\n-- Performing Test COMPILER_SUPPORTS_funsignedchar - Success\n--   BUILD_SHARED_LIBS: OFF\n--   BUILD_EXAMPLES: OFF\n--   BUILD_STATIC_QJS_EXE: OFF\n--   CONFIG_ASAN: ON\n--   CONFIG_MSAN: OFF\n--   CONFIG_UBSAN: ON\n-- Building with ASan\n--   BUILD_QJS_LIBC: OFF\n-- Performing Test CMAKE_HAVE_LIBC_PTHREAD\n-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success\n-- Found Threads: TRUE  \n-- Configuring done (2.4s)\n-- Generating done (0.0s)\n-- Build files have been written to: /tmp/qjs-gh-379/post_function/build\ncmake --build build -j 256\ngmake[1]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[2]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\n[ 21%] Building C object CMakeFiles/qjs.dir/libregexp.c.o\n[ 21%] Building C object CMakeFiles/qjs.dir/cutils.c.o\n[ 21%] Building C object CMakeFiles/qjs.dir/libunicode.c.o\n[ 21%] Building C object CMakeFiles/qjs.dir/libbf.c.o\n[ 26%] Building C object CMakeFiles/qjs.dir/quickjs.c.o\n[ 31%] Linking C static library libqjs.a\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\n[ 31%] Built target qjs\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\n[ 36%] Building C object CMakeFiles/qjsc.dir/qjsc.c.o\n[ 42%] Building C object CMakeFiles/function_source.dir/quickjs-libc.c.o\n[ 47%] Building C object CMakeFiles/qjs_exe.dir/gen/repl.c.o\n[ 52%] Building C object CMakeFiles/qjsc.dir/quickjs-libc.c.o\n[ 57%] Building C object CMakeFiles/function_source.dir/gen/function_source.c.o\n[ 68%] Building C object CMakeFiles/qjs_exe.dir/qjs.c.o\n[ 68%] Building C object CMakeFiles/qjs_exe.dir/quickjs-libc.c.o\n[ 73%] Building C object CMakeFiles/run-test262.dir/run-test262.c.o\n[ 78%] Building C object CMakeFiles/run-test262.dir/quickjs-libc.c.o\n[ 84%] Linking C executable qjsc\n[ 89%] Linking C executable run-test262\n[ 94%] Linking C executable function_source\n[100%] Linking C executable qjs\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\n[100%] Built target qjsc\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\n[100%] Built target function_source\n[100%] Built target run-test262\n[100%] Built target qjs_exe\ngmake[2]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[1]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ncmake --build build -j 256\ngmake[1]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[2]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\n[ 31%] Built target qjs\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\n[ 47%] Built target run-test262\n[ 68%] Built target qjsc\n[ 84%] Built target qjs_exe\n[100%] Built target function_source\ngmake[2]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[1]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\nbuild/qjs -qd\ncmake --build build -j 256\ngmake[1]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[2]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\n[ 31%] Built target qjs\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Entering directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[3]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\n[ 78%] Built target qjsc\n[ 78%] Built target run-test262\n[ 78%] Built target function_source\n[100%] Built target qjs_exe\ngmake[2]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\ngmake[1]: Leaving directory '/tmp/qjs-gh-379/post_function/build'\nbuild/qjs tests/test_bigint.js\nbuild/qjs tests/test_closure.js\nbuild/qjs tests/test_language.js\nbuild/qjs tests/test_builtin.js\n\n        ===========STDERR===========\n            gmake[1]: warning: -j256 forced in submake: resetting jobserver mode.\ngmake[1]: warning: -j256 forced in submake: resetting jobserver mode.\ngmake[1]: warning: -j256 forced in submake: resetting jobserver mode.\nError: assertion failed: got |0,0,0,0|, expected |0,0,0,255|\n    at assert (tests/test_builtin.js:105:51)\n    at test_typed_array (tests/test_builtin.js:581:26)\n    at <anonymous> (tests/test_builtin.js:1044:1)\n\nmake: *** [Makefile:83: test] Error 1\n\n        ===============================\n        "}