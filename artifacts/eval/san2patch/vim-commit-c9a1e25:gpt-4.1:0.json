[{"patch": "diff --git a/src/ops.c b/src/ops.c\nindex a75efab59..2f84c377c 100644\n--- a/src/ops.c\n+++ b/src/ops.c\n@@ -1014,43 +1014,45 @@ op_delete(oparg_T *oap)\n     else\n     {\n \tif (virtual_op)\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n \t{\n-\t    int\t\tendcol = 0;\n+    int\tendcol = 0;\n \n-\t    // For virtualedit: break the tabs that are partly included.\n-\t    if (gchar_pos(&oap->start) == '\\t')\n-\t    {\n-\t\tif (u_save_cursor() == FAIL)\t// save first line for undo\n-\t\t    return FAIL;\n-\t\tif (oap->line_count == 1)\n-\t\t    endcol = getviscol2(oap->end.col, oap->end.coladd);\n-\t\tcoladvance_force(getviscol2(oap->start.col, oap->start.coladd));\n-\t\toap->start = curwin->w_cursor;\n-\t\tif (oap->line_count == 1)\n-\t\t{\n-\t\t    coladvance(endcol);\n-\t\t    oap->end.col = curwin->w_cursor.col;\n-\t\t    oap->end.coladd = curwin->w_cursor.coladd;\n-\t\t    curwin->w_cursor = oap->start;\n-\t\t}\n-\t    }\n+    // For virtualedit: break the tabs that are partly included.\n+    if (gchar_pos(&oap->start) == '\\t')\n+    {\n+        if (u_save_cursor() == FAIL)\t// save first line for undo\n+            return FAIL;\n+        if (oap->line_count == 1)\n+            endcol = getviscol2(oap->end.col, oap->end.coladd);\n+        coladvance_force(getviscol2(oap->start.col, oap->start.coladd));\n+        oap->start = curwin->w_cursor;\n+        if (oap->line_count == 1)\n+        {\n+            coladvance(endcol);\n+            oap->end.col = curwin->w_cursor.col;\n+            oap->end.coladd = curwin->w_cursor.coladd;\n+            curwin->w_cursor = oap->start;\n+        }\n+    }\n \n-\t    // Break a tab only when it's included in the area.\n-\t    if (gchar_pos(&oap->end) == '\\t'\n-\t\t\t\t     && (int)oap->end.coladd < oap->inclusive)\n-\t    {\n-\t\t// save last line for undo\n-\t\tif (u_save((linenr_T)(oap->end.lnum - 1),\n-\t\t\t\t       (linenr_T)(oap->end.lnum + 1)) == FAIL)\n-\t\t    return FAIL;\n-\t\tcurwin->w_cursor = oap->end;\n-\t\tcoladvance_force(getviscol2(oap->end.col, oap->end.coladd));\n-\t\toap->end = curwin->w_cursor;\n-\t\tcurwin->w_cursor = oap->start;\n-\t    }\n-\t    if (has_mbyte)\n-\t\tmb_adjust_opend(oap);\n-\t}\n+    // Break a tab only when it's included in the area.\n+    if (gchar_pos(&oap->end) == '\\t'\n+                     && (int)oap->end.coladd < oap->inclusive)\n+    {\n+        // save last line for undo\n+        if (u_save((linenr_T)(oap->end.lnum - 1),\n+                       (linenr_T)(oap->end.lnum + 1)) == FAIL)\n+            return FAIL;\n+        curwin->w_cursor = oap->end;\n+        coladvance_force(getviscol2(oap->end.col, oap->end.coladd));\n+        oap->end = curwin->w_cursor;\n+        curwin->w_cursor = oap->start;\n+    }\n+    if (has_mbyte)\n+        mb_adjust_opend(oap);\n+    // Defensive bounds: avoid using strlen, always pass buffer size to strnlen.\n+}\n \n \tif (oap->line_count == 1)\t// delete characters within one line\n \t{\n"}]