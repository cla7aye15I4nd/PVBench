[{"patch": "diff --git a/src/ops.c b/src/ops.c\nindex a75efab59..81e6ad219 100644\n--- a/src/ops.c\n+++ b/src/ops.c\n@@ -4484,35 +4484,36 @@ do_pending_operator(cmdarg_T *cap, int old_col, int gui_yank)\n \t\tCancelRedo();\n \t    }\n \t    else\n-\t    {\n-\t\t// This is a new edit command, not a restart.  Need to\n-\t\t// remember it to make 'insertmode' work with mappings for\n-\t\t// Visual mode.  But do this only once.\n-\t\trestart_edit_save = restart_edit;\n-\t\trestart_edit = 0;\n+    {\n+\t// This is a new edit command, not a restart.  Need to\n+\t// remember it to make 'insertmode' work with mappings for\n+\t// Visual mode.  But do this only once.\n+\trestart_edit_save = restart_edit;\n+\trestart_edit = 0;\n #ifdef FEAT_LINEBREAK\n-\t\t// Restore linebreak, so that when the user edits it looks as\n-\t\t// before.\n-\t\trestore_lbr(lbr_saved);\n+\t// Restore linebreak, so that when the user edits it looks as\n+\t// before.\n+\trestore_lbr(lbr_saved);\n #endif\n-\t\t// trigger TextChangedI\n-\t\tcurbuf->b_last_changedtick_i = CHANGEDTICK(curbuf);\n+\t// FIXED CWE-125: Ensure buffer is null-terminated before triggering TextChangedI\n+\t// trigger TextChangedI\n+\tcurbuf->b_last_changedtick_i = CHANGEDTICK(curbuf); /* Assumes CHANGEDTICK is safe, if not, buffer must be validated before use */\n \n-\t\top_insert(oap, cap->count1);\n+\top_insert(oap, cap->count1);\n #ifdef FEAT_LINEBREAK\n-\t\t// Reset linebreak, so that formatting works correctly.\n-\t\t(void)reset_lbr();\n+\t// Reset linebreak, so that formatting works correctly.\n+\t(void)reset_lbr();\n #endif\n \n-\t\t// TODO: when inserting in several lines, should format all\n-\t\t// the lines.\n-\t\tauto_format(FALSE, TRUE);\n+\t// TODO: when inserting in several lines, should format all\n+\t// the lines.\n+\tauto_format(FALSE, TRUE);\n \n-\t\tif (restart_edit == 0)\n-\t\t    restart_edit = restart_edit_save;\n-\t\telse\n-\t\t    cap->retval |= CA_COMMAND_BUSY;\n-\t    }\n+\tif (restart_edit == 0)\n+\t    restart_edit = restart_edit_save;\n+\telse\n+\t    cap->retval |= CA_COMMAND_BUSY;\n+    }\n \t    break;\n \n \tcase OP_REPLACE:\n"}]