[{"patch": "diff --git a/src/strings.c b/src/strings.c\nindex b8ea00bb3..4e60f32c4 100644\n--- a/src/strings.c\n+++ b/src/strings.c\n@@ -779,8 +779,16 @@ concat_str(char_u *str1, char_u *str2)\n     char_u *\n reverse_text(char_u *s)\n {\n-    size_t len = STRLEN(s);\n-    char_u *rev = alloc(len + 1);\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+     size_t len = STRLEN(s);\n+    // Calculate required buffer size considering multi-byte characters\n+    size_t required_size = len + 1;\n+    if (has_mbyte)\n+    {\n+        // Account for potential multi-byte character padding\n+        required_size = (len * 4) + 1;  // UTF-8 max 4 bytes per char\n+    }\n+    char_u *rev = alloc(required_size);\n     if (rev == NULL)\n \treturn NULL;\n \n"}]