[{"patch": "diff --git a/src/change.c b/src/change.c\nindex daf4faed5..13d59c90f 100644\n--- a/src/change.c\n+++ b/src/change.c\n@@ -1115,10 +1115,18 @@ ins_char_bytes(char_u *buf, int charlen)\n \t\ti += replace_push_mb(oldp + col + i) - 1;\n \t    else\n \t\treplace_push(oldp[col + i]);\n-\t}\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+ \t}\n     }\n \n-    newp = alloc(linelen + newlen - oldlen);\n+    // Calculate allocation size with safety margin\n+    int alloc_size = linelen + newlen - oldlen;\n+    if (alloc_size < 1) {\n+        alloc_size = 1;\n+    }\n+    // Add safety margin to prevent buffer overflow\n+    alloc_size += 4;\n+    newp = alloc(alloc_size);\n     if (newp == NULL)\n \treturn;\n \n@@ -1127,8 +1135,7 @@ ins_char_bytes(char_u *buf, int charlen)\n \tmch_memmove(newp, oldp, (size_t)col);\n \n     // Copy bytes after the changed character(s).\n-    p = newp + col;\n-    if (linelen > col + oldlen)\n+    p = newp + col;    if (linelen > col + oldlen)\n \tmch_memmove(p + newlen, oldp + col + oldlen,\n \t\t\t\t\t    (size_t)(linelen - col - oldlen));\n \n"}]