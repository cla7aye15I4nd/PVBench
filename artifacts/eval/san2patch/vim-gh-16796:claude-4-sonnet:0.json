[{"patch": "diff --git a/src/ex_cmds.c b/src/ex_cmds.c\nindex e1e6c4ee7..f91bfa654 100644\n--- a/src/ex_cmds.c\n+++ b/src/ex_cmds.c\n@@ -39,9 +39,19 @@ do_ascii(exarg_T *eap UNUSED)\n     int\t\tcc[MAX_MCO];\n     int\t\tci = 0;\n     int\t\tlen;\n-\n+    char_u\t*ptr;\n+    colnr_T\tcol;\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+ \n     if (enc_utf8)\n-\tc = utfc_ptr2char(ml_get_cursor(), cc);\n+    {\n+\tptr = ml_get_cursor();\n+\tcol = curwin->w_cursor.col;\n+\tif (ptr != NULL && col < (colnr_T)ml_get_curline_len())\n+\t    c = utfc_ptr2char(ptr, cc);\n+\telse\n+\t    c = NUL;\n+    }\n     else\n \tc = gchar_cursor();\n     if (c == NUL)\n@@ -51,8 +61,7 @@ do_ascii(exarg_T *eap UNUSED)\n     }\n \n     IObuff[0] = NUL;\n-    if (!has_mbyte || (enc_dbcs != 0 && c < 0x100) || c < 0x80)\n-    {\n+    if (!has_mbyte || (enc_dbcs != 0 && c < 0x100) || c < 0x80)    {\n \tif (c == NL)\t    // NUL is stored as NL\n \t    c = NUL;\n \tif (c == CAR && get_fileformat(curbuf) == EOL_MAC)\n"}]