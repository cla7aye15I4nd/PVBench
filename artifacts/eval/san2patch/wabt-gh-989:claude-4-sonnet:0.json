[{"patch": "diff --git a/src/stream.cc b/src/stream.cc\nindex ad0d08a5..7527f9b2 100644\n--- a/src/stream.cc\n+++ b/src/stream.cc\n@@ -87,34 +87,53 @@ void Stream::WriteMemoryDump(const void* start,\n     const uint8_t* line = p;\n     const uint8_t* line_end = p + DUMP_OCTETS_PER_LINE;\n     if (prefix) {\n-      Writef(\"%s\", prefix);\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+       if (this != nullptr) {\n+         Writef(\"%s\", prefix);\n+       }\n+    }\n+    if (this != nullptr) {\n+      Writef(\"%07\" PRIzx \": \", reinterpret_cast<intptr_t>(p) -\n+                                   reinterpret_cast<intptr_t>(start) + offset);\n     }\n-    Writef(\"%07\" PRIzx \": \", reinterpret_cast<intptr_t>(p) -\n-                                 reinterpret_cast<intptr_t>(start) + offset);\n     while (p < line_end) {\n       for (int i = 0; i < DUMP_OCTETS_PER_GROUP; ++i, ++p) {\n         if (p < end) {\n-          Writef(\"%02x\", *p);\n+          if (this != nullptr) {\n+            Writef(\"%02x\", *p);\n+          }\n         } else {\n-          WriteChar(' ');\n-          WriteChar(' ');\n+          if (this != nullptr) {\n+            WriteChar(' ');\n+            WriteChar(' ');\n+          }\n         }\n       }\n-      WriteChar(' ');\n+      if (this != nullptr) {\n+        WriteChar(' ');\n+      }\n     }\n \n     if (print_chars == PrintChars::Yes) {\n-      WriteChar(' ');\n+      if (this != nullptr) {\n+        WriteChar(' ');\n+      }\n       p = line;\n       for (int i = 0; i < DUMP_OCTETS_PER_LINE && p < end; ++i, ++p)\n-        WriteChar(isprint(*p) ? *p : '.');\n+        if (this != nullptr) {\n+          WriteChar(isprint(*p) ? *p : '.');\n+        }\n     }\n \n     /* if there are multiple lines, only print the desc on the last one */\n     if (p >= end && desc) {\n-      Writef(\"  ; %s\", desc);\n+      if (this != nullptr) {\n+        Writef(\"  ; %s\", desc);\n+      }\n+    }\n+    if (this != nullptr) {\n+      WriteChar('\\n');\n     }\n-    WriteChar('\\n');\n   }\n }\n \n"}]