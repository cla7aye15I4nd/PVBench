[{"patch": "diff --git a/HTMLparser.c b/HTMLparser.c\nindex d1395fa5..5b0ea57a 100644\n--- a/HTMLparser.c\n+++ b/HTMLparser.c\n@@ -435,10 +435,19 @@ htmlCurrentChar(xmlParserCtxtPtr ctxt, int *len) {\n \t */\n \tconst unsigned char *cur = ctxt->input->cur;\n \tunsigned char c;\n-\tunsigned int val;\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+ \tunsigned int val;\n \n+\tif ((cur >= ctxt->input->end) || (ctxt->input->end - cur < 1)) {\n+\t    *len = 0;\n+\t    return(0);\n+\t}\n \tc = *cur;\n \tif (c & 0x80) {\n+\t    if ((cur + 1) >= ctxt->input->end) {\n+\t\t*len = 0;\n+\t\treturn(0);\n+\t    }\n \t    if (cur[1] == 0) {\n \t\txmlParserInputGrow(ctxt->input, INPUT_CHUNK);\n                 cur = ctxt->input->cur;\n@@ -447,6 +456,10 @@ htmlCurrentChar(xmlParserCtxtPtr ctxt, int *len) {\n \t\tgoto encoding_error;\n \t    if ((c & 0xe0) == 0xe0) {\n \n+\t\tif ((cur + 2) >= ctxt->input->end) {\n+\t\t    *len = 0;\n+\t\t    return(0);\n+\t\t}\n \t\tif (cur[2] == 0) {\n \t\t    xmlParserInputGrow(ctxt->input, INPUT_CHUNK);\n                     cur = ctxt->input->cur;\n@@ -454,6 +467,10 @@ htmlCurrentChar(xmlParserCtxtPtr ctxt, int *len) {\n \t\tif ((cur[2] & 0xc0) != 0x80)\n \t\t    goto encoding_error;\n \t\tif ((c & 0xf0) == 0xf0) {\n+\t\t    if ((cur + 3) >= ctxt->input->end) {\n+\t\t\t*len = 0;\n+\t\t\treturn(0);\n+\t\t    }\n \t\t    if (cur[3] == 0) {\n \t\t\txmlParserInputGrow(ctxt->input, INPUT_CHUNK);\n                         cur = ctxt->input->cur;\n@@ -498,6 +515,7 @@ htmlCurrentChar(xmlParserCtxtPtr ctxt, int *len) {\n \t    return((int) *ctxt->input->cur);\n \t}\n     }\n+\n     /*\n      * Assume it's a fixed length encoding (1) with\n      * a compatible encoding for the ASCII set, since\n"}]