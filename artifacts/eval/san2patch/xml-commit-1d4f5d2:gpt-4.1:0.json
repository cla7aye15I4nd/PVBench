[{"patch": "diff --git a/xmlschemas.c b/xmlschemas.c\nindex ade10f78..82ad71ac 100644\n--- a/xmlschemas.c\n+++ b/xmlschemas.c\n@@ -16232,16 +16232,20 @@ xmlSchemaCheckCOSCTDerivedOK(xmlSchemaAbstractCtxtPtr actxt,\n  */\n static int\n xmlSchemaCheckCOSDerivedOK(xmlSchemaAbstractCtxtPtr actxt,\n-\t\t\t   xmlSchemaTypePtr type,\n-\t\t\t   xmlSchemaTypePtr baseType,\n-\t\t\t   int set)\n-{\n+               xmlSchemaTypePtr type,\n+               xmlSchemaTypePtr baseType,\n+               int set)\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+ {\n+    if (type == NULL || baseType == NULL)\n+        return -1;\n     if (WXS_IS_SIMPLE(type))\n-\treturn (xmlSchemaCheckCOSSTDerivedOK(actxt, type, baseType, set));\n+        return (xmlSchemaCheckCOSSTDerivedOK(actxt, type, baseType, set));\n     else\n-\treturn (xmlSchemaCheckCOSCTDerivedOK(actxt, type, baseType, set));\n+        return (xmlSchemaCheckCOSCTDerivedOK(actxt, type, baseType, set));\n }\n \n+\n /**\n  * xmlSchemaCheckCOSCTExtends:\n  * @ctxt:  the schema parser context\n"}]