[{"patch": "diff --git a/xpath.c b/xpath.c\nindex 5e3bb9ff..46d91484 100644\n--- a/xpath.c\n+++ b/xpath.c\n@@ -9159,6 +9159,12 @@ xmlXPathSubstringFunction(xmlXPathParserContextPtr ctxt, int nargs) {\n     CHECK_TYPE(XPATH_NUMBER);\n     start = valuePop(ctxt);\n     in = start->floatval;\n+    // Fix: Reject clearly out-of-range 'in', return empty string immediately\n+    if (in > (double)INT_MAX || in < (double)INT_MIN) {\n+        valuePush(ctxt, xmlXPathCacheNewCString(ctxt->context, \"\"));\n+        xmlXPathReleaseObject(ctxt->context, start);\n+        return;\n+    }\n     xmlXPathReleaseObject(ctxt->context, start);\n     CAST_TO_STRING;\n     CHECK_TYPE(XPATH_STRING);\n@@ -9227,6 +9233,7 @@ xmlXPathSubstringFunction(xmlXPathParserContextPtr ctxt, int nargs) {\n     xmlXPathReleaseObject(ctxt->context, str);\n }\n \n+\n /**\n  * xmlXPathSubstringBeforeFunction:\n  * @ctxt:  the XPath Parser context\n"}]