[{"patch": "diff --git a/dict.c b/dict.c\nindex c0585fe2..e2eade23 100644\n--- a/dict.c\n+++ b/dict.c\n@@ -848,6 +848,8 @@ xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     /*\n      * Check for duplicate and insertion location.\n      */\n+    if (name == NULL)\n+        return(NULL);\n     okey = xmlDictComputeKey(dict, name, l);\n     key = okey % dict->size;\n     if (dict->dict[key].valid == 0) {\n@@ -858,8 +860,7 @@ xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n #ifdef __GNUC__\n \t    if ((insert->okey == okey) && (insert->len == l)) {\n \t\tif (!memcmp(insert->name, name, l))\n-\t\t    return(insert->name);\n-\t    }\n+\t\t    return(insert->name);\t    }\n #else\n \t    if ((insert->okey == okey) && (insert->len == l) &&\n \t        (!xmlStrncmp(insert->name, name, l)))\ndiff --git a/parser.c b/parser.c\nindex 4464e2e8..3f7f15c7 100644\n--- a/parser.c\n+++ b/parser.c\n@@ -3525,6 +3525,11 @@ xmlParseNCNameComplex(xmlParserCtxtPtr ctxt) {\n     if ((len > XML_MAX_NAME_LENGTH) &&\n         ((ctxt->options & XML_PARSE_HUGE) == 0)) {\n         xmlFatalErr(ctxt, XML_ERR_NAME_TOO_LONG, \"NCName\");\n+// FIXME: Crash CWE-416: Use After Free\n+         return(NULL);\n+    }\n+    /* Check if the pointer is still within valid buffer bounds */\n+    if ((end - len) < ctxt->input->base || (end - len) > ctxt->input->end) {\n         return(NULL);\n     }\n     return(xmlDictLookup(ctxt->dict, end - len, len));\n@@ -3532,8 +3537,7 @@ xmlParseNCNameComplex(xmlParserCtxtPtr ctxt) {\n \n /**\n  * xmlParseNCName:\n- * @ctxt:  an XML parser context\n- * @len:  length of the string parsed\n+ * @ctxt:  an XML parser context * @len:  length of the string parsed\n  *\n  * parse an XML name.\n  *\n"}]