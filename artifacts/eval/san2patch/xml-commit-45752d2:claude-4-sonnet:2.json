[{"patch": "diff --git a/buf.c b/buf.c\nindex 07922ff6..b9558da9 100644\n--- a/buf.c\n+++ b/buf.c\n@@ -510,11 +510,17 @@ xmlBufGrow(xmlBufPtr buf, int len) {\n     size_t ret;\n \n     if ((buf == NULL) || (len < 0)) return(-1);\n-    if (len == 0)\n+// FIXME: Crash CWE-416: Use After Free - Fixed by adding buffer validation\n+     if (len == 0)\n         return(0);\n     ret = xmlBufGrowInternal(buf, len);\n     if (buf->error != 0)\n         return(-1);\n+    /* Validate buffer integrity after potential reallocation */\n+    if (buf->content == NULL) {\n+        buf->error = XML_ERR_NO_MEMORY;\n+        return(-1);\n+    }\n     return((int) ret);\n }\n \ndiff --git a/parser.c b/parser.c\nindex 4464e2e8..3159377f 100644\n--- a/parser.c\n+++ b/parser.c\n@@ -3527,13 +3527,16 @@ xmlParseNCNameComplex(xmlParserCtxtPtr ctxt) {\n         xmlFatalErr(ctxt, XML_ERR_NAME_TOO_LONG, \"NCName\");\n         return(NULL);\n     }\n+    /* Validate end pointer is within current buffer bounds */\n+    if (end < ctxt->input->base || end > ctxt->input->end) {\n+        return(NULL);\n+    }\n     return(xmlDictLookup(ctxt->dict, end - len, len));\n }\n \n /**\n  * xmlParseNCName:\n- * @ctxt:  an XML parser context\n- * @len:  length of the string parsed\n+ * @ctxt:  an XML parser context * @len:  length of the string parsed\n  *\n  * parse an XML name.\n  *\n"}]