[{"patch": "diff --git a/parser.c b/parser.c\nindex 4464e2e8..3cfaf7e2 100644\n--- a/parser.c\n+++ b/parser.c\n@@ -3525,15 +3525,20 @@ xmlParseNCNameComplex(xmlParserCtxtPtr ctxt) {\n     if ((len > XML_MAX_NAME_LENGTH) &&\n         ((ctxt->options & XML_PARSE_HUGE) == 0)) {\n         xmlFatalErr(ctxt, XML_ERR_NAME_TOO_LONG, \"NCName\");\n-        return(NULL);\n+// FIXME: Crash CWE-416: Use After Free\n+         return(NULL);\n+    }\n+    /* Validate pointer before dictionary lookup to prevent use-after-free */\n+    if (ctxt->input && ctxt->input->cur && (end - len) >= ctxt->input->base && \n+        (end - len) <= ctxt->input->end) {\n+        return(xmlDictLookup(ctxt->dict, end - len, len));\n     }\n-    return(xmlDictLookup(ctxt->dict, end - len, len));\n+    return(NULL);\n }\n \n /**\n  * xmlParseNCName:\n- * @ctxt:  an XML parser context\n- * @len:  length of the string parsed\n+ * @ctxt:  an XML parser context * @len:  length of the string parsed\n  *\n  * parse an XML name.\n  *\n"}]