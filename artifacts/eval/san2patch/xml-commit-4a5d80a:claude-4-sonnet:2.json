[{"patch": "diff --git a/xmllint.c b/xmllint.c\nindex b297ded1..7b85bac0 100644\n--- a/xmllint.c\n+++ b/xmllint.c\n@@ -2272,11 +2272,18 @@ static void parseAndPrintFile(char *filename, xmlParserCtxtPtr rectxt) {\n \t\tint ret;\n \t        int res, size = 1024;\n \t        char chars[1024];\n-                xmlParserCtxtPtr ctxt;\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+                 xmlParserCtxtPtr ctxt;\n \n \t\t/* if (repeat) size = 1024; */\n \t\tres = fread(chars, 1, 4, f);\n \t\tif (res > 0) {\n+\t\t    // Check if file has valid XML structure before parsing\n+\t\t    if (res < 4 || strncmp(chars, \"<?xml\", 4) != 0) {\n+\t\t        if (f != stdin)\n+\t\t            fclose(f);\n+\t\t        return;\n+\t\t    }\n \t\t    ctxt = xmlCreatePushParserCtxt(NULL, NULL,\n \t\t                chars, res, filename);\n \t\t    xmlCtxtUseOptions(ctxt, options);\n"}]