[{"patch": "diff --git a/parser.c b/parser.c\nindex 0edd53bc..5407783d 100644\n--- a/parser.c\n+++ b/parser.c\n@@ -3503,6 +3503,11 @@ xmlParseNCNameComplex(xmlParserCtxtPtr ctxt) {\n         xmlFatalErr(ctxt, XML_ERR_NAME_TOO_LONG, \"NCName\");\n         return(NULL);\n     }\n+    /* Prevent out-of-bounds by ensuring end - len is not before buffer start */\n+    if (len < 0 || end == NULL || (end - len) < ctxt->input->base) {\n+        xmlFatalErr(ctxt, XML_ERR_NAME_TOO_LONG, \"NCName bounds\");\n+        return(NULL);\n+    }\n     return(xmlDictLookup(ctxt->dict, end - len, len));\n }\n \n"}]