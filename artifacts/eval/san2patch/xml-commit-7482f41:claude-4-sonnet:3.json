[{"patch": "diff --git a/xpath.c b/xpath.c\nindex a60a6237..2da4a390 100644\n--- a/xpath.c\n+++ b/xpath.c\n@@ -5711,9 +5711,15 @@ xmlXPathCastNumberToString (double val) {\n \t} else if (val == 0 && xmlXPathGetSign(val) != 0) {\n \t    ret = xmlStrdup((const xmlChar *) \"0\");\n \t} else {\n-\t    /* could be improved */\n+// FIXME: Crash CWE-681: Incorrect Conversion between Numeric Types\n+ \t    /* could be improved */\n \t    char buf[100];\n-\t    xmlXPathFormatNumber(val, buf, 99);\n+\t    /* Add bounds check to prevent integer overflow in xmlXPathFormatNumber */\n+\t    if (val > 2147483647.0 || val < -2147483648.0) {\n+\t        snprintf(buf, 99, \"%.6g\", val);\n+\t    } else {\n+\t        xmlXPathFormatNumber(val, buf, 99);\n+\t    }\n \t    buf[99] = 0;\n \t    ret = xmlStrdup((const xmlChar *) buf);\n \t}\n"}]