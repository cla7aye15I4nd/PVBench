[{"patch": "diff --git a/xpath.c b/xpath.c\nindex a60a6237..9a2bac85 100644\n--- a/xpath.c\n+++ b/xpath.c\n@@ -2672,9 +2672,15 @@ xmlXPathCacheConvertString(xmlXPathContextPtr ctxt, xmlXPathObjectPtr val) {\n \tres = xmlXPathCastBooleanToString(val->boolval);\n \tbreak;\n     case XPATH_NUMBER:\n-\tres = xmlXPathCastNumberToString(val->floatval);\n+        if (val->floatval > (double)INT_MAX || val->floatval < (double)INT_MIN || isnan(val->floatval)) {\n+            // Out of int range or nan; avoid unsafe conversion\n+            res = xmlXPathCastNumberToString(0.0);\n+        } else {\n+            res = xmlXPathCastNumberToString(val->floatval);\n+        }\n \tbreak;\n-    case XPATH_USERS:\n+// FIXME: Crash CWE-681: Incorrect Conversion between Numeric Types\n+     case XPATH_USERS:\n     case XPATH_POINT:\n     case XPATH_RANGE:\n     case XPATH_LOCATIONSET:\n@@ -5833,9 +5839,15 @@ xmlXPathConvertString(xmlXPathObjectPtr val) {\n \tres = xmlXPathCastBooleanToString(val->boolval);\n \tbreak;\n     case XPATH_NUMBER:\n-\tres = xmlXPathCastNumberToString(val->floatval);\n+        if (val->floatval > (double)INT_MAX || val->floatval < (double)INT_MIN || isnan(val->floatval)) {\n+            // Out of int range or nan; avoid unsafe conversion\n+            res = xmlXPathCastNumberToString(0.0);\n+        } else {\n+            res = xmlXPathCastNumberToString(val->floatval);\n+        }\n \tbreak;\n-    case XPATH_USERS:\n+// FIXME: Crash CWE-681: Incorrect Conversion between Numeric Types\n+     case XPATH_USERS:\n     case XPATH_POINT:\n     case XPATH_RANGE:\n     case XPATH_LOCATIONSET:\n"}]