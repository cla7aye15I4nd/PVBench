[{"patch": "diff --git a/valid.c b/valid.c\nindex 19f84b82..4c0ba3d6 100644\n--- a/valid.c\n+++ b/valid.c\n@@ -1260,6 +1260,10 @@ xmlSnprintfElementContent(char *buf, int size, xmlElementContentPtr content, int\n     if (englob) strcat(buf, \"(\");\n     switch (content->type) {\n         case XML_ELEMENT_CONTENT_PCDATA:\n+            if (strlen(buf) + strlen(\"#PCDATA\") >= size) {\n+                strcat(buf, \" ...\");\n+                return;\n+            }\n             strcat(buf, \"#PCDATA\");\n \t    break;\n \tcase XML_ELEMENT_CONTENT_ELEMENT:\n@@ -1274,9 +1278,15 @@ xmlSnprintfElementContent(char *buf, int size, xmlElementContentPtr content, int\n \t    if (size - len < xmlStrlen(content->name) + 10) {\n \t\tstrcat(buf, \" ...\");\n \t\treturn;\n-\t    }\n-\t    if (content->name != NULL)\n+// FIXME: Crash CWE-787: Out-of-bounds Write\n+ \t    }\n+\t    if (content->name != NULL) {\n+                if (strlen(buf) + xmlStrlen(content->name) >= size) {\n+                    strcat(buf, \" ...\");\n+                    return;\n+                }\n \t\tstrcat(buf, (char *) content->name);\n+            }\n \t    break;\n \tcase XML_ELEMENT_CONTENT_SEQ:\n \t    if ((content->c1->type == XML_ELEMENT_CONTENT_OR) ||\n@@ -1290,6 +1300,10 @@ xmlSnprintfElementContent(char *buf, int size, xmlElementContentPtr content, int\n \t\t    strcat(buf, \" ...\");\n \t\treturn;\n \t    }\n+            if (strlen(buf) + strlen(\" , \") >= size) {\n+                strcat(buf, \" ...\");\n+                return;\n+            }\n             strcat(buf, \" , \");\n \t    if (((content->c2->type == XML_ELEMENT_CONTENT_OR) ||\n \t\t (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)) &&\n@@ -1310,6 +1324,10 @@ xmlSnprintfElementContent(char *buf, int size, xmlElementContentPtr content, int\n \t\t    strcat(buf, \" ...\");\n \t\treturn;\n \t    }\n+            if (strlen(buf) + strlen(\" | \") >= size) {\n+                strcat(buf, \" ...\");\n+                return;\n+            }\n             strcat(buf, \" | \");\n \t    if (((content->c2->type == XML_ELEMENT_CONTENT_SEQ) ||\n \t\t (content->c2->ocur != XML_ELEMENT_CONTENT_ONCE)) &&\n"}]