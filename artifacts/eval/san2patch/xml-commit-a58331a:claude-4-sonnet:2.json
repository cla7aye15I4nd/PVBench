[{"patch": "diff --git a/xpath.c b/xpath.c\nindex d40bdda6..f6b719f7 100644\n--- a/xpath.c\n+++ b/xpath.c\n@@ -12065,10 +12065,15 @@ xmlXPathIsPositionalPredicate(xmlXPathParserContextPtr ctxt,\n \t* like it \"[position() < 5]\", is also not detected.\n \t* Maybe we could rewrite the AST to ease the optimization.\n \t*/\n-\t*maxPos = (int) ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n+\tdouble floatval = ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n+\t\n+\tif (isnan(floatval) || isinf(floatval) || floatval > INT_MAX || floatval < INT_MIN) {\n+\t    return(0);\n+\t}\n+\t\n+\t*maxPos = (int) floatval;\n \n-\tif (((xmlXPathObjectPtr) exprOp->value4)->floatval ==\n-\t    (float) *maxPos)\n+\tif (floatval == (float) *maxPos)\n \t{\n \t    return(1);\n \t}\n"}]