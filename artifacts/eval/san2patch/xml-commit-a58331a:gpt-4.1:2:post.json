{"patch": "diff --git a/xpath.c b/xpath.c\nindex d40bdda6..0bf126c4 100644\n--- a/xpath.c\n+++ b/xpath.c\n@@ -12063,9 +12063,14 @@ xmlXPathIsPositionalPredicate(xmlXPathParserContextPtr ctxt,\n \t* and even not the usage of position() in\n \t* \"[position() = 1]\"; thus - obviously - a position-range,\n \t* like it \"[position() < 5]\", is also not detected.\n+// FIXME: Crash CWE-681: Incorrect Conversion between Numeric Types\n \t* Maybe we could rewrite the AST to ease the optimization.\n \t*/\n-\t*maxPos = (int) ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n+\tfloat fval = ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n+\tif (isnan(fval) || isinf(fval) || fval > INT_MAX || fval < INT_MIN) {\n+\t    return(0);\n+\t}\n+\t*maxPos = (int) fval;\n \n \tif (((xmlXPathObjectPtr) exprOp->value4)->floatval ==\n \t    (float) *maxPos)\n", "result": true}