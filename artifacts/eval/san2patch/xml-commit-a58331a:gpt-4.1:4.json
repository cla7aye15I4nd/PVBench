[{"patch": "diff --git a/xpath.c b/xpath.c\nindex d40bdda6..3b2c05cf 100644\n--- a/xpath.c\n+++ b/xpath.c\n@@ -12063,14 +12063,18 @@ xmlXPathIsPositionalPredicate(xmlXPathParserContextPtr ctxt,\n \t* and even not the usage of position() in\n \t* \"[position() = 1]\"; thus - obviously - a position-range,\n \t* like it \"[position() < 5]\", is also not detected.\n-\t* Maybe we could rewrite the AST to ease the optimization.\n+// FIXME: Crash CWE-681: Incorrect Conversion between Numeric Types\n+ \t* Maybe we could rewrite the AST to ease the optimization.\n \t*/\n-\t*maxPos = (int) ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n-\n-\tif (((xmlXPathObjectPtr) exprOp->value4)->floatval ==\n-\t    (float) *maxPos)\n-\t{\n-\t    return(1);\n+\tif (isfinite(((xmlXPathObjectPtr) exprOp->value4)->floatval) &&\n+\t    ((xmlXPathObjectPtr) exprOp->value4)->floatval >= (float)INT_MIN &&\n+\t    ((xmlXPathObjectPtr) exprOp->value4)->floatval <= (float)INT_MAX) {\n+\t    *maxPos = (int) ((xmlXPathObjectPtr) exprOp->value4)->floatval;\n+\t    if (((xmlXPathObjectPtr) exprOp->value4)->floatval ==\n+\t\t(float) *maxPos)\n+\t    {\n+\t\treturn(1);\n+\t    }\n \t}\n     }\n     return(0);\n"}]