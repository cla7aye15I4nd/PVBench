[{"patch": "diff --git a/dict.c b/dict.c\nindex c0585fe2..48cdd719 100644\n--- a/dict.c\n+++ b/dict.c\n@@ -916,15 +916,23 @@ xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n \t    }\n #else\n \t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+\t(!xmlStrncmp(tmp->name, name, l)))\n+\treturn(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+    }\n+    key = okey % dict->size;\n     }\n \n+    /* Check for valid name pointer and reasonable length */\n+    if (name == NULL) {\n+        return(NULL);\n+    }\n+    if (l < 0 || l > 65536) {\n+        return(NULL);\n+    }\n     ret = xmlDictAddString(dict, name, l);\n-    if (ret == NULL)\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n \tentry = &(dict->dict[key]);\n@@ -936,8 +944,7 @@ xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n     entry->name = ret;\n     entry->len = l;\n     entry->next = NULL;\n-    entry->valid = 1;\n-    entry->okey = okey;\n+    entry->valid = 1;    entry->okey = okey;\n \n \n     if (insert != NULL)\n"}]