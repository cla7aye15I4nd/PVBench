[{"patch": "diff --git a/HTMLparser.c b/HTMLparser.c\nindex 69eed2bd..d503fc22 100644\n--- a/HTMLparser.c\n+++ b/HTMLparser.c\n@@ -2669,16 +2669,31 @@ htmlParseHTMLAttribute(htmlParserCtxtPtr ctxt, const xmlChar stop) {\n  * Returns the associated htmlEntityDescPtr if found, or NULL otherwise,\n  *         if non-NULL *str will have to be freed by the caller.\n  */\n-const htmlEntityDesc *\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+ const htmlEntityDesc *\n htmlParseEntityRef(htmlParserCtxtPtr ctxt, const xmlChar **str) {\n     const xmlChar *name;\n     const htmlEntityDesc * ent = NULL;\n+    const xmlChar *ptr;\n+    int nameLen = 0;\n \n     if (str != NULL) *str = NULL;\n     if ((ctxt == NULL) || (ctxt->input == NULL)) return(NULL);\n \n     if (CUR == '&') {\n         NEXT;\n+        // Pre-validate entity name length\n+        ptr = ctxt->input->cur;\n+        while (ptr < ctxt->input->end && *ptr != ';' && *ptr != ' ' && *ptr != '\\n' && *ptr != '\\r' && *ptr != '\\t' && nameLen < 1024) {\n+            nameLen++;\n+            ptr++;\n+        }\n+        if (nameLen >= 1024) {\n+            htmlParseErr(ctxt, XML_ERR_ENTITYREF_SEMICOL_MISSING,\n+                         \"htmlParseEntityRef: entity name too long\\n\",\n+                         NULL, NULL);\n+            return(NULL);\n+        }\n         name = htmlParseName(ctxt);\n \tif (name == NULL) {\n \t    htmlParseErr(ctxt, XML_ERR_NAME_REQUIRED,\n"}]