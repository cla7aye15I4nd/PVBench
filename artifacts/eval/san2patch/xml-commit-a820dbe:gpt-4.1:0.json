[{"patch": "diff --git a/dict.c b/dict.c\nindex c0585fe2..9a34b46c 100644\n--- a/dict.c\n+++ b/dict.c\n@@ -916,22 +916,26 @@ xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n \t    }\n #else\n \t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+        (!xmlStrncmp(tmp->name, name, l)))\n+        return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+    }\n+    key = okey % dict->size;\n     }\n \n+    /* Bounds check: ensure 'l' is not negative and name is not NULL */\n+    if (name == NULL || l < 0 || (name && strlen((const char*)name) < (size_t)l))\n+        return(NULL);\n     ret = xmlDictAddString(dict, name, l);\n-    if (ret == NULL)\n+// FIXME: Crash CWE-125: Out-of-bounds Read\n+     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+    entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+    entry = xmlMalloc(sizeof(xmlDictEntry));\n+    if (entry == NULL)\n+         return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n"}]