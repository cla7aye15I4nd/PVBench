[{"patch": "diff --git a/dict.c b/dict.c\nindex c0585fe2..6db5de1d 100644\n--- a/dict.c\n+++ b/dict.c\n@@ -916,22 +916,25 @@ xmlDictLookup(xmlDictPtr dict, const xmlChar *name, int len) {\n \t    }\n #else\n \t    if ((tmp->okey == skey) && (tmp->len == l) &&\n-\t\t(!xmlStrncmp(tmp->name, name, l)))\n-\t\treturn(tmp->name);\n+        (!xmlStrncmp(tmp->name, name, l)))\n+        return(tmp->name);\n #endif\n-\t}\n-\tkey = okey % dict->size;\n+    }\n+    key = okey % dict->size;\n     }\n \n+    if (l < 0 || (size_t)l > strlen((const char*)name))\n+        return(NULL);\n     ret = xmlDictAddString(dict, name, l);\n-    if (ret == NULL)\n+// FIXME: Crash CWE-787: Out-of-bounds Write\n+     if (ret == NULL)\n         return(NULL);\n     if (insert == NULL) {\n-\tentry = &(dict->dict[key]);\n+    entry = &(dict->dict[key]);\n     } else {\n-\tentry = xmlMalloc(sizeof(xmlDictEntry));\n-\tif (entry == NULL)\n-\t     return(NULL);\n+    entry = xmlMalloc(sizeof(xmlDictEntry));\n+    if (entry == NULL)\n+         return(NULL);\n     }\n     entry->name = ret;\n     entry->len = l;\n"}]