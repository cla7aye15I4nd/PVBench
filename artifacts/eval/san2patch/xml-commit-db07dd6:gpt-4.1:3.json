[{"patch": "diff --git a/parser.c b/parser.c\nindex 68e1c90f..ad902602 100644\n--- a/parser.c\n+++ b/parser.c\n@@ -9834,14 +9834,21 @@ xmlParseEndTag2(xmlParserCtxtPtr ctxt, const xmlChar *prefix,\n     SKIP(2);\n \n     if ((tlen > 0) && (xmlStrncmp(ctxt->input->cur, ctxt->name, tlen) == 0)) {\n-        if (ctxt->input->cur[tlen] == '>') {\n-\t    ctxt->input->cur += tlen + 1;\n-\t    ctxt->input->col += tlen + 1;\n-\t    goto done;\n-\t}\n-\tctxt->input->cur += tlen;\n-\tctxt->input->col += tlen;\n-\tname = (xmlChar*)1;\n+        // Defensive bounds check to avoid out-of-bounds read\n+        if ((ctxt->input->cur + tlen) < ctxt->input->end) {\n+            if (ctxt->input->cur[tlen] == '>') {\n+\t        ctxt->input->cur += tlen + 1;\n+\t        ctxt->input->col += tlen + 1;\n+\t        goto done;\n+\t    }\n+\t    ctxt->input->cur += tlen;\n+\t    ctxt->input->col += tlen;\n+\t    name = (xmlChar*)1;\n+        } else {\n+            // Don't process out-of-bounds memory\n+            xmlFatalErr(ctxt, XML_ERR_TAG_NAME_MISMATCH, NULL);\n+            return;\n+        }\n     } else {\n \tif (prefix == NULL)\n \t    name = xmlParseNameAndCompare(ctxt, ctxt->name);\n@@ -9872,8 +9879,8 @@ xmlParseEndTag2(xmlParserCtxtPtr ctxt, const xmlChar *prefix,\n         if ((line == 0) && (ctxt->node != NULL))\n             line = ctxt->node->line;\n         xmlFatalErrMsgStrIntStr(ctxt, XML_ERR_TAG_NAME_MISMATCH,\n-\t\t     \"Opening and ending tag mismatch: %s line %d and %s\\n\",\n-\t\t                ctxt->name, line, name);\n+\t     \"Opening and ending tag mismatch: %s line %d and %s\\n\",\n+\t                ctxt->name, line, name);\n     }\n \n     /*\n@@ -9882,7 +9889,7 @@ xmlParseEndTag2(xmlParserCtxtPtr ctxt, const xmlChar *prefix,\n done:\n     if ((ctxt->sax != NULL) && (ctxt->sax->endElementNs != NULL) &&\n \t(!ctxt->disableSAX))\n-\tctxt->sax->endElementNs(ctxt->userData, ctxt->name, prefix, URI);\n+        ctxt->sax->endElementNs(ctxt->userData, ctxt->name, prefix, URI);\n \n     spacePop(ctxt);\n     if (nsNr != 0)\n"}]