[{"patch": "diff --git a/xmlschemas.c b/xmlschemas.c\nindex 6a353858..ccc230cf 100644\n--- a/xmlschemas.c\n+++ b/xmlschemas.c\n@@ -18657,6 +18657,8 @@ xmlSchemaFixupComplexType(xmlSchemaParserCtxtPtr pctxt,\n \t\t    * Create a duplicate of the base type's particle\n \t\t    * and assign its \"term\" to it.\n \t\t    */\n+\t\t    if (baseType == NULL || baseType->subtypes == NULL)\n+\t\t\tgoto exit_failure;\n \t\t    particle->children->children =\n \t\t\t(xmlSchemaTreeItemPtr) xmlSchemaAddParticle(pctxt,\n \t\t\ttype->node,\n@@ -18679,7 +18681,8 @@ xmlSchemaFixupComplexType(xmlSchemaParserCtxtPtr pctxt,\n \t\t    *         new-particle\n \t\t    *           --> base-model,\n \t\t    *         this-particle\n-\t\t    *\t        --> this-model\n+// FIXME: Crash CWE-476: NULL Pointer Dereference\n+ \t\t    *\t        --> this-model\n \t\t    *\t    )\n \t\t    */\n \t\t} else {\n@@ -18692,6 +18695,8 @@ xmlSchemaFixupComplexType(xmlSchemaParserCtxtPtr pctxt,\n \t\t    * neither the regex compilation of the content model,\n \t\t    * nor to the complex type constraints.\n \t\t    */\n+\t\t    if (baseType == NULL || baseType->subtypes == NULL)\n+\t\t\tgoto exit_failure;\n \t\t    particle->children->children =\n \t\t\t(xmlSchemaTreeItemPtr) baseType->subtypes;\n \t\t}\n"}]