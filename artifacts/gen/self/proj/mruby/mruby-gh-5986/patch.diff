diff --git a/src/string.c b/src/string.c
index 1bd3f6f8f..cb5597bf3 100644
--- a/src/string.c
+++ b/src/string.c
@@ -2950,12 +2950,18 @@ str_bytesplice(mrb_state *mrb, mrb_value str, mrb_int idx1, mrb_int len1, mrb_va
   if (RSTR_LEN(s) < idx1 || RSTRING_LEN(replace) < idx2) {
     mrb_raise(mrb, E_INDEX_ERROR, "index out of string");
   }
-  if (RSTR_LEN(s) <= idx1+len1) {
+  if (len1 > MRB_INT_MAX - idx1 || RSTR_LEN(s) <= idx1+len1) {
     len1 = RSTR_LEN(s) - idx1;
   }
-  if (RSTRING_LEN(replace) <= idx2+len2) {
+  if (len1 < 0) {
+    len1 = 0;
+  }
+  if (len2 > MRB_INT_MAX - idx2 || RSTRING_LEN(replace) <= idx2+len2) {
     len2 = RSTRING_LEN(replace) - idx2;
   }
+  if (len2 < 0) {
+    len2 = 0;
+  }
   if (len2 == 0) return str;
   mrb_str_modify(mrb, s);
   if (len1 >= len2) {
