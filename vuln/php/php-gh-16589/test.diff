diff --git a/ext/spl/tests/gh16589.phpt b/ext/spl/tests/gh16589.phpt
new file mode 100644
index 0000000000..7b1452e37a
--- /dev/null
+++ b/ext/spl/tests/gh16589.phpt
@@ -0,0 +1,23 @@
+--TEST--
+GH-16589 (UAF in SplDoublyLinked->serialize())
+--CREDITS--
+chibinz
+--FILE--
+<?php
+
+class C {
+    function __serialize(): array {
+        global $list;
+        $list->pop();
+        return [];
+    }
+}
+
+$list = new SplDoublyLinkedList;
+$list->add(0, new C);
+$list->add(1, 1);
+var_dump($list->serialize());
+
+?>
+--EXPECT--
+string(17) "i:0;:O:1:"C":0:{}"
